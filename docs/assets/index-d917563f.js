(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();const Fh={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:'`renderMode` must be `"hybrid"` or `"vector"`',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection",69:"`width` or `height` cannot be provided together with `scale`"};class Sh extends Error{constructor(t){const e=Fh[t];super(e),this.code=t,this.name="AssertionError",this.message=e}}const uu=Sh;class Th{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}const je=Th,ti={PROPERTYCHANGE:"propertychange"};class Rh{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}const Xs=Rh;function Mh(i,t,e){let n,r;e=e||Sn;let s=0,o=i.length,a=!1;for(;s<o;)n=s+(o-s>>1),r=+e(i[n],t),r<0?s=n+1:(o=n,a=!r);return a?s:~s}function Sn(i,t){return i>t?1:i<t?-1:0}function Ws(i,t,e){const n=i.length;if(i[0]<=t)return 0;if(t<=i[n-1])return n-1;let r;if(e>0){for(r=1;r<n;++r)if(i[r]<t)return r-1}else if(e<0){for(r=1;r<n;++r)if(i[r]<=t)return r}else for(r=1;r<n;++r){if(i[r]==t)return r;if(i[r]<t)return typeof e=="function"?e(t,i[r-1],i[r])>0?r-1:r:i[r-1]-t<t-i[r]?r-1:r}return n-1}function Ih(i,t,e){for(;t<e;){const n=i[t];i[t]=i[e],i[e]=n,++t,--e}}function Ys(i,t){const e=Array.isArray(t)?t:[t],n=e.length;for(let r=0;r<n;r++)i[i.length]=e[r]}function mn(i,t){const e=i.length;if(e!==t.length)return!1;for(let n=0;n<e;n++)if(i[n]!==t[n])return!1;return!0}function bh(i,t,e){const n=t||Sn;return i.every(function(r,s){if(s===0)return!0;const o=n(i[s-1],r);return!(o>0||e&&o===0)})}function Di(){return!0}function Fr(){return!1}function ei(){}function Lh(i){let t=!1,e,n,r;return function(){const s=Array.prototype.slice.call(arguments);return(!t||this!==r||!mn(s,n))&&(t=!0,r=this,n=s,e=i.apply(this,arguments)),e}}function Ni(i){for(const t in i)delete i[t]}function yi(i){let t;for(t in i)return!1;return!t}class Nh extends Xs{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const n=this.listeners_||(this.listeners_={}),r=n[t]||(n[t]=[]);r.includes(e)||r.push(e)}dispatchEvent(t){const e=typeof t=="string",n=e?t:t.type,r=this.listeners_&&this.listeners_[n];if(!r)return;const s=e?new je(t):t;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});n in o||(o[n]=0,a[n]=0),++o[n];let u;for(let c=0,l=r.length;c<l;++c)if("handleEvent"in r[c]?u=r[c].handleEvent(s):u=r[c].call(this,s),u===!1||s.propagationStopped){u=!1;break}if(--o[n]===0){let c=a[n];for(delete a[n];c--;)this.removeEventListener(n,ei);delete o[n]}return u}disposeInternal(){this.listeners_&&Ni(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){const n=this.listeners_&&this.listeners_[t];if(n){const r=n.indexOf(e);r!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[r]=ei,++this.pendingRemovals_[t]):(n.splice(r,1),n.length===0&&delete this.listeners_[t]))}}}const Sr=Nh,at={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function mt(i,t,e,n,r){if(n&&n!==i&&(e=e.bind(n)),r){const o=e;e=function(){i.removeEventListener(t,e),o.apply(this,arguments)}}const s={target:i,type:t,listener:e};return i.addEventListener(t,e),s}function rr(i,t,e,n){return mt(i,t,e,n,!0)}function St(i){i&&i.target&&(i.target.removeEventListener(i.type,i.listener),Ni(i))}class Tr extends Sr{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(at.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const n=t.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=mt(this,t[s],e);return r}return mt(this,t,e)}onceInternal(t,e){let n;if(Array.isArray(t)){const r=t.length;n=new Array(r);for(let s=0;s<r;++s)n[s]=rr(this,t[s],e)}else n=rr(this,t,e);return e.ol_key=n,n}unInternal(t,e){const n=e.ol_key;if(n)Oh(n);else if(Array.isArray(t))for(let r=0,s=t.length;r<s;++r)this.removeEventListener(t[r],e);else this.removeEventListener(t,e)}}Tr.prototype.on;Tr.prototype.once;Tr.prototype.un;function Oh(i){if(Array.isArray(i))for(let t=0,e=i.length;t<e;++t)St(i[t]);else St(i)}const lu=Tr;function gt(){throw new Error("Unimplemented abstract method.")}let Ph=0;function _t(i){return i.ol_uid||(i.ol_uid=String(++Ph))}class Wo extends je{constructor(t,e,n){super(t),this.key=e,this.oldValue=n}}class Bh extends lu{constructor(t){super(),this.on,this.once,this.un,_t(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}hasProperties(){return!!this.values_}notify(t,e){let n;n=`change:${t}`,this.hasListener(n)&&this.dispatchEvent(new Wo(n,t,e)),n=ti.PROPERTYCHANGE,this.hasListener(n)&&this.dispatchEvent(new Wo(n,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,n){const r=this.values_||(this.values_={});if(n)r[t]=e;else{const s=r[t];r[t]=e,s!==e&&this.notify(t,s)}}setProperties(t,e){for(const n in t)this.set(n,t[n],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const n=this.values_[t];delete this.values_[t],yi(this.values_)&&(this.values_=null),e||this.notify(t,n)}}}const We=Bh,me={ADD:"add",REMOVE:"remove"},Yo={LENGTH:"length"};class Ui extends je{constructor(t,e,n){super(t),this.element=e,this.index=n}}class zh extends We{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let n=0,r=this.array_.length;n<r;++n)this.assertUnique_(this.array_[n],n);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,n=t.length;e<n;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let n=0,r=e.length;n<r;++n)t(e[n],n,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(Yo.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Ui(me.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let n=0,r=e.length;n<r;++n)if(e[n]===t)return this.removeAt(n)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Ui(me.REMOVE,e,t)),e}setAt(t,e){const n=this.getLength();if(t>=n){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const r=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Ui(me.REMOVE,r,t)),this.dispatchEvent(new Ui(me.ADD,e,t))}updateLength_(){this.set(Yo.LENGTH,this.array_.length)}assertUnique_(t,e){for(let n=0,r=this.array_.length;n<r;++n)if(this.array_[n]===t&&n!==e)throw new uu(58)}}const Pe=zh;function lt(i,t){if(!i)throw new uu(t)}class Us extends We{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new Us(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const n=this.getStyle();return n&&t.setStyle(n),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(St(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=mt(t,at.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?kh(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function kh(i){if(typeof i=="function")return i;let t;return Array.isArray(i)?t=i:(lt(typeof i.getZIndex=="function",41),t=[i]),function(){return t}}const Uo=Us,fn=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",Gh=fn.includes("firefox"),Xh=fn.includes("safari")&&!fn.includes("chrom");Xh&&(fn.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(fn));const Wh=fn.includes("webkit")&&!fn.includes("edge"),Yh=fn.includes("macintosh"),hu=typeof devicePixelRatio<"u"?devicePixelRatio:1,Zs=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Uh=typeof Image<"u"&&Image.prototype.decode,cu=function(){let i=!1;try{const t=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return i}();new Array(6);function ze(){return[1,0,0,1,0,0]}function Zh(i,t,e,n,r,s,o){return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i[4]=s,i[5]=o,i}function Vh(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i}function Ht(i,t){const e=t[0],n=t[1];return t[0]=i[0]*e+i[2]*n+i[4],t[1]=i[1]*e+i[3]*n+i[5],t}function Kh(i,t,e){return Zh(i,t,0,0,e,0,0)}function dn(i,t,e,n,r,s,o,a){const u=Math.sin(s),c=Math.cos(s);return i[0]=n*c,i[1]=r*u,i[2]=-n*u,i[3]=r*c,i[4]=o*n*c-a*n*u+t,i[5]=o*r*u+a*r*c+e,i}function Vs(i,t){const e=$h(t);lt(e!==0,32);const n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],u=t[5];return i[0]=o/e,i[1]=-r/e,i[2]=-s/e,i[3]=n/e,i[4]=(s*u-o*a)/e,i[5]=-(n*u-r*a)/e,i}function $h(i){return i[0]*i[3]-i[1]*i[2]}let Zo;function fu(i){const t="matrix("+i.join(", ")+")";if(Zs)return t;const e=Zo||(Zo=document.createElement("div"));return e.style.transform=t,e.style.transform}const qt={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Vo(i){const t=Re();for(let e=0,n=i.length;e<n;++e)mi(t,i[e]);return t}function Ks(i,t,e){return e?(e[0]=i[0]-t,e[1]=i[1]-t,e[2]=i[2]+t,e[3]=i[3]+t,e):[i[0]-t,i[1]-t,i[2]+t,i[3]+t]}function du(i,t){return t?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i.slice()}function $s(i,t,e){let n,r;return t<i[0]?n=i[0]-t:i[2]<t?n=t-i[2]:n=0,e<i[1]?r=i[1]-e:i[3]<e?r=e-i[3]:r=0,n*n+r*r}function Rr(i,t){return gu(i,t[0],t[1])}function Zn(i,t){return i[0]<=t[0]&&t[2]<=i[2]&&i[1]<=t[1]&&t[3]<=i[3]}function gu(i,t,e){return i[0]<=t&&t<=i[2]&&i[1]<=e&&e<=i[3]}function ds(i,t){const e=i[0],n=i[1],r=i[2],s=i[3],o=t[0],a=t[1];let u=qt.UNKNOWN;return o<e?u=u|qt.LEFT:o>r&&(u=u|qt.RIGHT),a<n?u=u|qt.BELOW:a>s&&(u=u|qt.ABOVE),u===qt.UNKNOWN&&(u=qt.INTERSECTING),u}function Re(){return[1/0,1/0,-1/0,-1/0]}function ke(i,t,e,n,r){return r?(r[0]=i,r[1]=t,r[2]=e,r[3]=n,r):[i,t,e,n]}function Mr(i){return ke(1/0,1/0,-1/0,-1/0,i)}function qh(i,t){const e=i[0],n=i[1];return ke(e,n,e,n,t)}function Hh(i,t,e,n,r){const s=Mr(r);return mu(s,i,t,e,n)}function Ei(i,t){return i[0]==t[0]&&i[2]==t[2]&&i[1]==t[1]&&i[3]==t[3]}function jh(i,t){return t[0]<i[0]&&(i[0]=t[0]),t[2]>i[2]&&(i[2]=t[2]),t[1]<i[1]&&(i[1]=t[1]),t[3]>i[3]&&(i[3]=t[3]),i}function mi(i,t){t[0]<i[0]&&(i[0]=t[0]),t[0]>i[2]&&(i[2]=t[0]),t[1]<i[1]&&(i[1]=t[1]),t[1]>i[3]&&(i[3]=t[1])}function mu(i,t,e,n,r){for(;e<n;e+=r)Jh(i,t[e],t[e+1]);return i}function Jh(i,t,e){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}function qs(i,t){let e;return e=t(Ir(i)),e||(e=t(br(i)),e)||(e=t(Lr(i)),e)||(e=t(Tn(i)),e)?e:!1}function gs(i){let t=0;return Hs(i)||(t=xt(i)*Ge(i)),t}function Ir(i){return[i[0],i[1]]}function br(i){return[i[2],i[1]]}function ni(i){return[(i[0]+i[2])/2,(i[1]+i[3])/2]}function Qh(i,t){let e;return t==="bottom-left"?e=Ir(i):t==="bottom-right"?e=br(i):t==="top-left"?e=Tn(i):t==="top-right"?e=Lr(i):lt(!1,13),e}function ms(i,t,e,n,r){const[s,o,a,u,c,l,h,f]=_s(i,t,e,n);return ke(Math.min(s,a,c,h),Math.min(o,u,l,f),Math.max(s,a,c,h),Math.max(o,u,l,f),r)}function _s(i,t,e,n){const r=t*n[0]/2,s=t*n[1]/2,o=Math.cos(e),a=Math.sin(e),u=r*o,c=r*a,l=s*o,h=s*a,f=i[0],g=i[1];return[f-u+h,g-c-l,f-u-h,g-c+l,f+u-h,g+c+l,f+u+h,g+c-l,f-u+h,g-c-l]}function Ge(i){return i[3]-i[1]}function _i(i,t,e){const n=e||Re();return oe(i,t)?(i[0]>t[0]?n[0]=i[0]:n[0]=t[0],i[1]>t[1]?n[1]=i[1]:n[1]=t[1],i[2]<t[2]?n[2]=i[2]:n[2]=t[2],i[3]<t[3]?n[3]=i[3]:n[3]=t[3]):Mr(n),n}function Tn(i){return[i[0],i[3]]}function Lr(i){return[i[2],i[3]]}function xt(i){return i[2]-i[0]}function oe(i,t){return i[0]<=t[2]&&i[2]>=t[0]&&i[1]<=t[3]&&i[3]>=t[1]}function Hs(i){return i[2]<i[0]||i[3]<i[1]}function tc(i,t){return t?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i}function ec(i,t,e){let n=!1;const r=ds(i,t),s=ds(i,e);if(r===qt.INTERSECTING||s===qt.INTERSECTING)n=!0;else{const o=i[0],a=i[1],u=i[2],c=i[3],l=t[0],h=t[1],f=e[0],g=e[1],m=(g-h)/(f-l);let d,_;s&qt.ABOVE&&!(r&qt.ABOVE)&&(d=f-(g-c)/m,n=d>=o&&d<=u),!n&&s&qt.RIGHT&&!(r&qt.RIGHT)&&(_=g-(f-u)*m,n=_>=a&&_<=c),!n&&s&qt.BELOW&&!(r&qt.BELOW)&&(d=f-(g-a)/m,n=d>=o&&d<=u),!n&&s&qt.LEFT&&!(r&qt.LEFT)&&(_=g-(f-o)*m,n=_>=a&&_<=c)}return n}function _u(i,t){const e=t.getExtent(),n=ni(i);if(t.canWrapX()&&(n[0]<e[0]||n[0]>=e[2])){const r=xt(e),o=Math.floor((n[0]-e[0])/r)*r;i[0]-=o,i[2]-=o}return i}function nc(i,t){if(t.canWrapX()){const e=t.getExtent();if(!isFinite(i[0])||!isFinite(i[2]))return[[e[0],i[1],e[2],i[3]]];_u(i,t);const n=xt(e);if(xt(i)>n)return[[e[0],i[1],e[2],i[3]]];if(i[0]<e[0])return[[i[0]+n,i[1],e[2],i[3]],[e[0],i[1],i[2],i[3]]];if(i[2]>e[2])return[[i[0],i[1],e[2],i[3]],[e[0],i[1],i[2]-n,i[3]]]}return[i]}const Ci={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class ic{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Ci[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const js=ic,Oi=6378137,Vn=Math.PI*Oi,rc=[-Vn,-Vn,Vn,Vn],sc=[-180,-85,180,85],Zi=Oi*Math.log(Math.tan(Math.PI/2));class Ln extends js{constructor(t){super({code:t,units:"m",extent:rc,global:!0,worldExtent:sc,getPointResolution:function(e,n){return e/Math.cosh(n[1]/Oi)}})}}const Ko=[new Ln("EPSG:3857"),new Ln("EPSG:102100"),new Ln("EPSG:102113"),new Ln("EPSG:900913"),new Ln("http://www.opengis.net/def/crs/EPSG/0/3857"),new Ln("http://www.opengis.net/gml/srs/epsg.xml#3857")];function oc(i,t,e){const n=i.length;e=e>1?e:2,t===void 0&&(e>2?t=i.slice():t=new Array(n));for(let r=0;r<n;r+=e){t[r]=Vn*i[r]/180;let s=Oi*Math.log(Math.tan(Math.PI*(+i[r+1]+90)/360));s>Zi?s=Zi:s<-Zi&&(s=-Zi),t[r+1]=s}return t}function ac(i,t,e){const n=i.length;e=e>1?e:2,t===void 0&&(e>2?t=i.slice():t=new Array(n));for(let r=0;r<n;r+=e)t[r]=180*i[r]/Vn,t[r+1]=360*Math.atan(Math.exp(i[r+1]/Oi))/Math.PI-90;return t}const uc=6378137,$o=[-180,-90,180,90],lc=Math.PI*uc/180;class pn extends js{constructor(t,e){super({code:t,units:"degrees",extent:$o,axisOrientation:e,global:!0,metersPerUnit:lc,worldExtent:$o})}}const qo=[new pn("CRS:84"),new pn("EPSG:4326","neu"),new pn("urn:ogc:def:crs:OGC:1.3:CRS84"),new pn("urn:ogc:def:crs:OGC:2:84"),new pn("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new pn("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new pn("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let ps={};function hc(i){return ps[i]||ps[i.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function cc(i,t){ps[i]=t}let qn={};function sr(i,t,e){const n=i.getCode(),r=t.getCode();n in qn||(qn[n]={}),qn[n][r]=e}function fc(i,t){let e;return i in qn&&t in qn[i]&&(e=qn[i][t]),e}function kt(i,t,e){return Math.min(Math.max(i,t),e)}function dc(i,t,e,n,r,s){const o=r-e,a=s-n;if(o!==0||a!==0){const u=((i-e)*o+(t-n)*a)/(o*o+a*a);u>1?(e=r,n=s):u>0&&(e+=o*u,n+=a*u)}return Hn(i,t,e,n)}function Hn(i,t,e,n){const r=e-i,s=n-t;return r*r+s*s}function gc(i){const t=i.length;for(let n=0;n<t;n++){let r=n,s=Math.abs(i[n][n]);for(let a=n+1;a<t;a++){const u=Math.abs(i[a][n]);u>s&&(s=u,r=a)}if(s===0)return null;const o=i[r];i[r]=i[n],i[n]=o;for(let a=n+1;a<t;a++){const u=-i[a][n]/i[n][n];for(let c=n;c<t+1;c++)n==c?i[a][c]=0:i[a][c]+=u*i[n][c]}}const e=new Array(t);for(let n=t-1;n>=0;n--){e[n]=i[n][t]/i[n][n];for(let r=n-1;r>=0;r--)i[r][t]-=i[r][n]*e[n]}return e}function nr(i){return i*Math.PI/180}function An(i,t){const e=i%t;return e*t<0?e+t:e}function ve(i,t,e){return i+e*(t-i)}function Js(i,t){const e=Math.pow(10,t);return Math.round(i*e)/e}function Vi(i,t){return Math.floor(Js(i,t))}function Ki(i,t){return Math.ceil(Js(i,t))}function mc(i,t){return i[0]+=+t[0],i[1]+=+t[1],i}function or(i,t){let e=!0;for(let n=i.length-1;n>=0;--n)if(i[n]!=t[n]){e=!1;break}return e}function Qs(i,t){const e=Math.cos(t),n=Math.sin(t),r=i[0]*e-i[1]*n,s=i[1]*e+i[0]*n;return i[0]=r,i[1]=s,i}function _c(i,t){return i[0]*=t,i[1]*=t,i}function pu(i,t){if(t.canWrapX()){const e=xt(t.getExtent()),n=pc(i,t,e);n&&(i[0]-=n*e)}return i}function pc(i,t,e){const n=t.getExtent();let r=0;return t.canWrapX()&&(i[0]<n[0]||i[0]>n[2])&&(e=e||xt(n),r=Math.floor((i[0]-n[0])/e)),r}const vu=63710088e-1;function vs(i,t,e){e=e||vu;const n=nr(i[1]),r=nr(t[1]),s=(r-n)/2,o=nr(t[0]-i[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(n)*Math.cos(r);return 2*e*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function qr(i,t){let e=0;for(let n=0,r=i.length;n<r-1;++n)e+=vs(i[n],i[n+1],t);return e}function Du(i,t){t=t||{};const e=t.radius||vu,n=t.projection||"EPSG:3857",r=i.getType();r!=="GeometryCollection"&&(i=i.clone().transform(n,"EPSG:4326"));let s=0,o,a,u,c,l,h;switch(r){case"Point":case"MultiPoint":break;case"LineString":case"LinearRing":{o=i.getCoordinates(),s=qr(o,e);break}case"MultiLineString":case"Polygon":{for(o=i.getCoordinates(),u=0,c=o.length;u<c;++u)s+=qr(o[u],e);break}case"MultiPolygon":{for(o=i.getCoordinates(),u=0,c=o.length;u<c;++u)for(a=o[u],l=0,h=a.length;l<h;++l)s+=qr(a[l],e);break}case"GeometryCollection":{const f=i.getGeometries();for(u=0,c=f.length;u<c;++u)s+=Du(f[u],t);break}default:throw new Error("Unsupported geometry type: "+r)}return s}const yu={info:1,warn:2,error:3,none:4};let vc=yu.info;function Eu(...i){vc>yu.warn||console.warn(...i)}let Ds=!0;function Cu(i){Ds=!(i===void 0?!0:i)}function to(i,t){if(t!==void 0){for(let e=0,n=i.length;e<n;++e)t[e]=i[e];t=t}else t=i.slice();return t}function wu(i,t){if(t!==void 0&&i!==t){for(let e=0,n=i.length;e<n;++e)t[e]=i[e];i=t}return i}function Dc(i){cc(i.getCode(),i),sr(i,i,to)}function yc(i){i.forEach(Dc)}function Me(i){return typeof i=="string"?hc(i):i||null}function ys(i,t,e,n){i=Me(i);let r;const s=i.getPointResolutionFunc();if(s){if(r=s(t,e),n&&n!==i.getUnits()){const o=i.getMetersPerUnit();o&&(r=r*o/Ci[n])}}else{const o=i.getUnits();if(o=="degrees"&&!n||n=="degrees")r=t;else{const a=no(i,Me("EPSG:4326"));if(a===wu&&o!=="degrees")r=t*i.getMetersPerUnit();else{let c=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];c=a(c,c,2);const l=vs(c.slice(0,2),c.slice(2,4)),h=vs(c.slice(4,6),c.slice(6,8));r=(l+h)/2}const u=n?Ci[n]:i.getMetersPerUnit();u!==void 0&&(r/=u)}}return r}function Ho(i){yc(i),i.forEach(function(t){i.forEach(function(e){t!==e&&sr(t,e,to)})})}function Ec(i,t,e,n){i.forEach(function(r){t.forEach(function(s){sr(r,s,e),sr(s,r,n)})})}function eo(i,t){if(i){if(typeof i=="string")return Me(i)}else return Me(t);return i}function Cc(i,t){return Cu(),io(i,"EPSG:4326",t!==void 0?t:"EPSG:3857")}function wc(i,t){const e=io(i,t!==void 0?t:"EPSG:3857","EPSG:4326"),n=e[0];return(n<-180||n>180)&&(e[0]=An(n+180,360)-180),e}function kn(i,t){if(i===t)return!0;const e=i.getUnits()===t.getUnits();return(i.getCode()===t.getCode()||no(i,t)===to)&&e}function no(i,t){const e=i.getCode(),n=t.getCode();let r=fc(e,n);return r||(r=wu),r}function ar(i,t){const e=Me(i),n=Me(t);return no(e,n)}function io(i,t,e){return ar(t,e)(i,void 0,i.length)}function Es(i,t){return i}function Ve(i,t){return Ds&&!or(i,[0,0])&&i[0]>=-180&&i[0]<=180&&i[1]>=-90&&i[1]<=90&&(Ds=!1,Eu("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),i}function xu(i,t){return i}function yn(i,t){return i}function xc(){Ho(Ko),Ho(qo),Ec(qo,Ko,oc,ac)}xc();function Fn(i,t,e,n,r,s){s=s||[];let o=0;for(let a=t;a<e;a+=n){const u=i[a],c=i[a+1];s[o++]=r[0]*u+r[2]*c+r[4],s[o++]=r[1]*u+r[3]*c+r[5]}return s&&s.length!=o&&(s.length=o),s}function ro(i,t,e,n,r,s,o){o=o||[];const a=Math.cos(r),u=Math.sin(r),c=s[0],l=s[1];let h=0;for(let f=t;f<e;f+=n){const g=i[f]-c,m=i[f+1]-l;o[h++]=c+g*a-m*u,o[h++]=l+g*u+m*a;for(let d=f+2;d<f+n;++d)o[h++]=i[d]}return o&&o.length!=h&&(o.length=h),o}function Ac(i,t,e,n,r,s,o,a){a=a||[];const u=o[0],c=o[1];let l=0;for(let h=t;h<e;h+=n){const f=i[h]-u,g=i[h+1]-c;a[l++]=u+r*f,a[l++]=c+s*g;for(let m=h+2;m<h+n;++m)a[l++]=i[m]}return a&&a.length!=l&&(a.length=l),a}function Au(i,t,e,n,r,s,o){o=o||[];let a=0;for(let u=t;u<e;u+=n){o[a++]=i[u]+r,o[a++]=i[u+1]+s;for(let c=u+2;c<u+n;++c)o[a++]=i[c]}return o&&o.length!=a&&(o.length=a),o}const jo=ze();class Fc extends We{constructor(){super(),this.extent_=Re(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Lh(function(t,e,n){if(!n)return this.getSimplifiedGeometry(e);const r=this.clone();return r.applyTransform(n),r.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return gt()}closestPointXY(t,e,n,r){return gt()}containsXY(t,e){const n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return gt()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Mr(e),this.extentRevision_=this.getRevision()}return tc(this.extent_,t)}rotate(t,e){gt()}scale(t,e,n){gt()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return gt()}getType(){return gt()}applyTransform(t){gt()}intersectsExtent(t){return gt()}translate(t,e){gt()}transform(t,e){const n=Me(t),r=n.getUnits()=="tile-pixels"?function(s,o,a){const u=n.getExtent(),c=n.getWorldExtent(),l=Ge(c)/Ge(u);return dn(jo,c[0],c[3],l,-l,0,0,0),Fn(s,0,s.length,a,jo,o),ar(n,e)(s,o,a)}:ar(n,e);return this.applyTransform(r),this}}const Sc=Fc;class Tc extends Sc{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates=null}computeExtent(t){return Hh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return gt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=Jo(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){gt()}setLayout(t,e,n){let r;if(t)r=Jo(t);else{for(let s=0;s<n;++s){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}r=e.length,t=Rc(r)}this.layout=t,this.stride=r}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const n=this.getFlatCoordinates();if(n){const r=this.getStride();ro(n,0,n.length,r,t,e,n),this.changed()}}scale(t,e,n){e===void 0&&(e=t),n||(n=ni(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();Ac(r,0,r.length,s,t,e,n,r),this.changed()}}translate(t,e){const n=this.getFlatCoordinates();if(n){const r=this.getStride();Au(n,0,n.length,r,t,e,n),this.changed()}}}function Rc(i){let t;return i==2?t="XY":i==3?t="XYZ":i==4&&(t="XYZM"),t}function Jo(i){let t;return i=="XY"?t=2:i=="XYZ"||i=="XYM"?t=3:i=="XYZM"&&(t=4),t}function Mc(i,t,e){const n=i.getFlatCoordinates();if(!n)return null;const r=i.getStride();return Fn(n,0,n.length,r,t,e)}const Pi=Tc;function Qo(i,t,e,n,r,s,o){const a=i[t],u=i[t+1],c=i[e]-a,l=i[e+1]-u;let h;if(c===0&&l===0)h=t;else{const f=((r-a)*c+(s-u)*l)/(c*c+l*l);if(f>1)h=e;else if(f>0){for(let g=0;g<n;++g)o[g]=ve(i[t+g],i[e+g],f);o.length=n;return}else h=t}for(let f=0;f<n;++f)o[f]=i[h+f];o.length=n}function so(i,t,e,n,r){let s=i[t],o=i[t+1];for(t+=n;t<e;t+=n){const a=i[t],u=i[t+1],c=Hn(s,o,a,u);c>r&&(r=c),s=a,o=u}return r}function Ic(i,t,e,n,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];r=so(i,t,a,n,r),t=a}return r}function oo(i,t,e,n,r,s,o,a,u,c,l){if(t==e)return c;let h,f;if(r===0){if(f=Hn(o,a,i[t],i[t+1]),f<c){for(h=0;h<n;++h)u[h]=i[t+h];return u.length=n,f}return c}l=l||[NaN,NaN];let g=t+n;for(;g<e;)if(Qo(i,g-n,g,n,o,a,l),f=Hn(o,a,l[0],l[1]),f<c){for(c=f,h=0;h<n;++h)u[h]=l[h];u.length=n,g+=n}else g+=n*Math.max((Math.sqrt(f)-Math.sqrt(c))/r|0,1);if(s&&(Qo(i,e-n,t,n,o,a,l),f=Hn(o,a,l[0],l[1]),f<c)){for(c=f,h=0;h<n;++h)u[h]=l[h];u.length=n}return c}function bc(i,t,e,n,r,s,o,a,u,c,l){l=l||[NaN,NaN];for(let h=0,f=e.length;h<f;++h){const g=e[h];c=oo(i,t,g,n,r,s,o,a,u,c,l),t=g}return c}function Fu(i,t,e,n){for(let r=0,s=e.length;r<s;++r)i[t++]=e[r];return t}function ao(i,t,e,n){for(let r=0,s=e.length;r<s;++r){const o=e[r];for(let a=0;a<n;++a)i[t++]=o[a]}return t}function Lc(i,t,e,n,r){r=r||[];let s=0;for(let o=0,a=e.length;o<a;++o){const u=ao(i,t,e[o],n);r[s++]=u,t=u}return r.length=s,r}function Su(i,t,e,n,r,s,o){const a=(e-t)/n;if(a<3){for(;t<e;t+=n)s[o++]=i[t],s[o++]=i[t+1];return o}const u=new Array(a);u[0]=1,u[a-1]=1;const c=[t,e-n];let l=0;for(;c.length>0;){const h=c.pop(),f=c.pop();let g=0;const m=i[f],d=i[f+1],_=i[h],p=i[h+1];for(let D=f+n;D<h;D+=n){const v=i[D],y=i[D+1],E=dc(v,y,m,d,_,p);E>g&&(l=D,g=E)}g>r&&(u[(l-t)/n]=1,f+n<l&&c.push(f,l),l+n<h&&c.push(l,h))}for(let h=0;h<a;++h)u[h]&&(s[o++]=i[t+h*n],s[o++]=i[t+h*n+1]);return o}function Dn(i,t){return t*Math.round(i/t)}function Nc(i,t,e,n,r,s,o){if(t==e)return o;let a=Dn(i[t],r),u=Dn(i[t+1],r);t+=n,s[o++]=a,s[o++]=u;let c,l;do if(c=Dn(i[t],r),l=Dn(i[t+1],r),t+=n,t==e)return s[o++]=c,s[o++]=l,o;while(c==a&&l==u);for(;t<e;){const h=Dn(i[t],r),f=Dn(i[t+1],r);if(t+=n,h==c&&f==l)continue;const g=c-a,m=l-u,d=h-a,_=f-u;if(g*_==m*d&&(g<0&&d<g||g==d||g>0&&d>g)&&(m<0&&_<m||m==_||m>0&&_>m)){c=h,l=f;continue}s[o++]=c,s[o++]=l,a=c,u=l,c=h,l=f}return s[o++]=c,s[o++]=l,o}function Oc(i,t,e,n,r,s,o,a){for(let u=0,c=e.length;u<c;++u){const l=e[u];o=Nc(i,t,l,n,r,s,o),a.push(o),t=l}return o}function En(i,t,e,n,r){r=r!==void 0?r:[];let s=0;for(let o=t;o<e;o+=n)r[s++]=i.slice(o,o+n);return r.length=s,r}function ur(i,t,e,n,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=e.length;o<a;++o){const u=e[o];r[s++]=En(i,t,u,n,r[s]),t=u}return r.length=s,r}function ta(i,t,e,n,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=e.length;o<a;++o){const u=e[o];r[s++]=u.length===1&&u[0]===t?[]:ur(i,t,u,n,r[s]),t=u[u.length-1]}return r.length=s,r}function Tu(i,t,e,n){let r=0,s=i[e-n],o=i[e-n+1];for(;t<e;t+=n){const a=i[t],u=i[t+1];r+=o*a-s*u,s=a,o=u}return r/2}function Pc(i,t,e,n){let r=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];r+=Tu(i,t,a,n),t=a}return r}class lr extends Pi{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new lr(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,n,r){return r<$s(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(so(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),oo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,r))}getArea(){return Tu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return En(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=Su(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new lr(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ao(this.flatCoordinates,0,t,this.stride),this.changed()}}const ea=lr;class uo extends Pi{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new uo(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,r){const s=this.flatCoordinates,o=Hn(t,e,s[0],s[1]);if(o<r){const a=this.stride;for(let u=0;u<a;++u)n[u]=s[u];return n.length=a,o}return r}getCoordinates(){return this.flatCoordinates?this.flatCoordinates.slice():[]}computeExtent(t){return qh(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return gu(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Fu(this.flatCoordinates,0,t,this.stride),this.changed()}}const Ru=uo;function Bc(i,t,e,n,r){return!qs(r,function(o){return!Cn(i,t,e,n,o[0],o[1])})}function Cn(i,t,e,n,r,s){let o=0,a=i[e-n],u=i[e-n+1];for(;t<e;t+=n){const c=i[t],l=i[t+1];u<=s?l>s&&(c-a)*(s-u)-(r-a)*(l-u)>0&&o++:l<=s&&(c-a)*(s-u)-(r-a)*(l-u)<0&&o--,a=c,u=l}return o!==0}function Mu(i,t,e,n,r,s){if(e.length===0||!Cn(i,t,e[0],n,r,s))return!1;for(let o=1,a=e.length;o<a;++o)if(Cn(i,e[o-1],e[o],n,r,s))return!1;return!0}function zc(i,t,e,n,r,s,o){let a,u,c,l,h,f,g;const m=r[s+1],d=[];for(let D=0,v=e.length;D<v;++D){const y=e[D];for(l=i[y-n],f=i[y-n+1],a=t;a<y;a+=n)h=i[a],g=i[a+1],(m<=f&&g<=m||f<=m&&m<=g)&&(c=(m-f)/(g-f)*(h-l)+l,d.push(c)),l=h,f=g}let _=NaN,p=-1/0;for(d.sort(Sn),l=d[0],a=1,u=d.length;a<u;++a){h=d[a];const D=Math.abs(h-l);D>p&&(c=(l+h)/2,Mu(i,t,e,n,c,m)&&(_=c,p=D)),l=h}return isNaN(_)&&(_=r[s]),o?(o.push(_,m,p),o):[_,m,p]}function Iu(i,t,e,n,r){let s;for(t+=n;t<e;t+=n)if(s=r(i.slice(t-n,t),i.slice(t,t+n)),s)return s;return!1}function lo(i,t,e,n,r){const s=mu(Re(),i,t,e,n);return oe(r,s)?Zn(r,s)||s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:Iu(i,t,e,n,function(o,a){return ec(r,o,a)}):!1}function bu(i,t,e,n,r){return!!(lo(i,t,e,n,r)||Cn(i,t,e,n,r[0],r[1])||Cn(i,t,e,n,r[0],r[3])||Cn(i,t,e,n,r[2],r[1])||Cn(i,t,e,n,r[2],r[3]))}function kc(i,t,e,n,r){if(!bu(i,t,e[0],n,r))return!1;if(e.length===1)return!0;for(let s=1,o=e.length;s<o;++s)if(Bc(i,e[s-1],e[s],n,r)&&!lo(i,e[s-1],e[s],n,r))return!1;return!0}function Gc(i,t,e,n){for(;t<e-n;){for(let r=0;r<n;++r){const s=i[t+r];i[t+r]=i[e-n+r],i[e-n+r]=s}t+=n,e-=n}}function Lu(i,t,e,n){let r=0,s=i[e-n],o=i[e-n+1];for(;t<e;t+=n){const a=i[t],u=i[t+1];r+=(a-s)*(u+o),s=a,o=u}return r===0?void 0:r>0}function Xc(i,t,e,n,r){r=r!==void 0?r:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],u=Lu(i,t,a,n);if(s===0){if(r&&u||!r&&!u)return!1}else if(r&&!u||!r&&u)return!1;t=a}return!0}function na(i,t,e,n,r){r=r!==void 0?r:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],u=Lu(i,t,a,n);(s===0?r&&u||!r&&!u:r&&!u||!r&&u)&&Gc(i,t,a,n),t=a}return t}class wi extends Pi{constructor(t,e,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&n?(this.setFlatCoordinates(e,t),this.ends_=n):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?Ys(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new wi(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,r){return r<$s(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ic(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),bc(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,r))}containsXY(t,e){return Mu(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Pc(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),na(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,ur(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=ni(this.getExtent());this.flatInteriorPoint_=zc(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Ru(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new ea(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,n=this.ends_,r=[];let s=0;for(let o=0,a=n.length;o<a;++o){const u=n[o],c=new ea(e.slice(s,u),t);r.push(c),s=u}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Xc(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=na(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=Oc(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new wi(e,"XY",n)}getType(){return"Polygon"}intersectsExtent(t){return kc(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=Lc(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}function ia(i){const t=i[0],e=i[1],n=i[2],r=i[3],s=[t,e,t,r,n,r,n,e,t,e];return new wi(s,"XY",[s.length])}const cn={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class ho{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null}clone(){const t=this.getColor();return new ho({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){this.color_=t}}const co=ho;function Wc(i,t,e,n,r,s,o){let a,u;const c=(e-t)/n;if(c===1)a=t;else if(c===2)a=t,u=r;else if(c!==0){let l=i[t],h=i[t+1],f=0;const g=[0];for(let _=t+n;_<e;_+=n){const p=i[_],D=i[_+1];f+=Math.sqrt((p-l)*(p-l)+(D-h)*(D-h)),g.push(f),l=p,h=D}const m=r*f,d=Mh(g,m);d<0?(u=(m-g[-d-2])/(g[-d-1]-g[-d-2]),a=t+(-d-2)*n):a=t+d*n}o=o>1?o:2,s=s||new Array(o);for(let l=0;l<o;++l)s[l]=a===void 0?NaN:u===void 0?i[a+l]:ve(i[a+l],i[a+n+l],u);return s}function Yc(i,t,e,n,r,s){if(e==t)return null;let o;if(r<i[t+n-1])return s?(o=i.slice(t,t+n),o[n-1]=r,o):null;if(i[e-1]<r)return s?(o=i.slice(e-n,e),o[n-1]=r,o):null;if(r==i[t+n-1])return i.slice(t,t+n);let a=t/n,u=e/n;for(;a<u;){const f=a+u>>1;r<i[(f+1)*n-1]?u=f:a=f+1}const c=i[a*n-1];if(r==c)return i.slice((a-1)*n,(a-1)*n+n);const l=i[(a+1)*n-1],h=(r-c)/(l-c);o=[];for(let f=0;f<n-1;++f)o.push(ve(i[(a-1)*n+f],i[a*n+f],h));return o.push(r),o}function Nu(i,t,e,n){let r=i[t],s=i[t+1],o=0;for(let a=t+n;a<e;a+=n){const u=i[a],c=i[a+1];o+=Math.sqrt((u-r)*(u-r)+(c-s)*(c-s)),r=u,s=c}return o}class hr extends Pi{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){this.flatCoordinates?Ys(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()}clone(){const t=new hr(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,r){return r<$s(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(so(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),oo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,n,r))}forEachSegment(t){return Iu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,Yc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return En(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return Wc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return Nu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=Su(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new hr(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return lo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ao(this.flatCoordinates,0,t,this.stride),this.changed()}}const Uc=hr;class fo{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new fo({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}const Ou=fo,Xt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function ra(i){return i[0]>0&&i[1]>0}function Zc(i,t,e){return e===void 0&&(e=[0,0]),e[0]=i[0]*t+.5|0,e[1]=i[1]*t+.5|0,e}function De(i,t){return Array.isArray(i)?i:(t===void 0?t=[i,i]:(t[0]=i,t[1]=i),t)}class go{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=De(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new go({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return gt()}getImage(t){return gt()}getHitDetectionImage(){return gt()}getPixelRatio(t){return 1}getImageState(){return gt()}getImageSize(){return gt()}getOrigin(){return gt()}getSize(){return gt()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=De(t)}listenImageChange(t){gt()}load(){gt()}unlistenImageChange(t){gt()}}const Pu=go,Vc=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,Kc=/^([a-z]*)$|^hsla?\(.*\)$/i;function Bu(i){return typeof i=="string"?i:zu(i)}function $c(i){const t=document.createElement("div");if(t.style.color=i,t.style.color!==""){document.body.appendChild(t);const e=getComputedStyle(t).color;return document.body.removeChild(t),e}return""}const qc=function(){const t={};let e=0;return function(n){let r;if(t.hasOwnProperty(n))r=t[n];else{if(e>=1024){let s=0;for(const o in t)s++&3||(delete t[o],--e)}r=Hc(n),t[n]=r,++e}return r}}();function cr(i){return Array.isArray(i)?i:qc(i)}function Hc(i){let t,e,n,r,s;if(Kc.exec(i)&&(i=$c(i)),Vc.exec(i)){const o=i.length-1;let a;o<=4?a=1:a=2;const u=o===4||o===8;t=parseInt(i.substr(1+0*a,a),16),e=parseInt(i.substr(1+1*a,a),16),n=parseInt(i.substr(1+2*a,a),16),u?r=parseInt(i.substr(1+3*a,a),16):r=255,a==1&&(t=(t<<4)+t,e=(e<<4)+e,n=(n<<4)+n,u&&(r=(r<<4)+r)),s=[t,e,n,r/255]}else i.startsWith("rgba(")?(s=i.slice(5,-1).split(",").map(Number),sa(s)):i.startsWith("rgb(")?(s=i.slice(4,-1).split(",").map(Number),s.push(1),sa(s)):lt(!1,14);return s}function sa(i){return i[0]=kt(i[0]+.5|0,0,255),i[1]=kt(i[1]+.5|0,0,255),i[2]=kt(i[2]+.5|0,0,255),i[3]=kt(i[3],0,1),i}function zu(i){let t=i[0];t!=(t|0)&&(t=t+.5|0);let e=i[1];e!=(e|0)&&(e=e+.5|0);let n=i[2];n!=(n|0)&&(n=n+.5|0);const r=i[3]===void 0?1:Math.round(i[3]*100)/100;return"rgba("+t+","+e+","+n+","+r+")"}function Be(i){return Array.isArray(i)?zu(i):i}function ce(i,t,e,n){let r;return e&&e.length?r=e.shift():Zs?r=new OffscreenCanvas(i||300,t||300):r=document.createElement("canvas"),i&&(r.width=i),t&&(r.height=t),r.getContext("2d",n)}function Nr(i){const t=i.canvas;t.width=1,t.height=1,i.clearRect(0,0,1,1)}function oa(i,t){const e=t.parentNode;e&&e.replaceChild(i,t)}function Cs(i){return i&&i.parentNode?i.parentNode.removeChild(i):null}function jc(i){for(;i.lastChild;)i.removeChild(i.lastChild)}function Jc(i,t){const e=i.childNodes;for(let n=0;;++n){const r=e[n],s=t[n];if(!r&&!s)break;if(r!==s){if(!r){i.appendChild(s);continue}if(!s){i.removeChild(r),--n;continue}i.insertBefore(s,r)}}}const $i="ol-hidden",Or="ol-unselectable",mo="ol-control",aa="ol-collapsed",Qc=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),ua=["style","variant","weight","size","lineHeight","family"],ku=function(i){const t=i.match(Qc);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let n=0,r=ua.length;n<r;++n){const s=t[n+1];s!==void 0&&(e[ua[n]]=s)}return e.families=e.family.split(/,\s?/),e},Gu="10px sans-serif",qe="#000",fr="round",xi=[],Ai=0,ii="round",Fi=10,Si="#000",Ti="center",dr="middle",wn=[0,0,0,0],Ri=1,Ke=new We;let Gn=null,ws;const xs={},tf=function(){const t="32px ",e=["monospace","serif"],n=e.length,r="wmytzilWMYTZIL@#/&?$%10";let s,o;function a(c,l,h){let f=!0;for(let g=0;g<n;++g){const m=e[g];if(o=gr(c+" "+l+" "+t+m,r),h!=m){const d=gr(c+" "+l+" "+t+h+","+m,r);f=f&&d!=o}}return!!f}function u(){let c=!0;const l=Ke.getKeys();for(let h=0,f=l.length;h<f;++h){const g=l[h];Ke.get(g)<100&&(a.apply(this,g.split(`
`))?(Ni(xs),Gn=null,ws=void 0,Ke.set(g,100)):(Ke.set(g,Ke.get(g)+1,!0),c=!1))}c&&(clearInterval(s),s=void 0)}return function(c){const l=ku(c);if(!l)return;const h=l.families;for(let f=0,g=h.length;f<g;++f){const m=h[f],d=l.style+`
`+l.weight+`
`+m;Ke.get(d)===void 0&&(Ke.set(d,100,!0),a(l.style,l.weight,m)||(Ke.set(d,0,!0),s===void 0&&(s=setInterval(u,32))))}}}(),ef=function(){let i;return function(t){let e=xs[t];if(e==null){if(Zs){const n=ku(t),r=Xu(t,"Žg");e=(isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else i||(i=document.createElement("div"),i.innerHTML="M",i.style.minHeight="0",i.style.maxHeight="none",i.style.height="auto",i.style.padding="0",i.style.border="none",i.style.position="absolute",i.style.display="block",i.style.left="-99999px"),i.style.font=t,document.body.appendChild(i),e=i.offsetHeight,document.body.removeChild(i);xs[t]=e}return e}}();function Xu(i,t){return Gn||(Gn=ce(1,1)),i!=ws&&(Gn.font=i,ws=Gn.font),Gn.measureText(t)}function gr(i,t){return Xu(i,t).width}function la(i,t,e){if(t in e)return e[t];const n=t.split(`
`).reduce((r,s)=>Math.max(r,gr(i,s)),0);return e[t]=n,n}function nf(i,t){const e=[],n=[],r=[];let s=0,o=0,a=0,u=0;for(let c=0,l=t.length;c<=l;c+=2){const h=t[c];if(h===`
`||c===l){s=Math.max(s,o),r.push(o),o=0,a+=u;continue}const f=t[c+1]||i.font,g=gr(f,h);e.push(g),o+=g;const m=ef(f);n.push(m),u=Math.max(u,m)}return{width:s,height:a,widths:e,heights:n,lineWidths:r}}function rf(i,t,e,n,r,s,o,a,u,c,l){i.save(),e!==1&&(i.globalAlpha*=e),t&&i.setTransform.apply(i,t),n.contextInstructions?(i.translate(u,c),i.scale(l[0],l[1]),sf(n,i)):l[0]<0||l[1]<0?(i.translate(u,c),i.scale(l[0],l[1]),i.drawImage(n,r,s,o,a,0,0,o,a)):i.drawImage(n,r,s,o,a,u,c,o*l[0],a*l[1]),i.restore()}function sf(i,t){const e=i.contextInstructions;for(let n=0,r=e.length;n<r;n+=2)Array.isArray(e[n+1])?t[e[n]].apply(t,e[n+1]):t[e[n]]=e[n+1]}class _o extends Pu{constructor(t){const e=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:1,rotateWithView:e,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvas_=void 0,this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=t.radius!==void 0?t.radius:t.radius1,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_=null,this.renderOptions_=null,this.render()}clone(){const t=this.getScale(),e=new _o({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_;if(!t)return null;const e=this.getDisplacement(),n=this.getScaleArray();return[t[0]/2-e[0]/n[0],t[1]/2+e[1]/n[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_}getImage(t){let e=this.canvas_[t];if(!e){const n=this.renderOptions_,r=ce(n.size*t,n.size*t);this.draw_(n,r,t),e=r.canvas,this.canvas_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return Xt.LOADED}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,n){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let r=this.radius_,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const C=r;r=s,s=C}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,u=s*Math.sin(a),c=Math.sqrt(s*s-u*u),l=r-c,h=Math.sqrt(u*u+l*l),f=h/u;if(t==="miter"&&f<=n)return f*e;const g=e/2/f,m=e/2*(l/h),_=Math.sqrt((r+g)*(r+g)+m*m)-r;if(this.radius2_===void 0||t==="bevel")return _*2;const p=r*Math.sin(a),D=Math.sqrt(r*r-p*p),v=s-D,E=Math.sqrt(p*p+v*v)/p;if(E<=n){const C=E*e/2-s-r;return 2*Math.max(_,C)}return _*2}createRenderOptions(){let t=ii,e=0,n=null,r=0,s,o=0;this.stroke_&&(s=this.stroke_.getColor(),s===null&&(s=Si),s=Be(s),o=this.stroke_.getWidth(),o===void 0&&(o=Ri),n=this.stroke_.getLineDash(),r=this.stroke_.getLineDashOffset(),t=this.stroke_.getLineJoin(),t===void 0&&(t=ii),e=this.stroke_.getMiterLimit(),e===void 0&&(e=Fi));const a=this.calculateLineJoinSize_(t,o,e),u=Math.max(this.radius_,this.radius2_||0),c=Math.ceil(2*u+a);return{strokeStyle:s,strokeWidth:o,size:c,lineDash:n,lineDashOffset:r,lineJoin:t,miterLimit:e}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvas_={},this.size_=[t,t]}draw_(t,e,n){if(e.scale(n,n),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let r=this.fill_.getColor();r===null&&(r=qe),e.fillStyle=Be(r),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){if(this.fill_){let e=this.fill_.getColor(),n=0;if(typeof e=="string"&&(e=cr(e)),e===null?n=1:Array.isArray(e)&&(n=e.length===4?e[3]:1),n===0){const r=ce(t.size,t.size);this.hitDetectionCanvas_=r.canvas,this.drawHitDetectionCanvas_(t,r)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))}createPath_(t){let e=this.points_;const n=this.radius_;if(e===1/0)t.arc(0,0,n,0,2*Math.PI);else{const r=this.radius2_===void 0?n:this.radius2_;this.radius2_!==void 0&&(e*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/e;for(let a=0;a<e;a++){const u=s+a*o,c=a%2===0?n:r;t.lineTo(c*Math.cos(u),c*Math.sin(u))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=qe,e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}}const Wu=_o;class po extends Wu{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new po({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius_=t,this.render()}}const Yu=po;class Pr{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=ha,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new Pr({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=ha,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function of(i){let t;if(typeof i=="function")t=i;else{let e;Array.isArray(i)?e=i:(lt(typeof i.getZIndex=="function",41),e=[i]),t=function(){return e}}return t}let Hr=null;function af(i,t){if(!Hr){const e=new co({color:"rgba(255,255,255,0.4)"}),n=new Ou({color:"#3399CC",width:1.25});Hr=[new Pr({image:new Yu({fill:e,stroke:n,radius:5}),fill:e,stroke:n})]}return Hr}function ha(i){return i.getGeometry()}const As=Pr,uf="#333";class vo{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=De(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new co({color:uf}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding}clone(){const t=this.getScale();return new vo({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=De(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const lf=vo,pt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class hf extends We{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[pt.OPACITY]=t.opacity!==void 0?t.opacity:1,lt(typeof e[pt.OPACITY]=="number",64),e[pt.VISIBLE]=t.visible!==void 0?t.visible:!0,e[pt.Z_INDEX]=t.zIndex,e[pt.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[pt.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[pt.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[pt.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},n=this.getZIndex();return e.opacity=kt(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=n===void 0&&!e.managed?1/0:n,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return gt()}getLayerStatesArray(t){return gt()}getExtent(){return this.get(pt.EXTENT)}getMaxResolution(){return this.get(pt.MAX_RESOLUTION)}getMinResolution(){return this.get(pt.MIN_RESOLUTION)}getMinZoom(){return this.get(pt.MIN_ZOOM)}getMaxZoom(){return this.get(pt.MAX_ZOOM)}getOpacity(){return this.get(pt.OPACITY)}getSourceState(){return gt()}getVisible(){return this.get(pt.VISIBLE)}getZIndex(){return this.get(pt.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(pt.EXTENT,t)}setMaxResolution(t){this.set(pt.MAX_RESOLUTION,t)}setMinResolution(t){this.set(pt.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(pt.MAX_ZOOM,t)}setMinZoom(t){this.set(pt.MIN_ZOOM,t)}setOpacity(t){lt(typeof t=="number",64),this.set(pt.OPACITY,t)}setVisible(t){this.set(pt.VISIBLE,t)}setZIndex(t){this.set(pt.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const Uu=hf,se={ANIMATING:0,INTERACTING:1},xe={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},cf=42,Do=256;function ca(i,t,e){return function(n,r,s,o,a){if(!n)return;if(!r&&!t)return n;const u=t?0:s[0]*r,c=t?0:s[1]*r,l=a?a[0]:0,h=a?a[1]:0;let f=i[0]+u/2+l,g=i[2]-u/2+l,m=i[1]+c/2+h,d=i[3]-c/2+h;f>g&&(f=(g+f)/2,g=f),m>d&&(m=(d+m)/2,d=m);let _=kt(n[0],f,g),p=kt(n[1],m,d);if(o&&e&&r){const D=30*r;_+=-D*Math.log(1+Math.max(0,f-n[0])/D)+D*Math.log(1+Math.max(0,n[0]-g)/D),p+=-D*Math.log(1+Math.max(0,m-n[1])/D)+D*Math.log(1+Math.max(0,n[1]-d)/D)}return[_,p]}}function ff(i){return i}function yo(i,t,e,n){const r=xt(t)/e[0],s=Ge(t)/e[1];return n?Math.min(i,Math.max(r,s)):Math.min(i,Math.min(r,s))}function Eo(i,t,e){let n=Math.min(i,t);const r=50;return n*=Math.log(1+r*Math.max(0,i/t-1))/r+1,e&&(n=Math.max(n,e),n/=Math.log(1+r*Math.max(0,e/i-1))/r+1),kt(n,e/2,t*2)}function df(i,t,e,n){return t=t!==void 0?t:!0,function(r,s,o,a){if(r!==void 0){const u=i[0],c=i[i.length-1],l=e?yo(u,e,o,n):u;if(a)return t?Eo(r,l,c):kt(r,c,l);const h=Math.min(l,r),f=Math.floor(Ws(i,h,s));return i[f]>l&&f<i.length-1?i[f+1]:i[f]}}}function gf(i,t,e,n,r,s){return n=n!==void 0?n:!0,e=e!==void 0?e:0,function(o,a,u,c){if(o!==void 0){const l=r?yo(t,r,u,s):t;if(c)return n?Eo(o,l,e):kt(o,e,l);const h=1e-9,f=Math.ceil(Math.log(t/l)/Math.log(i)-h),g=-a*(.5-h)+.5,m=Math.min(l,o),d=Math.floor(Math.log(t/m)/Math.log(i)+g),_=Math.max(f,d),p=t/Math.pow(i,_);return kt(p,e,l)}}}function fa(i,t,e,n,r){return e=e!==void 0?e:!0,function(s,o,a,u){if(s!==void 0){const c=n?yo(i,n,a,r):i;return!e||!u?kt(s,t,c):Eo(s,c,t)}}}function Co(i){if(i!==void 0)return 0}function da(i){if(i!==void 0)return i}function mf(i){const t=2*Math.PI/i;return function(e,n){if(n)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function _f(i){return i=i||nr(5),function(t,e){if(e)return t;if(t!==void 0)return Math.abs(t)<=i?0:t}}function Zu(i){return Math.pow(i,3)}function oi(i){return 1-Zu(1-i)}function pf(i){return 3*i*i-2*i*i*i}function vf(i){return i}const jr=0;class Df extends We{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=eo(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&Cu(),t.center&&(t.center=Ve(t.center,this.projection_)),t.extent&&(t.extent=yn(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const a in xe)delete e[a];this.setProperties(e,!0);const n=Ef(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=n.minZoom;const r=yf(t),s=n.constraint,o=Cf(t);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const n=this.getCenterInternal();if(n){const r=t||[0,0,0,0];e=e||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-e[3]+e[1]-r[1]),a=s/2*(r[0]-e[0]+e[2]-r[2]);this.setCenterInternal([n[0]+o,n[1]-a])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let n=0;n<e.length;++n){let r=arguments[n];r.center&&(r=Object.assign({},r),r.center=Ve(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Ve(r.anchor,this.getProjection())),e[n]=r}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,n;e>1&&typeof arguments[e-1]=="function"&&(n=arguments[e-1],--e);let r=0;for(;r<e&&!this.isDef();++r){const l=arguments[r];l.center&&this.setCenterInternal(l.center),l.zoom!==void 0?this.setZoom(l.zoom):l.resolution&&this.setResolution(l.resolution),l.rotation!==void 0&&this.setRotation(l.rotation)}if(r===e){n&&qi(n,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,u=this.targetRotation_;const c=[];for(;r<e;++r){const l=arguments[r],h={start:s,complete:!1,anchor:l.anchor,duration:l.duration!==void 0?l.duration:1e3,easing:l.easing||pf,callback:n};if(l.center&&(h.sourceCenter=o,h.targetCenter=l.center.slice(),o=h.targetCenter),l.zoom!==void 0?(h.sourceResolution=a,h.targetResolution=this.getResolutionForZoom(l.zoom),a=h.targetResolution):l.resolution&&(h.sourceResolution=a,h.targetResolution=l.resolution,a=h.targetResolution),l.rotation!==void 0){h.sourceRotation=u;const f=An(l.rotation-u+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=u+f,u=h.targetRotation}wf(h)?h.complete=!0:s+=h.duration,c.push(h)}this.animations_.push(c),this.setHint(se.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[se.ANIMATING]>0}getInteracting(){return this.hints_[se.INTERACTING]>0}cancelAnimations(){this.setHint(se.ANIMATING,-this.hints_[se.ANIMATING]);let t;for(let e=0,n=this.animations_.length;e<n;++e){const r=this.animations_[e];if(r[0].callback&&qi(r[0].callback,!1),!t)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let n=this.animations_.length-1;n>=0;--n){const r=this.animations_[n];let s=!0;for(let o=0,a=r.length;o<a;++o){const u=r[o];if(u.complete)continue;const c=t-u.start;let l=u.duration>0?c/u.duration:1;l>=1?(u.complete=!0,l=1):s=!1;const h=u.easing(l);if(u.sourceCenter){const f=u.sourceCenter[0],g=u.sourceCenter[1],m=u.targetCenter[0],d=u.targetCenter[1];this.nextCenter_=u.targetCenter;const _=f+h*(m-f),p=g+h*(d-g);this.targetCenter_=[_,p]}if(u.sourceResolution&&u.targetResolution){const f=h===1?u.targetResolution:u.sourceResolution+h*(u.targetResolution-u.sourceResolution);if(u.anchor){const g=this.getViewportSize_(this.getRotation()),m=this.constraints_.resolution(f,0,g,!0);this.targetCenter_=this.calculateCenterZoom(m,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=f,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const f=h===1?An(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+h*(u.targetRotation-u.sourceRotation);if(u.anchor){const g=this.constraints_.rotation(f,!0);this.targetCenter_=this.calculateCenterRotate(g,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=f}if(this.applyTargetState_(!0),e=!0,!u.complete)break}if(s){this.animations_[n]=null,this.setHint(se.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&qi(o,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let n;const r=this.getCenterInternal();return r!==void 0&&(n=[r[0]-e[0],r[1]-e[1]],Qs(n,t-this.getRotation()),mc(n,e)),n}calculateCenterZoom(t,e){let n;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=e[0]-t*(e[0]-r[0])/s,a=e[1]-t*(e[1]-r[1])/s;n=[o,a]}return n}getViewportSize_(t){const e=this.viewportSize_;if(t){const n=e[0],r=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(r*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&Es(t,this.getProjection())}getCenterInternal(){return this.get(xe.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return xu(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();lt(e,1);const n=this.getResolution();lt(n!==void 0,2);const r=this.getRotation();return lt(r!==void 0,3),ms(e,n,r,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(xe.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(yn(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const n=xt(t)/e[0],r=Ge(t)/e[1];return Math.max(n,r)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(e/n)/Math.log(t);return function(s){return e/Math.pow(t,s*r)}}getRotation(){return this.get(xe.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(n/r)/e;return function(o){return Math.log(n/o)/e/s}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),n=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=Jr(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],e,n)}return{center:r.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,n,r;if(this.resolutions_){const s=Ws(this.resolutions_,t,1);e=s,n=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=n/this.resolutions_[s+1]}else n=this.maxResolution_,r=this.zoomFactor_;return e+Math.log(n/t)/Math.log(r)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=kt(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,kt(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let n;if(lt(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function",24),Array.isArray(t)){lt(!Hs(t),25);const r=yn(t,this.getProjection());n=ia(r)}else if(t.getType()==="Circle"){const r=yn(t.getExtent(),this.getProjection());n=ia(r),n.rotate(this.getRotation(),ni(r))}else n=t;this.fitInternal(n,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),n=Math.cos(e),r=Math.sin(-e),s=t.getFlatCoordinates(),o=t.getStride();let a=1/0,u=1/0,c=-1/0,l=-1/0;for(let h=0,f=s.length;h<f;h+=o){const g=s[h]*n-s[h+1]*r,m=s[h]*r+s[h+1]*n;a=Math.min(a,g),u=Math.min(u,m),c=Math.max(c,g),l=Math.max(l,m)}return[a,u,c,l]}fitInternal(t,e){e=e||{};let n=e.size;n||(n=this.getViewportSizeMinusPadding_());const r=e.padding!==void 0?e.padding:[0,0,0,0],s=e.nearest!==void 0?e.nearest:!1;let o;e.minResolution!==void 0?o=e.minResolution:e.maxZoom!==void 0?o=this.getResolutionForZoom(e.maxZoom):o=0;const a=this.rotatedExtentForGeometry(t);let u=this.getResolutionForExtentInternal(a,[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]);u=isNaN(u)?o:Math.max(u,o),u=this.getConstrainedResolution(u,s?0:1);const c=this.getRotation(),l=Math.sin(c),h=Math.cos(c),f=ni(a);f[0]+=(r[1]-r[3])/2*u,f[1]+=(r[0]-r[2])/2*u;const g=f[0]*h-f[1]*l,m=f[1]*h+f[0]*l,d=this.getConstrainedCenter([g,m],u),_=e.callback?e.callback:ei;e.duration!==void 0?this.animateInternal({resolution:u,center:d,duration:e.duration,easing:e.easing},_):(this.targetResolution_=u,this.targetCenter_=d,this.applyTargetState_(!1,!0),qi(_,!0))}centerOn(t,e,n){this.centerOnInternal(Ve(t,this.getProjection()),e,n)}centerOnInternal(t,e,n){this.setCenterInternal(Jr(t,e,n,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,n,r){let s;const o=this.padding_;if(o&&t){const a=this.getViewportSizeMinusPadding_(-n),u=Jr(t,r,[a[0]/2+o[3],a[1]/2+o[0]],e,n);s=[t[0]-u[0],t[1]-u[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=Es(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Ve(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const n=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*t,0,r,n);e&&(this.targetCenter_=this.calculateCenterZoom(s,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Ve(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const n=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&Ve(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const n=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,n),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,n),a=this.constraints_.center(this.targetCenter_,o,s,n,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(xe.ROTATION)!==r&&this.set(xe.ROTATION,r),this.get(xe.RESOLUTION)!==o&&(this.set(xe.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(xe.CENTER)||!or(this.get(xe.CENTER),a))&&this.set(xe.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,n){t=t!==void 0?t:200;const r=e||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(t===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=u,this.applyTargetState_();return}n=n||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!or(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:a,duration:t,easing:oi,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(se.INTERACTING,1)}endInteraction(t,e,n){n=n&&Ve(n,this.getProjection()),this.endInteractionInternal(t,e,n)}endInteractionInternal(t,e,n){this.getInteracting()&&(this.setHint(se.INTERACTING,-1),this.resolveConstraints(t,e,n))}getConstrainedCenter(t,e){const n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}getConstrainedZoom(t,e){const n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}getConstrainedResolution(t,e){e=e||0;const n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}}function qi(i,t){setTimeout(function(){i(t)},0)}function yf(i){if(i.extent!==void 0){const e=i.smoothExtentConstraint!==void 0?i.smoothExtentConstraint:!0;return ca(i.extent,i.constrainOnlyCenter,e)}const t=eo(i.projection,"EPSG:3857");if(i.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,ca(e,!1,!1)}return ff}function Ef(i){let t,e,n,o=i.minZoom!==void 0?i.minZoom:jr,a=i.maxZoom!==void 0?i.maxZoom:28;const u=i.zoomFactor!==void 0?i.zoomFactor:2,c=i.multiWorld!==void 0?i.multiWorld:!1,l=i.smoothResolutionConstraint!==void 0?i.smoothResolutionConstraint:!0,h=i.showFullExtent!==void 0?i.showFullExtent:!1,f=eo(i.projection,"EPSG:3857"),g=f.getExtent();let m=i.constrainOnlyCenter,d=i.extent;if(!c&&!d&&f.isGlobal()&&(m=!1,d=g),i.resolutions!==void 0){const _=i.resolutions;e=_[o],n=_[a]!==void 0?_[a]:_[_.length-1],i.constrainResolution?t=df(_,l,!m&&d,h):t=fa(e,n,l,!m&&d,h)}else{const p=(g?Math.max(xt(g),Ge(g)):360*Ci.degrees/f.getMetersPerUnit())/Do/Math.pow(2,jr),D=p/Math.pow(2,28-jr);e=i.maxResolution,e!==void 0?o=0:e=p/Math.pow(u,o),n=i.minResolution,n===void 0&&(i.maxZoom!==void 0?i.maxResolution!==void 0?n=e/Math.pow(u,a):n=p/Math.pow(u,a):n=D),a=o+Math.floor(Math.log(e/n)/Math.log(u)),n=e/Math.pow(u,a-o),i.constrainResolution?t=gf(u,e,n,l,!m&&d,h):t=fa(e,n,l,!m&&d,h)}return{constraint:t,maxResolution:e,minResolution:n,minZoom:o,zoomFactor:u}}function Cf(i){if(i.enableRotation!==void 0?i.enableRotation:!0){const e=i.constrainRotation;return e===void 0||e===!0?_f():e===!1?da:typeof e=="number"?mf(e):da}return Co}function wf(i){return!(i.sourceCenter&&i.targetCenter&&!or(i.sourceCenter,i.targetCenter)||i.sourceResolution!==i.targetResolution||i.sourceRotation!==i.targetRotation)}function Jr(i,t,e,n,r){const s=Math.cos(-r);let o=Math.sin(-r),a=i[0]*s-i[1]*o,u=i[1]*s+i[0]*o;a+=(t[0]/2-e[0])*n,u+=(e[1]-t[1]/2)*n,o=-o;const c=a*s-u*o,l=u*s+a*o;return[c,l]}const Ne=Df;class xf extends Uu{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(pt.SOURCE,this.handleSourcePropertyChange_);const n=t.source?t.source:null;this.setSource(n)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(pt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(St(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=mt(t,at.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e;t instanceof Ne?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t;const n=this.getExtent();return this.getVisible()&&wo(this.getLayerState(),e.viewState)&&(!n||oe(n,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e;const n=this.getSource();if(n&&(e=n.getAttributions()),!e)return[];const r=t instanceof Ne?t.getViewStateAndExtent():t;let s=e(r);return Array.isArray(s)||(s=[s]),s}render(t,e){const n=this.getRenderer();if(n.prepareFrame(t))return this.rendered=!0,n.renderFrame(t,e)}unrender(){this.rendered=!1}setMapInternal(t){t||this.unrender(),this.set(pt.MAP,t)}getMapInternal(){return this.get(pt.MAP)}setMap(t){this.mapPrecomposeKey_&&(St(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(St(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=mt(t,cn.PRECOMPOSE,function(e){const r=e.frameState.layerStatesArray,s=this.getLayerState(!1);lt(!r.some(function(o){return o.layer===s.layer}),67),r.push(s)},this),this.mapRenderKey_=mt(this,at.CHANGE,t.render,t),this.changed())}setSource(t){this.set(pt.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}}function wo(i,t){if(!i.visible)return!1;const e=t.resolution;if(e<i.minResolution||e>=i.maxResolution)return!1;const n=t.zoom;return n>i.minZoom&&n<=i.maxZoom}const Br=xf;function Af(i,t,e,n,r){Vu(i,t,e||0,n||i.length-1,r||Ff)}function Vu(i,t,e,n,r){for(;n>e;){if(n-e>600){var s=n-e+1,o=t-e+1,a=Math.log(s),u=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*u*(s-u)/s)*(o-s/2<0?-1:1),l=Math.max(e,Math.floor(t-o*u/s+c)),h=Math.min(n,Math.floor(t+(s-o)*u/s+c));Vu(i,t,l,h,r)}var f=i[t],g=e,m=n;for(hi(i,e,t),r(i[n],f)>0&&hi(i,e,n);g<m;){for(hi(i,g,m),g++,m--;r(i[g],f)<0;)g++;for(;r(i[m],f)>0;)m--}r(i[e],f)===0?hi(i,e,m):(m++,hi(i,m,n)),m<=t&&(e=m+1),t<=m&&(n=m-1)}}function hi(i,t,e){var n=i[t];i[t]=i[e],i[e]=n}function Ff(i,t){return i<t?-1:i>t?1:0}let Ku=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const n=[];if(!ji(t,e))return n;const r=this.toBBox,s=[];for(;e;){for(let o=0;o<e.children.length;o++){const a=e.children[o],u=e.leaf?r(a):a;ji(t,u)&&(e.leaf?n.push(a):ts(t,u)?this._all(a,n):s.push(a))}e=s.pop()}return n}collides(t){let e=this.data;if(!ji(t,e))return!1;const n=[];for(;e;){for(let r=0;r<e.children.length;r++){const s=e.children[r],o=e.leaf?this.toBBox(s):s;if(ji(t,o)){if(e.leaf||ts(t,o))return!0;n.push(s)}}e=n.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let n=0;n<t.length;n++)this.insert(t[n]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const n=this.data;this.data=e,e=n}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Xn([]),this}remove(t,e){if(!t)return this;let n=this.data;const r=this.toBBox(t),s=[],o=[];let a,u,c;for(;n||s.length;){if(n||(n=s.pop(),u=s[s.length-1],a=o.pop(),c=!0),n.leaf){const l=Sf(t,n.children,e);if(l!==-1)return n.children.splice(l,1),s.push(n),this._condense(s),this}!c&&!n.leaf&&ts(n,r)?(s.push(n),o.push(a),a=0,u=n,n=n.children[0]):u?(a++,n=u.children[a],c=!1):n=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const n=[];for(;t;)t.leaf?e.push(...t.children):n.push(...t.children),t=n.pop();return e}_build(t,e,n,r){const s=n-e+1;let o=this._maxEntries,a;if(s<=o)return a=Xn(t.slice(e,n+1)),Nn(a,this.toBBox),a;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),a=Xn([]),a.leaf=!1,a.height=r;const u=Math.ceil(s/o),c=u*Math.ceil(Math.sqrt(o));ga(t,e,n,c,this.compareMinX);for(let l=e;l<=n;l+=c){const h=Math.min(l+c-1,n);ga(t,l,h,u,this.compareMinY);for(let f=l;f<=h;f+=u){const g=Math.min(f+u-1,h);a.children.push(this._build(t,f,g,r-1))}}return Nn(a,this.toBBox),a}_chooseSubtree(t,e,n,r){for(;r.push(e),!(e.leaf||r.length-1===n);){let s=1/0,o=1/0,a;for(let u=0;u<e.children.length;u++){const c=e.children[u],l=Qr(c),h=Mf(t,c)-l;h<o?(o=h,s=l<s?l:s,a=c):h===o&&l<s&&(s=l,a=c)}e=a||e.children[0]}return e}_insert(t,e,n){const r=n?t:this.toBBox(t),s=[],o=this._chooseSubtree(r,this.data,e,s);for(o.children.push(t),di(o,r);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(r,s,e)}_split(t,e){const n=t[e],r=n.children.length,s=this._minEntries;this._chooseSplitAxis(n,s,r);const o=this._chooseSplitIndex(n,s,r),a=Xn(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,Nn(n,this.toBBox),Nn(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)}_splitRoot(t,e){this.data=Xn([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Nn(this.data,this.toBBox)}_chooseSplitIndex(t,e,n){let r,s=1/0,o=1/0;for(let a=e;a<=n-e;a++){const u=fi(t,0,a,this.toBBox),c=fi(t,a,n,this.toBBox),l=If(u,c),h=Qr(u)+Qr(c);l<s?(s=l,r=a,o=h<o?h:o):l===s&&h<o&&(o=h,r=a)}return r||n-e}_chooseSplitAxis(t,e,n){const r=t.leaf?this.compareMinX:Tf,s=t.leaf?this.compareMinY:Rf,o=this._allDistMargin(t,e,n,r),a=this._allDistMargin(t,e,n,s);o<a&&t.children.sort(r)}_allDistMargin(t,e,n,r){t.children.sort(r);const s=this.toBBox,o=fi(t,0,e,s),a=fi(t,n-e,n,s);let u=Hi(o)+Hi(a);for(let c=e;c<n-e;c++){const l=t.children[c];di(o,t.leaf?s(l):l),u+=Hi(o)}for(let c=n-e-1;c>=e;c--){const l=t.children[c];di(a,t.leaf?s(l):l),u+=Hi(a)}return u}_adjustParentBBoxes(t,e,n){for(let r=n;r>=0;r--)di(e[r],t)}_condense(t){for(let e=t.length-1,n;e>=0;e--)t[e].children.length===0?e>0?(n=t[e-1].children,n.splice(n.indexOf(t[e]),1)):this.clear():Nn(t[e],this.toBBox)}};function Sf(i,t,e){if(!e)return t.indexOf(i);for(let n=0;n<t.length;n++)if(e(i,t[n]))return n;return-1}function Nn(i,t){fi(i,0,i.children.length,t,i)}function fi(i,t,e,n,r){r||(r=Xn(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=t;s<e;s++){const o=i.children[s];di(r,i.leaf?n(o):o)}return r}function di(i,t){return i.minX=Math.min(i.minX,t.minX),i.minY=Math.min(i.minY,t.minY),i.maxX=Math.max(i.maxX,t.maxX),i.maxY=Math.max(i.maxY,t.maxY),i}function Tf(i,t){return i.minX-t.minX}function Rf(i,t){return i.minY-t.minY}function Qr(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function Hi(i){return i.maxX-i.minX+(i.maxY-i.minY)}function Mf(i,t){return(Math.max(t.maxX,i.maxX)-Math.min(t.minX,i.minX))*(Math.max(t.maxY,i.maxY)-Math.min(t.minY,i.minY))}function If(i,t){const e=Math.max(i.minX,t.minX),n=Math.max(i.minY,t.minY),r=Math.min(i.maxX,t.maxX),s=Math.min(i.maxY,t.maxY);return Math.max(0,r-e)*Math.max(0,s-n)}function ts(i,t){return i.minX<=t.minX&&i.minY<=t.minY&&t.maxX<=i.maxX&&t.maxY<=i.maxY}function ji(i,t){return t.minX<=i.maxX&&t.minY<=i.maxY&&t.maxX>=i.minX&&t.maxY>=i.minY}function Xn(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ga(i,t,e,n,r){const s=[t,e];for(;s.length;){if(e=s.pop(),t=s.pop(),e-t<=n)continue;const o=t+Math.ceil((e-t)/n/2)*n;Af(i,o,t,e,r),s.push(t,o,o,e)}}class bf{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const n=this.cache_[e];!(t++&3)&&!n.hasListener()&&(delete this.cache_[e],--this.cacheSize_)}}}get(t,e,n){const r=ma(t,e,n);return r in this.cache_?this.cache_[r]:null}set(t,e,n,r){const s=ma(t,e,n);this.cache_[s]=r,++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function ma(i,t,e){const n=e?Bu(e):"null";return t+":"+i+":"+n}const mr=new bf;function $u(i,t,e){const n=i;let r=!0,s=!1,o=!1;const a=[rr(n,at.LOAD,function(){o=!0,s||t()})];return n.src&&Uh?(s=!0,n.decode().then(function(){r&&t()}).catch(function(u){r&&(o?t():e())})):a.push(rr(n,at.ERROR,e)),function(){r=!1,a.forEach(St)}}let ci=null;class Lf extends Sr{constructor(t,e,n,r,s,o){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=r,this.canvas_={},this.color_=o,this.unlisten_=null,this.imageState_=s,this.size_=n,this.src_=e,this.tainted_}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Xt.LOADED){ci||(ci=ce(1,1,void 0,{willReadFrequently:!0})),ci.drawImage(this.image_,0,0);try{ci.getImageData(0,0,1,1),this.tainted_=!1}catch{ci=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(at.CHANGE)}handleImageError_(){this.imageState_=Xt.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Xt.LOADED,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],n=ce(t,e);n.fillRect(0,0,t,e),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Xt.IDLE){this.image_||this.initializeImage_(),this.imageState_=Xt.LOADING;try{this.image_.src=this.src_}catch{this.handleImageError_()}this.unlisten_=$u(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==Xt.LOADED)return;const e=this.image_,n=document.createElement("canvas");n.width=Math.ceil(e.width*t),n.height=Math.ceil(e.height*t);const r=n.getContext("2d");r.scale(t,t),r.drawImage(e,0,0),r.globalCompositeOperation="multiply",r.fillStyle=Bu(this.color_),r.fillRect(0,0,n.width/t,n.height/t),r.globalCompositeOperation="destination-in",r.drawImage(e,0,0),this.canvas_[t]=n}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function Nf(i,t,e,n,r,s){let o=mr.get(t,n,s);return o||(o=new Lf(i,t,e,n,r,s),mr.set(t,n,s,o)),o}class xo extends Pu{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,n=t.rotation!==void 0?t.rotation:0,r=t.scale!==void 0?t.scale:1,s=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:n,scale:r,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:s,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const o=t.img!==void 0?t.img:null;this.imgSize_=t.imgSize;let a=t.src;lt(!(a!==void 0&&o),4),lt(!o||o&&this.imgSize_,5),(a===void 0||a.length===0)&&o&&(a=o.src||_t(o)),lt(a!==void 0&&a.length>0,6),lt(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),69);const u=t.src!==void 0?Xt.IDLE:Xt.LOADED;if(this.color_=t.color!==void 0?cr(t.color):null,this.iconImage_=Nf(o,a,this.imgSize_!==void 0?this.imgSize_:null,this.crossOrigin_,u,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,this.width_=t.width,this.height_=t.height,this.width_!==void 0||this.height_!==void 0){const c=this.getImage(1),l=()=>{this.updateScaleFromWidthAndHeight(this.width_,this.height_)};c.width>0?this.updateScaleFromWidthAndHeight(this.width_,this.height_):c.addEventListener("load",l)}}clone(){let t=this.getScale();return t=Array.isArray(t)?t.slice():t,(this.width_!==void 0||this.height_!==void 0)&&(t=void 0),new xo({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,imgSize:this.imgSize_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode(),width:this.width_,height:this.height_})}updateScaleFromWidthAndHeight(t,e){const n=this.getImage(1);t!==void 0&&e!==void 0?super.setScale([t/n.width,e/n.height]):t!==void 0?super.setScale([t/n.width,t/n.width]):e!==void 0?super.setScale([e/n.height,e/n.height]):super.setScale([1,1])}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=r[0]),this.anchorYUnits_=="fraction"&&(t[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+r[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),n=this.getScaleArray();return[t[0]-e[0]/n[0],t[1]+e[1]/n[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),n=this.iconImage_.getSize();if(!e||!n)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=n[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=n[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){return this.width_}getHeight(){return this.height_}setWidth(t){this.width_=t,this.updateScaleFromWidthAndHeight(t,this.height_)}setHeight(t){this.height_=t,this.updateScaleFromWidthAndHeight(this.width_,t)}setScale(t){super.setScale(t);const e=this.getImage(1);if(e){const n=Array.isArray(t)?t[0]:t;n!==void 0&&(this.width_=n*e.width);const r=Array.isArray(t)?t[1]:t;r!==void 0&&(this.height_=r*e.height)}}listenImageChange(t){this.iconImage_.addEventListener(at.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(at.CHANGE,t)}}const qu=xo;function _a(i){return new As({fill:Mi(i,""),stroke:Ii(i,""),text:Of(i),image:Pf(i)})}function Mi(i,t){const e=i[t+"fill-color"];if(e)return new co({color:e})}function Ii(i,t){const e=i[t+"stroke-width"],n=i[t+"stroke-color"];if(!(!e&&!n))return new Ou({width:e,color:n,lineCap:i[t+"stroke-line-cap"],lineJoin:i[t+"stroke-line-join"],lineDash:i[t+"stroke-line-dash"],lineDashOffset:i[t+"stroke-line-dash-offset"],miterLimit:i[t+"stroke-miter-limit"]})}function Of(i){const t=i["text-value"];return t?new lf({text:t,font:i["text-font"],maxAngle:i["text-max-angle"],offsetX:i["text-offset-x"],offsetY:i["text-offset-y"],overflow:i["text-overflow"],placement:i["text-placement"],repeat:i["text-repeat"],scale:i["text-scale"],rotateWithView:i["text-rotate-with-view"],rotation:i["text-rotation"],textAlign:i["text-align"],justify:i["text-justify"],textBaseline:i["text-baseline"],padding:i["text-padding"],fill:Mi(i,"text-"),backgroundFill:Mi(i,"text-background-"),stroke:Ii(i,"text-"),backgroundStroke:Ii(i,"text-background-")}):void 0}function Pf(i){const t=i["icon-src"],e=i["icon-img"];if(t||e)return new qu({src:t,img:e,imgSize:i["icon-img-size"],anchor:i["icon-anchor"],anchorOrigin:i["icon-anchor-origin"],anchorXUnits:i["icon-anchor-x-units"],anchorYUnits:i["icon-anchor-y-units"],color:i["icon-color"],crossOrigin:i["icon-cross-origin"],offset:i["icon-offset"],displacement:i["icon-displacement"],opacity:i["icon-opacity"],scale:i["icon-scale"],rotation:i["icon-rotation"],rotateWithView:i["icon-rotate-with-view"],size:i["icon-size"],declutterMode:i["icon-declutter-mode"]});const n=i["shape-points"];if(n){const s="shape-";return new Wu({points:n,fill:Mi(i,s),stroke:Ii(i,s),radius:i["shape-radius"],radius1:i["shape-radius1"],radius2:i["shape-radius2"],angle:i["shape-angle"],displacement:i["shape-displacement"],rotation:i["shape-rotation"],rotateWithView:i["shape-rotate-with-view"],scale:i["shape-scale"],declutterMode:i["shape-declutter-mode"]})}const r=i["circle-radius"];if(r){const s="circle-";return new Yu({radius:r,fill:Mi(i,s),stroke:Ii(i,s),displacement:i["circle-displacement"],scale:i["circle-scale"],rotation:i["circle-rotation"],rotateWithView:i["circle-rotate-with-view"],declutterMode:i["circle-declutter-mode"]})}}const pa={RENDER_ORDER:"renderOrder"};class Bf extends Br{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter!==void 0?t.declutter:!1,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(pa.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t){t.declutterTree||(t.declutterTree=new Ku(9)),this.getRenderer().renderDeclutter(t)}setRenderOrder(t){this.set(pa.RENDER_ORDER,t)}setStyle(t){let e;if(t===void 0)e=af;else if(t===null)e=null;else if(typeof t=="function")e=t;else if(t instanceof As)e=t;else if(Array.isArray(t)){const n=t.length,r=new Array(n);for(let s=0;s<n;++s){const o=t[s];o instanceof As?r[s]=o:r[s]=_a(o)}e=r}else e=_a(t);this.style_=e,this.styleFunction_=t===null?void 0:of(this.style_),this.changed()}}const zf=Bf,Bi={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Ji=[Bi.FILL],ln=[Bi.STROKE],xn=[Bi.BEGIN_PATH],va=[Bi.CLOSE_PATH],nt=Bi;class kf{drawCustom(t,e,n,r){}drawGeometry(t){}setStyle(t){}drawCircle(t,e){}drawFeature(t,e){}drawGeometryCollection(t,e){}drawLineString(t,e){}drawMultiLineString(t,e){}drawMultiPoint(t,e){}drawMultiPolygon(t,e){}drawPoint(t,e){}drawPolygon(t,e){}drawText(t,e){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}const Hu=kf;class Gf extends Hu{constructor(t,e,n,r){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=n,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(n){return n*e})}appendFlatPointCoordinates(t,e){const n=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,u=t.length;a<u;a+=e)r[0]=t[a],r[1]=t[a+1],Rr(n,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(t,e,n,r,s,o){const a=this.coordinates;let u=a.length;const c=this.getBufferedMaxExtent();o&&(e+=r);let l=t[e],h=t[e+1];const f=this.tmpCoordinate_;let g=!0,m,d,_;for(m=e+r;m<n;m+=r)f[0]=t[m],f[1]=t[m+1],_=ds(c,f),_!==d?(g&&(a[u++]=l,a[u++]=h,g=!1),a[u++]=f[0],a[u++]=f[1]):_===qt.INTERSECTING?(a[u++]=f[0],a[u++]=f[1],g=!1):g=!0,l=f[0],h=f[1],d=_;return(s&&g||m===e+r)&&(a[u++]=l,a[u++]=h),u}drawCustomCoordinates_(t,e,n,r,s){for(let o=0,a=n.length;o<a;++o){const u=n[o],c=this.appendFlatLineCoordinates(t,e,u,r,!1,!1);s.push(c),e=u}return e}drawCustom(t,e,n,r){this.beginGeometry(t,e);const s=t.getType(),o=t.getStride(),a=this.coordinates.length;let u,c,l,h,f;switch(s){case"MultiPolygon":u=t.getOrientedFlatCoordinates(),h=[];const g=t.getEndss();f=0;for(let m=0,d=g.length;m<d;++m){const _=[];f=this.drawCustomCoordinates_(u,f,g[m],o,_),h.push(_)}this.instructions.push([nt.CUSTOM,a,h,t,n,ta]),this.hitDetectionInstructions.push([nt.CUSTOM,a,h,t,r||n,ta]);break;case"Polygon":case"MultiLineString":l=[],u=s=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),f=this.drawCustomCoordinates_(u,0,t.getEnds(),o,l),this.instructions.push([nt.CUSTOM,a,l,t,n,ur]),this.hitDetectionInstructions.push([nt.CUSTOM,a,l,t,r||n,ur]);break;case"LineString":case"Circle":u=t.getFlatCoordinates(),c=this.appendFlatLineCoordinates(u,0,u.length,o,!1,!1),this.instructions.push([nt.CUSTOM,a,c,t,n,En]),this.hitDetectionInstructions.push([nt.CUSTOM,a,c,t,r||n,En]);break;case"MultiPoint":u=t.getFlatCoordinates(),c=this.appendFlatPointCoordinates(u,o),c>a&&(this.instructions.push([nt.CUSTOM,a,c,t,n,En]),this.hitDetectionInstructions.push([nt.CUSTOM,a,c,t,r||n,En]));break;case"Point":u=t.getFlatCoordinates(),this.coordinates.push(u[0],u[1]),c=this.coordinates.length,this.instructions.push([nt.CUSTOM,a,c,t,n]),this.hitDetectionInstructions.push([nt.CUSTOM,a,c,t,r||n]);break}this.endGeometry(e)}beginGeometry(t,e){this.beginGeometryInstruction1_=[nt.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[nt.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const n=t.length;let r,s,o=-1;for(e=0;e<n;++e)r=t[e],s=r[0],s==nt.END_GEOMETRY?o=e:s==nt.BEGIN_GEOMETRY&&(r[2]=e,Ih(this.hitDetectionInstructions,o,e),o=-1)}setFillStrokeStyle(t,e){const n=this.state;if(t){const r=t.getColor();n.fillStyle=Be(r||qe)}else n.fillStyle=void 0;if(e){const r=e.getColor();n.strokeStyle=Be(r||Si);const s=e.getLineCap();n.lineCap=s!==void 0?s:fr;const o=e.getLineDash();n.lineDash=o?o.slice():xi;const a=e.getLineDashOffset();n.lineDashOffset=a||Ai;const u=e.getLineJoin();n.lineJoin=u!==void 0?u:ii;const c=e.getWidth();n.lineWidth=c!==void 0?c:Ri;const l=e.getMiterLimit();n.miterLimit=l!==void 0?l:Fi,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0}createFill(t){const e=t.fillStyle,n=[nt.SET_FILL_STYLE,e];return typeof e!="string"&&n.push(!0),n}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[nt.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const n=t.fillStyle;(typeof n!="string"||t.currentFillStyle!=n)&&(n!==void 0&&this.instructions.push(e.call(this,t)),t.currentFillStyle=n)}updateStrokeStyle(t,e){const n=t.strokeStyle,r=t.lineCap,s=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,u=t.lineWidth,c=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=r||s!=t.currentLineDash&&!mn(t.currentLineDash,s)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=u||t.currentMiterLimit!=c)&&(n!==void 0&&e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=r,t.currentLineDash=s,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=u,t.currentMiterLimit=c)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[nt.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=du(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;Ks(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}const zi=Gf;class Xf extends zi{constructor(t,e,n,r){super(t,e,n,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const n=t.getFlatCoordinates(),r=t.getStride(),s=this.coordinates.length,o=this.appendFlatPointCoordinates(n,r);this.instructions.push([nt.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([nt.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const n=t.getFlatCoordinates(),r=t.getStride(),s=this.coordinates.length,o=this.appendFlatPointCoordinates(n,r);this.instructions.push([nt.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([nt.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const n=t.getAnchor(),r=t.getSize(),s=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=r[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const Wf=Xf;class Yf extends zi{constructor(t,e,n,r){super(t,e,n,r)}drawFlatCoordinates_(t,e,n,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,n,r,!1,!1),a=[nt.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),n}drawLineString(t,e){const n=this.state,r=n.strokeStyle,s=n.lineWidth;if(r===void 0||s===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([nt.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,xi,Ai],xn);const o=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(o,0,o.length,a),this.hitDetectionInstructions.push(ln),this.endGeometry(e)}drawMultiLineString(t,e){const n=this.state,r=n.strokeStyle,s=n.lineWidth;if(r===void 0||s===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([nt.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],xn);const o=t.getEnds(),a=t.getFlatCoordinates(),u=t.getStride();let c=0;for(let l=0,h=o.length;l<h;++l)c=this.drawFlatCoordinates_(a,c,o[l],u);this.hitDetectionInstructions.push(ln),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(ln),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(ln),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(xn)}}const Uf=Yf;class Zf extends zi{constructor(t,e,n,r){super(t,e,n,r)}drawFlatCoordinatess_(t,e,n,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,u=n.length;this.instructions.push(xn),this.hitDetectionInstructions.push(xn);for(let c=0;c<u;++c){const l=n[c],h=this.coordinates.length,f=this.appendFlatLineCoordinates(t,e,l,r,!0,!a),g=[nt.MOVE_TO_LINE_TO,h,f];this.instructions.push(g),this.hitDetectionInstructions.push(g),a&&(this.instructions.push(va),this.hitDetectionInstructions.push(va)),e=l}return o&&(this.instructions.push(Ji),this.hitDetectionInstructions.push(Ji)),a&&(this.instructions.push(ln),this.hitDetectionInstructions.push(ln)),e}drawCircle(t,e){const n=this.state,r=n.fillStyle,s=n.strokeStyle;if(r===void 0&&s===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([nt.SET_FILL_STYLE,qe]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([nt.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);const o=t.getFlatCoordinates(),a=t.getStride(),u=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,a,!1,!1);const c=[nt.CIRCLE,u];this.instructions.push(xn,c),this.hitDetectionInstructions.push(xn,c),n.fillStyle!==void 0&&(this.instructions.push(Ji),this.hitDetectionInstructions.push(Ji)),n.strokeStyle!==void 0&&(this.instructions.push(ln),this.hitDetectionInstructions.push(ln)),this.endGeometry(e)}drawPolygon(t,e){const n=this.state,r=n.fillStyle,s=n.strokeStyle;if(r===void 0&&s===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([nt.SET_FILL_STYLE,qe]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([nt.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);const o=t.getEnds(),a=t.getOrientedFlatCoordinates(),u=t.getStride();this.drawFlatCoordinatess_(a,0,o,u),this.endGeometry(e)}drawMultiPolygon(t,e){const n=this.state,r=n.fillStyle,s=n.strokeStyle;if(r===void 0&&s===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([nt.SET_FILL_STYLE,qe]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([nt.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);const o=t.getEndss(),a=t.getOrientedFlatCoordinates(),u=t.getStride();let c=0;for(let l=0,h=o.length;l<h;++l)c=this.drawFlatCoordinatess_(a,c,o[l],u);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let n=0,r=e.length;n<r;++n)e[n]=Dn(e[n],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;t.fillStyle!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)}}const Da=Zf;function Vf(i,t,e,n,r){const s=[];let o=e,a=0,u=t.slice(e,2);for(;a<i&&o+r<n;){const[c,l]=u.slice(-2),h=t[o+r],f=t[o+r+1],g=Math.sqrt((h-c)*(h-c)+(f-l)*(f-l));if(a+=g,a>=i){const m=(i-a+g)/g,d=ve(c,h,m),_=ve(l,f,m);u.push(d,_),s.push(u),u=[d,_],a==i&&(o+=r),a=0}else if(a<i)u.push(t[o+r],t[o+r+1]),o+=r;else{const m=g-a,d=ve(c,h,m/g),_=ve(l,f,m/g);u.push(d,_),s.push(u),u=[d,_],a=0,o+=r}}return a>0&&s.push(u),s}function Kf(i,t,e,n,r){let s=e,o=e,a=0,u=0,c=e,l,h,f,g,m,d,_,p,D,v;for(h=e;h<n;h+=r){const y=t[h],E=t[h+1];m!==void 0&&(D=y-m,v=E-d,g=Math.sqrt(D*D+v*v),_!==void 0&&(u+=f,l=Math.acos((_*D+p*v)/(f*g)),l>i&&(u>a&&(a=u,s=c,o=h),u=0,c=h-r)),f=g,_=D,p=v),m=y,d=E}return u+=g,u>a?[c,h]:[s,o]}const pi={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class $f extends zi{constructor(t,e,n,r){super(t,e,n,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e){const n=this.textFillState_,r=this.textStrokeState_,s=this.textState_;if(this.text_===""||!s||!n&&!r)return;const o=this.coordinates;let a=o.length;const u=t.getType();let c=null,l=t.getStride();if(s.placement==="line"&&(u=="LineString"||u=="MultiLineString"||u=="Polygon"||u=="MultiPolygon")){if(!oe(this.getBufferedMaxExtent(),t.getExtent()))return;let h;if(c=t.getFlatCoordinates(),u=="LineString")h=[c.length];else if(u=="MultiLineString")h=t.getEnds();else if(u=="Polygon")h=t.getEnds().slice(0,1);else if(u=="MultiPolygon"){const d=t.getEndss();h=[];for(let _=0,p=d.length;_<p;++_)h.push(d[_][0])}this.beginGeometry(t,e);const f=s.repeat,g=f?void 0:s.textAlign;let m=0;for(let d=0,_=h.length;d<_;++d){let p;f?p=Vf(f*this.resolution,c,m,h[d],l):p=[c.slice(m,h[d])];for(let D=0,v=p.length;D<v;++D){const y=p[D];let E=0,C=y.length;if(g==null){const w=Kf(s.maxAngle,y,0,y.length,2);E=w[0],C=w[1]}for(let w=E;w<C;w+=l)o.push(y[w],y[w+1]);const F=o.length;m=h[d],this.drawChars_(a,F),a=F}}this.endGeometry(e)}else{let h=s.overflow?null:[];switch(u){case"Point":case"MultiPoint":c=t.getFlatCoordinates();break;case"LineString":c=t.getFlatMidpoint();break;case"Circle":c=t.getCenter();break;case"MultiLineString":c=t.getFlatMidpoints(),l=2;break;case"Polygon":c=t.getFlatInteriorPoint(),s.overflow||h.push(c[2]/this.resolution),l=3;break;case"MultiPolygon":const _=t.getFlatInteriorPoints();c=[];for(let p=0,D=_.length;p<D;p+=3)s.overflow||h.push(_[p+2]/this.resolution),c.push(_[p],_[p+1]);if(c.length===0)return;l=2;break}const f=this.appendFlatPointCoordinates(c,l);if(f===a)return;if(h&&(f-a)/2!==c.length/l){let _=a/2;h=h.filter((p,D)=>{const v=o[(_+D)*2]===c[D*l]&&o[(_+D)*2+1]===c[D*l+1];return v||--_,v})}this.saveTextStates_(),(s.backgroundFill||s.backgroundStroke)&&(this.setFillStrokeStyle(s.backgroundFill,s.backgroundStroke),s.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),s.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);let g=s.padding;if(g!=wn&&(s.scale[0]<0||s.scale[1]<0)){let _=s.padding[0],p=s.padding[1],D=s.padding[2],v=s.padding[3];s.scale[0]<0&&(p=-p,v=-v),s.scale[1]<0&&(_=-_,D=-D),g=[_,p,D,v]}const m=this.pixelRatio;this.instructions.push([nt.DRAW_IMAGE,a,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,g==wn?wn:g.map(function(_){return _*m}),!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,h]);const d=1/m;this.hitDetectionInstructions.push([nt.DRAW_IMAGE,a,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[d,d],NaN,void 0,this.declutterImageWithText_,g,!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,h]),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,n=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:e.font,textAlign:e.textAlign||Ti,justify:e.justify,textBaseline:e.textBaseline||dr,scale:e.scale});const o=this.fillKey_;n&&(o in this.fillStates||(this.fillStates[o]={fillStyle:n.fillStyle}))}drawChars_(t,e){const n=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,c=pi[r.textBaseline],l=this.textOffsetY_*u,h=this.text_,f=n?n.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([nt.DRAW_CHARS,t,e,c,r.overflow,a,r.maxAngle,u,l,s,f*u,h,o,1]),this.hitDetectionInstructions.push([nt.DRAW_CHARS,t,e,c,r.overflow,a,r.maxAngle,1,l,s,f,h,o,1/u])}setTextStyle(t,e){let n,r,s;if(!t)this.text_="";else{const o=t.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Be(o.getColor()||qe)):(r=null,this.textFillState_=r);const a=t.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const m=a.getLineDash(),d=a.getLineDashOffset(),_=a.getWidth(),p=a.getMiterLimit();s.lineCap=a.getLineCap()||fr,s.lineDash=m?m.slice():xi,s.lineDashOffset=d===void 0?Ai:d,s.lineJoin=a.getLineJoin()||ii,s.lineWidth=_===void 0?Ri:_,s.miterLimit=p===void 0?Fi:p,s.strokeStyle=Be(a.getColor()||Si)}n=this.textState_;const u=t.getFont()||Gu;tf(u);const c=t.getScaleArray();n.overflow=t.getOverflow(),n.font=u,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.repeat=t.getRepeat(),n.justify=t.getJustify(),n.textBaseline=t.getTextBaseline()||dr,n.backgroundFill=t.getBackgroundFill(),n.backgroundStroke=t.getBackgroundStroke(),n.padding=t.getPadding()||wn,n.scale=c===void 0?[1,1]:c;const l=t.getOffsetX(),h=t.getOffsetY(),f=t.getRotateWithView(),g=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=l===void 0?0:l,this.textOffsetY_=h===void 0?0:h,this.textRotateWithView_=f===void 0?!1:f,this.textRotation_=g===void 0?0:g,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:_t(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.repeat||"?")+(n.justify||"?")+(n.textBaseline||"?"),this.fillKey_=r?typeof r.fillStyle=="string"?r.fillStyle:"|"+_t(r.fillStyle):""}this.declutterImageWithText_=e}}const qf={Circle:Da,Default:zi,Image:Wf,LineString:Uf,Polygon:Da,Text:$f};class Hf{constructor(t,e,n,r){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=r,this.resolution_=n,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const n=this.buildersByZIndex_[e];for(const r in n){const s=n[r].finish();t[e][r]=s}}return t}getBuilder(t,e){const n=t!==void 0?t.toString():"0";let r=this.buildersByZIndex_[n];r===void 0&&(r={},this.buildersByZIndex_[n]=r);let s=r[e];if(s===void 0){const o=qf[e];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[e]=s}return s}}const ya=Hf;class jf extends lu{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return gt()}getData(t){return null}prepareFrame(t){return gt()}renderFrame(t,e){return gt()}loadedTileCallback(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n}createLoadedTileFinder(t,e,n){return(r,s)=>{const o=this.loadedTileCallback.bind(this,n,r);return t.forEachLoadedTile(e,r,s,o)}}forEachFeatureAtCoordinate(t,e,n,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){t.target.getState()===Xt.LOADED&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=Xt.LOADED&&e!=Xt.ERROR&&t.addEventListener(at.CHANGE,this.boundHandleImageChange_),e==Xt.IDLE&&(t.load(),e=t.getState()),e==Xt.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}}const Jf=jf;class Qf extends je{constructor(t,e,n,r){super(t),this.inversePixelTransform=e,this.frameState=n,this.context=r}}const ju=Qf,Ea=[];let Wn=null;function td(){Wn=ce(1,1,void 0,{willReadFrequently:!0})}class ed extends Jf{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=ze(),this.pixelTransform=ze(),this.inversePixelTransform=ze(),this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,n){Wn||td(),Wn.clearRect(0,0,1,1);let r;try{Wn.drawImage(t,e,n,1,1,0,0,1,1),r=Wn.getImageData(0,0,1,1).data}catch{return Wn=null,null}return r}getBackground(t){let n=this.getLayer().getBackground();return typeof n=="function"&&(n=n(t.viewState.resolution)),n||void 0}useContainer(t,e,n){const r=this.getLayer().getClassName();let s,o;if(t&&t.className===r&&(!n||t&&t.style.backgroundColor&&mn(cr(t.style.backgroundColor),cr(n)))){const a=t.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&o.canvas.style.transform===e?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){s=document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=ce();const u=o.canvas;s.appendChild(u),a=u.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&n&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=n)}clipUnrotated(t,e,n){const r=Tn(n),s=Lr(n),o=br(n),a=Ir(n);Ht(e.coordinateToPixelTransform,r),Ht(e.coordinateToPixelTransform,s),Ht(e.coordinateToPixelTransform,o),Ht(e.coordinateToPixelTransform,a);const u=this.inversePixelTransform;Ht(u,r),Ht(u,s),Ht(u,o),Ht(u,a),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}dispatchRenderEvent_(t,e,n){const r=this.getLayer();if(r.hasListener(t)){const s=new ju(t,this.inversePixelTransform,n,e);r.dispatchEvent(s)}}preRender(t,e){this.frameState=e,this.dispatchRenderEvent_(cn.PRERENDER,t,e)}postRender(t,e){this.dispatchRenderEvent_(cn.POSTRENDER,t,e)}getRenderTransform(t,e,n,r,s,o,a){const u=s/2,c=o/2,l=r/e,h=-l,f=-t[0]+a,g=-t[1];return dn(this.tempTransform,u,c,l,h,-n,f,g)}disposeInternal(){delete this.frameState,super.disposeInternal()}}const Ju=ed;function nd(i,t,e,n,r,s,o,a,u,c,l,h){let f=i[t],g=i[t+1],m=0,d=0,_=0,p=0;function D(){m=f,d=g,t+=n,f=i[t],g=i[t+1],p+=_,_=Math.sqrt((f-m)*(f-m)+(g-d)*(g-d))}do D();while(t<e-n&&p+_<s);let v=_===0?0:(s-p)/_;const y=ve(m,f,v),E=ve(d,g,v),C=t-n,F=p,w=s+a*u(c,r,l);for(;t<e-n&&p+_<w;)D();v=_===0?0:(w-p)/_;const A=ve(m,f,v),T=ve(d,g,v);let I;if(h){const M=[y,E,A,T];ro(M,0,4,2,h,M,M),I=M[0]>M[2]}else I=y>A;const N=Math.PI,X=[],U=C+n===t;t=C,_=0,p=F,f=i[t],g=i[t+1];let b;if(U){D(),b=Math.atan2(g-d,f-m),I&&(b+=b>0?-N:N);const M=(A+y)/2,L=(T+E)/2;return X[0]=[M,L,(w-s)/2,b,r],X}r=r.replace(/\n/g," ");for(let M=0,L=r.length;M<L;){D();let k=Math.atan2(g-d,f-m);if(I&&(k+=k>0?-N:N),b!==void 0){let J=k-b;if(J+=J>N?-2*N:J<-N?2*N:0,Math.abs(J)>o)return null}b=k;const V=M;let $=0;for(;M<L;++M){const J=I?L-M-1:M,et=a*u(c,r[J],l);if(t+n<e&&p+_<s+$+et/2)break;$+=et}if(M===V)continue;const tt=I?r.substring(L-V,L-M):r.substring(V,M);v=_===0?0:(s+$/2-p)/_;const O=ve(m,f,v),it=ve(d,g,v);X.push([O,it,$/2,k,tt]),s+=$}return X}const On=Re(),tn=[],Ye=[],Ue=[],en=[];function Ca(i){return i[3].declutterBox}const id=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function wa(i,t){return(t==="start"||t==="end")&&!id.test(i)&&(t=t==="start"?"left":"right"),pi[t]}function rd(i,t,e){return e>0&&i.push(`
`,""),i.push(t,""),i}class sd{constructor(t,e,n,r){this.overlaps=n,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=ze(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={}}createLabel(t,e,n,r){const s=t+e+n+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=n?this.fillStates[n]:null,u=this.textStates[e],c=this.pixelRatio,l=[u.scale[0]*c,u.scale[1]*c],h=Array.isArray(t),f=u.justify?pi[u.justify]:wa(Array.isArray(t)?t[0]:t,u.textAlign||Ti),g=r&&o.lineWidth?o.lineWidth:0,m=h?t:t.split(`
`).reduce(rd,[]),{width:d,height:_,widths:p,heights:D,lineWidths:v}=nf(u,m),y=d+g,E=[],C=(y+2)*l[0],F=(_+g)*l[1],w={width:C<0?Math.floor(C):Math.ceil(C),height:F<0?Math.floor(F):Math.ceil(F),contextInstructions:E};(l[0]!=1||l[1]!=1)&&E.push("scale",l),r&&(E.push("strokeStyle",o.strokeStyle),E.push("lineWidth",g),E.push("lineCap",o.lineCap),E.push("lineJoin",o.lineJoin),E.push("miterLimit",o.miterLimit),E.push("setLineDash",[o.lineDash]),E.push("lineDashOffset",o.lineDashOffset)),n&&E.push("fillStyle",a.fillStyle),E.push("textBaseline","middle"),E.push("textAlign","center");const A=.5-f;let T=f*y+A*g;const I=[],N=[];let X=0,U=0,b=0,M=0,L;for(let k=0,V=m.length;k<V;k+=2){const $=m[k];if($===`
`){U+=X,X=0,T=f*y+A*g,++M;continue}const tt=m[k+1]||u.font;tt!==L&&(r&&I.push("font",tt),n&&N.push("font",tt),L=tt),X=Math.max(X,D[b]);const O=[$,T+A*p[b]+f*(p[b]-v[M]),.5*(g+X)+U];T+=p[b],r&&I.push("strokeText",O),n&&N.push("fillText",O),++b}return Array.prototype.push.apply(E,I),Array.prototype.push.apply(E,N),this.labels_[s]=w,w}replayTextBackground_(t,e,n,r,s,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,s),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,n,r,s,o,a,u,c,l,h,f,g,m,d,_){a*=f[0],u*=f[1];let p=n-a,D=r-u;const v=s+c>t?t-c:s,y=o+l>e?e-l:o,E=m[3]+v*f[0]+m[1],C=m[0]+y*f[1]+m[2],F=p-m[3],w=D-m[0];(d||h!==0)&&(tn[0]=F,en[0]=F,tn[1]=w,Ye[1]=w,Ye[0]=F+E,Ue[0]=Ye[0],Ue[1]=w+C,en[1]=Ue[1]);let A;return h!==0?(A=dn(ze(),n,r,1,1,h,-n,-r),Ht(A,tn),Ht(A,Ye),Ht(A,Ue),Ht(A,en),ke(Math.min(tn[0],Ye[0],Ue[0],en[0]),Math.min(tn[1],Ye[1],Ue[1],en[1]),Math.max(tn[0],Ye[0],Ue[0],en[0]),Math.max(tn[1],Ye[1],Ue[1],en[1]),On)):ke(Math.min(F,F+E),Math.min(w,w+C),Math.max(F,F+E),Math.max(w,w+C),On),g&&(p=Math.round(p),D=Math.round(D)),{drawImageX:p,drawImageY:D,drawImageW:v,drawImageH:y,originX:c,originY:l,declutterBox:{minX:On[0],minY:On[1],maxX:On[2],maxY:On[3],value:_},canvasTransform:A,scale:f}}replayImageOrLabel_(t,e,n,r,s,o,a){const u=!!(o||a),c=r.declutterBox,l=t.canvas,h=a?a[2]*r.scale[0]/2:0;return c.minX-h<=l.width/e&&c.maxX+h>=0&&c.minY-h<=l.height/e&&c.maxY+h>=0&&(u&&this.replayTextBackground_(t,tn,Ye,Ue,en,o,a),rf(t,r.canvasTransform,s,n,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(t){if(this.alignFill_){const e=Ht(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;t.save(),t.translate(e[0]%n,e[1]%n),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,n,r){const s=this.textStates[e],o=this.createLabel(t,e,r,n),a=this.strokeStates[n],u=this.pixelRatio,c=wa(Array.isArray(t)?t[0]:t,s.textAlign||Ti),l=pi[s.textBaseline||dr],h=a&&a.lineWidth?a.lineWidth:0,f=o.width/u-2*s.scale[0],g=c*f+2*(.5-c)*h,m=l*o.height/u+2*(.5-l)*h;return{label:o,anchorX:g,anchorY:m}}execute_(t,e,n,r,s,o,a,u){let c;this.pixelCoordinates_&&mn(n,this.renderedTransform_)?c=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),c=Fn(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),Vh(this.renderedTransform_,n));let l=0;const h=r.length;let f=0,g,m,d,_,p,D,v,y,E,C,F,w,A=0,T=0,I=null,N=null;const X=this.coordinateCache_,U=this.viewRotation_,b=Math.round(Math.atan2(-n[1],n[0])*1e12)/1e12,M={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:U},L=this.instructions!=r||this.overlaps?0:200;let k,V,$,tt;for(;l<h;){const O=r[l];switch(O[0]){case nt.BEGIN_GEOMETRY:k=O[1],tt=O[3],k.getGeometry()?a!==void 0&&!oe(a,tt.getExtent())?l=O[2]+1:++l:l=O[2];break;case nt.BEGIN_PATH:A>L&&(this.fill_(t),A=0),T>L&&(t.stroke(),T=0),!A&&!T&&(t.beginPath(),_=NaN,p=NaN),++l;break;case nt.CIRCLE:f=O[1];const J=c[f],et=c[f+1],Dt=c[f+2],ht=c[f+3],ft=Dt-J,ut=ht-et,ct=Math.sqrt(ft*ft+ut*ut);t.moveTo(J+ct,et),t.arc(J,et,ct,0,2*Math.PI,!0),++l;break;case nt.CLOSE_PATH:t.closePath(),++l;break;case nt.CUSTOM:f=O[1],g=O[2];const jt=O[3],At=O[4],dt=O.length==6?O[5]:void 0;M.geometry=jt,M.feature=k,l in X||(X[l]=[]);const Et=X[l];dt?dt(c,f,g,2,Et):(Et[0]=c[f],Et[1]=c[f+1],Et.length=2),At(Et,M),++l;break;case nt.DRAW_IMAGE:f=O[1],g=O[2],y=O[3],m=O[4],d=O[5];let Yt=O[6];const Ut=O[7],fe=O[8],Ee=O[9],Ce=O[10];let Ie=O[11];const ai=O[12];let Jt=O[13];const x=O[14],S=O[15];if(!y&&O.length>=20){E=O[19],C=O[20],F=O[21],w=O[22];const yt=this.drawLabelWithPointPlacement_(E,C,F,w);y=yt.label,O[3]=y;const de=O[23];m=(yt.anchorX-de)*this.pixelRatio,O[4]=m;const Qt=O[24];d=(yt.anchorY-Qt)*this.pixelRatio,O[5]=d,Yt=y.height,O[6]=Yt,Jt=y.width,O[13]=Jt}let R;O.length>25&&(R=O[25]);let P,W,Y;O.length>17?(P=O[16],W=O[17],Y=O[18]):(P=wn,W=!1,Y=!1),Ce&&b?Ie+=U:!Ce&&!b&&(Ie-=U);let Z=0;for(;f<g;f+=2){if(R&&R[Z++]<Jt/this.pixelRatio)continue;const yt=this.calculateImageOrLabelDimensions_(y.width,y.height,c[f],c[f+1],Jt,Yt,m,d,fe,Ee,Ie,ai,s,P,W||Y,k),de=[t,e,y,yt,Ut,W?I:null,Y?N:null];if(u){if(x==="none")continue;if(x==="obstacle"){u.insert(yt.declutterBox);continue}else{let Qt,le;if(S){const he=g-f;if(!S[he]){S[he]=de;continue}if(Qt=S[he],delete S[he],le=Ca(Qt),u.collides(le))continue}if(u.collides(yt.declutterBox))continue;Qt&&(u.insert(le),this.replayImageOrLabel_.apply(this,Qt)),u.insert(yt.declutterBox)}}this.replayImageOrLabel_.apply(this,de)}++l;break;case nt.DRAW_CHARS:const B=O[1],G=O[2],q=O[3],ot=O[4];w=O[5];const K=O[6],Zt=O[7],Pt=O[8];F=O[9];const Bt=O[10];E=O[11],C=O[12];const bt=[O[13],O[13]],Vt=this.textStates[C],Ft=Vt.font,Kt=[Vt.scale[0]*Zt,Vt.scale[1]*Zt];let Ot;Ft in this.widths_?Ot=this.widths_[Ft]:(Ot={},this.widths_[Ft]=Ot);const $t=Nu(c,B,G,2),be=Math.abs(Kt[0])*la(Ft,E,Ot);if(ot||be<=$t){const yt=this.textStates[C].textAlign,de=($t-be)*pi[yt],Qt=nd(c,B,G,2,E,de,K,Math.abs(Kt[0]),la,Ft,Ot,b?0:this.viewRotation_);t:if(Qt){const le=[];let he,Mn,In,ie,ge;if(F)for(he=0,Mn=Qt.length;he<Mn;++he){ge=Qt[he],In=ge[4],ie=this.createLabel(In,C,"",F),m=ge[2]+(Kt[0]<0?-Bt:Bt),d=q*ie.height+(.5-q)*2*Bt*Kt[1]/Kt[0]-Pt;const we=this.calculateImageOrLabelDimensions_(ie.width,ie.height,ge[0],ge[1],ie.width,ie.height,m,d,0,0,ge[3],bt,!1,wn,!1,k);if(u&&u.collides(we.declutterBox))break t;le.push([t,e,ie,we,1,null,null])}if(w)for(he=0,Mn=Qt.length;he<Mn;++he){ge=Qt[he],In=ge[4],ie=this.createLabel(In,C,w,""),m=ge[2],d=q*ie.height-Pt;const we=this.calculateImageOrLabelDimensions_(ie.width,ie.height,ge[0],ge[1],ie.width,ie.height,m,d,0,0,ge[3],bt,!1,wn,!1,k);if(u&&u.collides(we.declutterBox))break t;le.push([t,e,ie,we,1,null,null])}u&&u.load(le.map(Ca));for(let we=0,$r=le.length;we<$r;++we)this.replayImageOrLabel_.apply(this,le[we])}}++l;break;case nt.END_GEOMETRY:if(o!==void 0){k=O[1];const yt=o(k,tt);if(yt)return yt}++l;break;case nt.FILL:L?A++:this.fill_(t),++l;break;case nt.MOVE_TO_LINE_TO:for(f=O[1],g=O[2],V=c[f],$=c[f+1],D=V+.5|0,v=$+.5|0,(D!==_||v!==p)&&(t.moveTo(V,$),_=D,p=v),f+=2;f<g;f+=2)V=c[f],$=c[f+1],D=V+.5|0,v=$+.5|0,(f==g-2||D!==_||v!==p)&&(t.lineTo(V,$),_=D,p=v);++l;break;case nt.SET_FILL_STYLE:I=O,this.alignFill_=O[2],A&&(this.fill_(t),A=0,T&&(t.stroke(),T=0)),t.fillStyle=O[1],++l;break;case nt.SET_STROKE_STYLE:N=O,T&&(t.stroke(),T=0),this.setStrokeStyle_(t,O),++l;break;case nt.STROKE:L?T++:t.stroke(),++l;break;default:++l;break}}A&&this.fill_(t),T&&t.stroke()}execute(t,e,n,r,s,o){this.viewRotation_=r,this.execute_(t,e,n,this.instructions,s,void 0,void 0,o)}executeHitDetection(t,e,n,r,s){return this.viewRotation_=n,this.execute_(t,1,e,this.hitDetectionInstructions,!0,r,s)}}const od=sd,es=["Polygon","Circle","LineString","Image","Text","Default"];class ad{constructor(t,e,n,r,s,o){this.maxExtent_=t,this.overlaps_=r,this.pixelRatio_=n,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=ze(),this.createExecutors_(s)}clip(t,e){const n=this.getClipCoords(e);t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(n[2],n[3]),t.lineTo(n[4],n[5]),t.lineTo(n[6],n[7]),t.clip()}createExecutors_(t){for(const e in t){let n=this.executorsByZIndex_[e];n===void 0&&(n={},this.executorsByZIndex_[e]=n);const r=t[e];for(const s in r){const o=r[s];n[s]=new od(this.resolution_,this.pixelRatio_,this.overlaps_,o)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const n=this.executorsByZIndex_[e];for(let r=0,s=t.length;r<s;++r)if(t[r]in n)return!0}return!1}forEachFeatureAtCoordinate(t,e,n,r,s,o){r=Math.round(r);const a=r*2+1,u=dn(this.hitDetectionTransform_,r+.5,r+.5,1/e,-1/e,-n,-t[0],-t[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=ce(a,a,void 0,{willReadFrequently:!0}));const l=this.hitDetectionContext_;l.canvas.width!==a||l.canvas.height!==a?(l.canvas.width=a,l.canvas.height=a):c||l.clearRect(0,0,a,a);let h;this.renderBuffer_!==void 0&&(h=Re(),mi(h,t),Ks(h,e*(this.renderBuffer_+r),h));const f=ud(r);let g;function m(E,C){const F=l.getImageData(0,0,a,a).data;for(let w=0,A=f.length;w<A;w++)if(F[f[w]]>0){if(!o||g!=="Image"&&g!=="Text"||o.includes(E)){const T=(f[w]-3)/4,I=r-T%a,N=r-(T/a|0),X=s(E,C,I*I+N*N);if(X)return X}l.clearRect(0,0,a,a);break}}const d=Object.keys(this.executorsByZIndex_).map(Number);d.sort(Sn);let _,p,D,v,y;for(_=d.length-1;_>=0;--_){const E=d[_].toString();for(D=this.executorsByZIndex_[E],p=es.length-1;p>=0;--p)if(g=es[p],v=D[g],v!==void 0&&(y=v.executeHitDetection(l,u,n,m,h),y))return y}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const n=e[0],r=e[1],s=e[2],o=e[3],a=[n,r,n,o,s,o,s,r];return Fn(a,0,8,2,t,a),a}isEmpty(){return yi(this.executorsByZIndex_)}execute(t,e,n,r,s,o,a){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(Sn),this.maxExtent_&&(t.save(),this.clip(t,n)),o=o||es;let c,l,h,f,g,m;for(a&&u.reverse(),c=0,l=u.length;c<l;++c){const d=u[c].toString();for(g=this.executorsByZIndex_[d],h=0,f=o.length;h<f;++h){const _=o[h];m=g[_],m!==void 0&&m.execute(t,e,n,r,s,a)}}this.maxExtent_&&t.restore()}}const ns={};function ud(i){if(ns[i]!==void 0)return ns[i];const t=i*2+1,e=i*i,n=new Array(e+1);for(let s=0;s<=i;++s)for(let o=0;o<=i;++o){const a=s*s+o*o;if(a>e)break;let u=n[a];u||(u=[],n[a]=u),u.push(((i+s)*t+(i+o))*4+3),s>0&&u.push(((i-s)*t+(i+o))*4+3),o>0&&(u.push(((i+s)*t+(i-o))*4+3),s>0&&u.push(((i-s)*t+(i-o))*4+3))}const r=[];for(let s=0,o=n.length;s<o;++s)n[s]&&r.push(...n[s]);return ns[i]=r,r}const xa=ad;class ld extends Hu{constructor(t,e,n,r,s,o,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=n,this.transform_=r,this.transformRotation_=r?Js(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=ze()}drawImages_(t,e,n,r){if(!this.image_)return;const s=Fn(t,e,n,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,u=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=u*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let l=0,h=s.length;l<h;l+=2){const f=s[l]-this.imageAnchorX_,g=s[l+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const m=f+this.imageAnchorX_,d=g+this.imageAnchorY_;dn(a,m,d,1,1,c,-m,-d),o.setTransform.apply(o,a),o.translate(m,d),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.setTransform(1,0,0,1,0,0)}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,f,g,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=u)}drawText_(t,e,n,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Fn(t,e,n,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<n;e+=r){const u=s[e]+this.textOffsetX_,c=s[e+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.translate(u-this.textOffsetX_,c-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.setTransform(1,0,0,1,0,0)):(this.textStrokeState_&&o.strokeText(this.text_,u,c),this.textFillState_&&o.fillText(this.text_,u,c))}}moveToLineTo_(t,e,n,r,s){const o=this.context_,a=Fn(t,e,n,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let u=a.length;s&&(u-=2);for(let c=2;c<u;c+=2)o.lineTo(a[c],a[c+1]);return s&&o.closePath(),n}drawRings_(t,e,n,r){for(let s=0,o=n.length;s<o;++s)e=this.moveToLineTo_(t,e,n[s],r,!0);return e}drawCircle(t){if(oe(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=Mc(t,this.transform_,this.pixelCoordinates_),n=e[2]-e[0],r=e[3]-e[1],s=Math.sqrt(n*n+r*r),o=this.context_;o.beginPath(),o.arc(e[0],e[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const n=e.getGeometryFunction()(t);!n||!oe(this.extent_,n.getExtent())||(this.setStyle(e),this.drawGeometry(n))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let n=0,r=e.length;n<r;++n)this.drawGeometry(e[n])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),this.text_!==""&&this.drawText_(e,0,e.length,n)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),this.text_!==""&&this.drawText_(e,0,e.length,n)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!oe(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(oe(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,r=t.getFlatCoordinates();let s=0;const o=t.getEnds(),a=t.getStride();n.beginPath();for(let u=0,c=o.length;u<c;++u)s=this.moveToLineTo_(r,s,o[u],a,!1);n.stroke()}if(this.text_!==""){const n=t.getFlatMidpoints();this.drawText_(n,0,n.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!oe(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!oe(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getOrientedFlatCoordinates();let r=0;const s=t.getEndss(),o=t.getStride();e.beginPath();for(let a=0,u=s.length;a<u;++a){const c=s[a];r=this.drawRings_(n,r,c,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=t.lineCap,e.lineCap=t.lineCap),mn(n.lineDash,t.lineDash)||e.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),n.lineJoin!=t.lineJoin&&(n.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,n=this.contextTextState_,r=t.textAlign?t.textAlign:Ti;n?(n.font!=t.font&&(n.font=t.font,e.font=t.font),n.textAlign!=r&&(n.textAlign=r,e.textAlign=r),n.textBaseline!=t.textBaseline&&(n.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=r,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:r,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const n=t.getColor();this.fillState_={fillStyle:Be(n||qe)}}if(!e)this.strokeState_=null;else{const n=e.getColor(),r=e.getLineCap(),s=e.getLineDash(),o=e.getLineDashOffset(),a=e.getLineJoin(),u=e.getWidth(),c=e.getMiterLimit(),l=s||xi;this.strokeState_={lineCap:r!==void 0?r:fr,lineDash:this.pixelRatio_===1?l:l.map(h=>h*this.pixelRatio_),lineDashOffset:(o||Ai)*this.pixelRatio_,lineJoin:a!==void 0?a:ii,lineWidth:(u!==void 0?u:Ri)*this.pixelRatio_,miterLimit:c!==void 0?c:Fi,strokeStyle:Be(n||Si)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const n=t.getPixelRatio(this.pixelRatio_),r=t.getAnchor(),s=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*n,this.imageAnchorY_=r[1]*n,this.imageHeight_=e[1]*n,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/n,o[1]*this.pixelRatio_/n],this.imageWidth_=e[0]*n}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const g=e.getColor();this.textFillState_={fillStyle:Be(g||qe)}}const n=t.getStroke();if(!n)this.textStrokeState_=null;else{const g=n.getColor(),m=n.getLineCap(),d=n.getLineDash(),_=n.getLineDashOffset(),p=n.getLineJoin(),D=n.getWidth(),v=n.getMiterLimit();this.textStrokeState_={lineCap:m!==void 0?m:fr,lineDash:d||xi,lineDashOffset:_||Ai,lineJoin:p!==void 0?p:ii,lineWidth:D!==void 0?D:Ri,miterLimit:v!==void 0?v:Fi,strokeStyle:Be(g||Si)}}const r=t.getFont(),s=t.getOffsetX(),o=t.getOffsetY(),a=t.getRotateWithView(),u=t.getRotation(),c=t.getScaleArray(),l=t.getText(),h=t.getTextAlign(),f=t.getTextBaseline();this.textState_={font:r!==void 0?r:Gu,textAlign:h!==void 0?h:Ti,textBaseline:f!==void 0?f:dr},this.text_=l!==void 0?Array.isArray(l)?l.reduce((g,m,d)=>g+=d%2?" ":m,""):l:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const hd=ld,Oe=.5;function cd(i,t,e,n,r,s,o){const a=i[0]*Oe,u=i[1]*Oe,c=ce(a,u);c.imageSmoothingEnabled=!1;const l=c.canvas,h=new hd(c,Oe,r,null,o),f=e.length,g=Math.floor((256*256*256-1)/f),m={};for(let _=1;_<=f;++_){const p=e[_-1],D=p.getStyleFunction()||n;if(!n)continue;let v=D(p,s);if(!v)continue;Array.isArray(v)||(v=[v]);const E=(_*g).toString(16).padStart(7,"#00000");for(let C=0,F=v.length;C<F;++C){const w=v[C],A=w.getGeometryFunction()(p);if(!A||!oe(r,A.getExtent()))continue;const T=w.clone(),I=T.getFill();I&&I.setColor(E);const N=T.getStroke();N&&(N.setColor(E),N.setLineDash(null)),T.setText(void 0);const X=w.getImage();if(X&&X.getOpacity()!==0){const L=X.getImageSize();if(!L)continue;const k=ce(L[0],L[1],void 0,{alpha:!1}),V=k.canvas;k.fillStyle=E,k.fillRect(0,0,V.width,V.height),T.setImage(new qu({img:V,imgSize:L,anchor:X.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:X.getOrigin(),opacity:1,size:X.getSize(),scale:X.getScale(),rotation:X.getRotation(),rotateWithView:X.getRotateWithView()}))}const U=T.getZIndex()||0;let b=m[U];b||(b={},m[U]=b,b.Polygon=[],b.Circle=[],b.LineString=[],b.Point=[]);const M=A.getType();if(M==="GeometryCollection"){const L=A.getGeometriesArrayRecursive();for(let k=0,V=L.length;k<V;++k){const $=L[k];b[$.getType().replace("Multi","")].push($,T)}}else b[M.replace("Multi","")].push(A,T)}}const d=Object.keys(m).map(Number).sort(Sn);for(let _=0,p=d.length;_<p;++_){const D=m[d[_]];for(const v in D){const y=D[v];for(let E=0,C=y.length;E<C;E+=2){h.setStyle(y[E+1]);for(let F=0,w=t.length;F<w;++F)h.setTransform(t[F]),h.drawGeometry(y[E])}}}return c.getImageData(0,0,l.width,l.height)}function fd(i,t,e){const n=[];if(e){const r=Math.floor(Math.round(i[0])*Oe),s=Math.floor(Math.round(i[1])*Oe),o=(kt(r,0,e.width-1)+kt(s,0,e.height-1)*e.width)*4,a=e.data[o],u=e.data[o+1],l=e.data[o+2]+256*(u+256*a),h=Math.floor((256*256*256-1)/t.length);l&&l%h===0&&n.push(t[l/h-1])}return n}const dd=.5,Qu={Point:Cd,LineString:Dd,Polygon:xd,MultiPoint:wd,MultiLineString:yd,MultiPolygon:Ed,GeometryCollection:vd,Circle:_d};function gd(i,t){return parseInt(_t(i),10)-parseInt(_t(t),10)}function md(i,t){const e=Fs(i,t);return e*e}function Fs(i,t){return dd*i/t}function _d(i,t,e,n,r){const s=e.getFill(),o=e.getStroke();if(s||o){const u=i.getBuilder(e.getZIndex(),"Circle");u.setFillStrokeStyle(s,o),u.drawCircle(t,n)}const a=e.getText();if(a&&a.getText()){const u=(r||i).getBuilder(e.getZIndex(),"Text");u.setTextStyle(a),u.drawText(t,n)}}function Aa(i,t,e,n,r,s,o){let a=!1;const u=e.getImage();if(u){const c=u.getImageState();c==Xt.LOADED||c==Xt.ERROR?u.unlistenImageChange(r):(c==Xt.IDLE&&u.load(),u.listenImageChange(r),a=!0)}return pd(i,t,e,n,s,o),a}function pd(i,t,e,n,r,s){const o=e.getGeometryFunction()(t);if(!o)return;const a=o.simplifyTransformed(n,r);if(e.getRenderer())tl(i,a,e,t);else{const c=Qu[a.getType()];c(i,a,e,t,s)}}function tl(i,t,e,n){if(t.getType()=="GeometryCollection"){const s=t.getGeometries();for(let o=0,a=s.length;o<a;++o)tl(i,s[o],e,n);return}i.getBuilder(e.getZIndex(),"Default").drawCustom(t,n,e.getRenderer(),e.getHitDetectionRenderer())}function vd(i,t,e,n,r){const s=t.getGeometriesArray();let o,a;for(o=0,a=s.length;o<a;++o){const u=Qu[s[o].getType()];u(i,s[o],e,n,r)}}function Dd(i,t,e,n,r){const s=e.getStroke();if(s){const a=i.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(t,n)}const o=e.getText();if(o&&o.getText()){const a=(r||i).getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,n)}}function yd(i,t,e,n,r){const s=e.getStroke();if(s){const a=i.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(t,n)}const o=e.getText();if(o&&o.getText()){const a=(r||i).getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,n)}}function Ed(i,t,e,n,r){const s=e.getFill(),o=e.getStroke();if(o||s){const u=i.getBuilder(e.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawMultiPolygon(t,n)}const a=e.getText();if(a&&a.getText()){const u=(r||i).getBuilder(e.getZIndex(),"Text");u.setTextStyle(a),u.drawText(t,n)}}function Cd(i,t,e,n,r){const s=e.getImage(),o=e.getText();let a;if(s){if(s.getImageState()!=Xt.LOADED)return;let u=i;if(r){const l=s.getDeclutterMode();if(l!=="none")if(u=r,l==="obstacle"){const h=i.getBuilder(e.getZIndex(),"Image");h.setImageStyle(s,a),h.drawPoint(t,n)}else o&&o.getText()&&(a={})}const c=u.getBuilder(e.getZIndex(),"Image");c.setImageStyle(s,a),c.drawPoint(t,n)}if(o&&o.getText()){let u=i;r&&(u=r);const c=u.getBuilder(e.getZIndex(),"Text");c.setTextStyle(o,a),c.drawText(t,n)}}function wd(i,t,e,n,r){const s=e.getImage(),o=e.getText();let a;if(s){if(s.getImageState()!=Xt.LOADED)return;let u=i;if(r){const l=s.getDeclutterMode();if(l!=="none")if(u=r,l==="obstacle"){const h=i.getBuilder(e.getZIndex(),"Image");h.setImageStyle(s,a),h.drawMultiPoint(t,n)}else o&&o.getText()&&(a={})}const c=u.getBuilder(e.getZIndex(),"Image");c.setImageStyle(s,a),c.drawMultiPoint(t,n)}if(o&&o.getText()){let u=i;r&&(u=r);const c=u.getBuilder(e.getZIndex(),"Text");c.setTextStyle(o,a),c.drawText(t,n)}}function xd(i,t,e,n,r){const s=e.getFill(),o=e.getStroke();if(s||o){const u=i.getBuilder(e.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawPolygon(t,n)}const a=e.getText();if(a&&a.getText()){const u=(r||i).getBuilder(e.getZIndex(),"Text");u.setTextStyle(a),u.drawText(t,n)}}class Ad extends Ju{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Re(),this.wrappedRenderedExtent_=Re(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.declutterExecutorGroup=null,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(t,e,n){const r=e.extent,s=e.viewState,o=s.center,a=s.resolution,u=s.projection,c=s.rotation,l=u.getExtent(),h=this.getLayer().getSource(),f=e.pixelRatio,g=e.viewHints,m=!(g[se.ANIMATING]||g[se.INTERACTING]),d=this.compositionContext_,_=Math.round(e.size[0]*f),p=Math.round(e.size[1]*f),D=h.getWrapX()&&u.canWrapX(),v=D?xt(l):null,y=D?Math.ceil((r[2]-l[2])/v)+1:1;let E=D?Math.floor((r[0]-l[0])/v):0;do{const C=this.getRenderTransform(o,a,c,f,_,p,E*v);t.execute(d,1,C,c,m,void 0,n)}while(++E<y)}setupCompositionContext_(){if(this.opacity_!==1){const t=ce(this.context.canvas.width,this.context.canvas.height,Ea);this.compositionContext_=t}else this.compositionContext_=this.context}releaseCompositionContext_(){if(this.opacity_!==1){const t=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=t,Nr(this.compositionContext_),Ea.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(t){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree),this.releaseCompositionContext_())}renderFrame(t,e){const n=t.pixelRatio,r=t.layerStatesArray[t.layerIndex];Kh(this.pixelTransform,1/n,1/n),Vs(this.inversePixelTransform,this.pixelTransform);const s=fu(this.pixelTransform);this.useContainer(e,s,this.getBackground(t));const o=this.context,a=o.canvas,u=this.replayGroup_,c=this.declutterExecutorGroup;if((!u||u.isEmpty())&&(!c||c.isEmpty()))return null;const l=Math.round(t.size[0]*n),h=Math.round(t.size[1]*n);a.width!=l||a.height!=h?(a.width=l,a.height=h,a.style.transform!==s&&(a.style.transform=s)):this.containerReused||o.clearRect(0,0,l,h),this.preRender(o,t);const f=t.viewState;f.projection,this.opacity_=r.opacity,this.setupCompositionContext_();let g=!1,m=!0;if(r.extent&&this.clipping){const d=yn(r.extent);m=oe(d,t.extent),g=m&&!Zn(d,t.extent),g&&this.clipUnrotated(this.compositionContext_,t,d)}return m&&this.renderWorlds(u,t),g&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(o,t),this.renderedRotation_!==f.rotation&&(this.renderedRotation_=f.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(t){return new Promise(e=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const n=[this.context.canvas.width,this.context.canvas.height];Ht(this.pixelTransform,n);const r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,u=this.wrappedRenderedExtent_,c=this.getLayer(),l=[],h=n[0]*Oe,f=n[1]*Oe;l.push(this.getRenderTransform(r,s,o,Oe,h,f,0).slice());const g=c.getSource(),m=a.getExtent();if(g.getWrapX()&&a.canWrapX()&&!Zn(m,u)){let d=u[0];const _=xt(m);let p=0,D;for(;d<m[0];)--p,D=_*p,l.push(this.getRenderTransform(r,s,o,Oe,h,f,D).slice()),d+=_;for(p=0,d=u[2];d>m[2];)++p,D=_*p,l.push(this.getRenderTransform(r,s,o,Oe,h,f,D).slice()),d-=_}this.hitDetectionImageData_=cd(n,l,this.renderedFeatures_,c.getStyleFunction(),u,s,o)}e(fd(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,n,r,s){if(!this.replayGroup_)return;const o=e.viewState.resolution,a=e.viewState.rotation,u=this.getLayer(),c={},l=function(g,m,d){const _=_t(g),p=c[_];if(p){if(p!==!0&&d<p.distanceSq){if(d===0)return c[_]=!0,s.splice(s.lastIndexOf(p),1),r(g,u,m);p.geometry=m,p.distanceSq=d}}else{if(d===0)return c[_]=!0,r(g,u,m);s.push(c[_]={feature:g,layer:u,geometry:m,distanceSq:d,callback:r})}};let h;const f=[this.replayGroup_];return this.declutterExecutorGroup&&f.push(this.declutterExecutorGroup),f.some(g=>h=g.forEachFeatureAtCoordinate(t,o,a,n,l,g===this.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map(m=>m.value):null)),h}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),n=e.getSource();if(!n)return!1;const r=t.viewHints[se.ANIMATING],s=t.viewHints[se.INTERACTING],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=t.extent,c=t.viewState,l=c.projection,h=c.resolution,f=t.pixelRatio,g=e.getRevision(),m=e.getRenderBuffer();let d=e.getRenderOrder();d===void 0&&(d=gd);const _=c.center.slice(),p=Ks(u,m*h),D=p.slice(),v=[p.slice()],y=l.getExtent();if(n.getWrapX()&&l.canWrapX()&&!Zn(y,t.extent)){const b=xt(y),M=Math.max(xt(p)/2,b);p[0]=y[0]-M,p[2]=y[2]+M,pu(_,l);const L=_u(v[0],l);L[0]<y[0]&&L[2]<y[2]?v.push([L[0]+b,L[1],L[2]+b,L[3]]):L[0]>y[0]&&L[2]>y[2]&&v.push([L[0]-b,L[1],L[2]-b,L[3]])}if(this.ready&&this.renderedResolution_==h&&this.renderedRevision_==g&&this.renderedRenderOrder_==d&&Zn(this.wrappedRenderedExtent_,p))return mn(this.renderedExtent_,D)||(this.hitDetectionImageData_=null,this.renderedExtent_=D),this.renderedCenter_=_,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const E=new ya(Fs(h,f),p,h,f);let C;this.getLayer().getDeclutter()&&(C=new ya(Fs(h,f),p,h,f));let F;for(let b=0,M=v.length;b<M;++b)n.loadFeatures(v[b],h,l);const w=md(h,f);let A=!0;const T=b=>{let M;const L=b.getStyleFunction()||e.getStyleFunction();if(L&&(M=L(b,h)),M){const k=this.renderFeature(b,w,M,E,F,C);A=A&&!k}},I=xu(p),N=n.getFeaturesInExtent(I);d&&N.sort(d);for(let b=0,M=N.length;b<M;++b)T(N[b]);this.renderedFeatures_=N,this.ready=A;const X=E.finish(),U=new xa(p,h,f,n.getOverlaps(),X,e.getRenderBuffer());return C&&(this.declutterExecutorGroup=new xa(p,h,f,n.getOverlaps(),C.finish(),e.getRenderBuffer())),this.renderedResolution_=h,this.renderedRevision_=g,this.renderedRenderOrder_=d,this.renderedExtent_=D,this.wrappedRenderedExtent_=p,this.renderedCenter_=_,this.renderedProjection_=l,this.replayGroup_=U,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,n,r,s,o){if(!n)return!1;let a=!1;if(Array.isArray(n))for(let u=0,c=n.length;u<c;++u)a=Aa(r,t,n[u],e,this.boundHandleStyleImageChange_,s,o)||a;else a=Aa(r,t,n,e,this.boundHandleStyleImageChange_,s,o);return a}}const Fd=Ad;class Sd extends zf{constructor(t){super(t)}createRenderer(){return new Fd(this)}}const Td=Sd;class Rd{constructor(t){this.rbush_=new Ku(t),this.items_={}}insert(t,e){const n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[_t(e)]=n}load(t,e){const n=new Array(e.length);for(let r=0,s=e.length;r<s;r++){const o=t[r],a=e[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};n[r]=u,this.items_[_t(a)]=u}this.rbush_.load(n)}remove(t){const e=_t(t),n=this.items_[e];return delete this.items_[e],this.rbush_.remove(n)!==null}update(t,e){const n=this.items_[_t(e)],r=[n.minX,n.minY,n.maxX,n.maxY];Ei(r,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(e){return e.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(r){return r.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let n;for(let r=0,s=t.length;r<s;r++)if(n=e(t[r]),n)return n;return n}isEmpty(){return yi(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return ke(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}const Fa=Rd;class Md extends We{constructor(t){super(),this.projection=Me(t.projection),this.attributions_=Sa(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible!==void 0?t.attributionsCollapsible:!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(n,r){e.viewResolver=n,e.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=Sa(t),this.changed()}setState(t){this.state_=t,this.changed()}}function Sa(i){return i?Array.isArray(i)?function(t){return i}:typeof i=="function"?i:function(t){return[i]}:null}const el=Md,Ae={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function Id(i,t){return[[-1/0,-1/0,1/0,1/0]]}let bd=!1;function Ld(i,t,e,n,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof i=="function"?i(e,n,r):i,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=bd,a.onload=function(u){if(!a.status||a.status>=200&&a.status<300){const c=t.getType();let l;c=="json"||c=="text"?l=a.responseText:c=="xml"?(l=a.responseXML,l||(l=new DOMParser().parseFromString(a.responseText,"application/xml"))):c=="arraybuffer"&&(l=a.response),l?s(t.readFeatures(l,{extent:e,featureProjection:r}),t.readProjection(l)):o()}else o()},a.onerror=o,a.send()}function Ta(i,t){return function(e,n,r,s,o){const a=this;Ld(i,t,e,n,r,function(u,c){a.addFeatures(u),s!==void 0&&s(u)},o||ei)}}class nn extends je{constructor(t,e,n){super(t),this.feature=e,this.features=n}}class Nd extends el{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=ei,this.format_=t.format,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(lt(this.format_,7),this.loader_=Ta(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:Id;const e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new Fa:null,this.loadedExtentsRtree_=new Fa,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let n,r;Array.isArray(t.features)?r=t.features:t.features&&(n=t.features,r=n.getArray()),!e&&n===void 0&&(n=new Pe(r)),r!==void 0&&this.addFeaturesInternal(r),n!==void 0&&this.bindFeaturesCollection_(n)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=_t(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);const n=t.getGeometry();if(n){const r=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new nn(Ae.ADDFEATURE,t))}setupChangeEvents_(t,e){this.featureChangeKeys_[t]=[mt(e,at.CHANGE,this.handleFeatureChange_,this),mt(e,ti.PROPERTYCHANGE,this.handleFeatureChange_,this)]}addToIndex_(t,e){let n=!0;const r=e.getId();return r!==void 0&&(r.toString()in this.idIndex_?n=!1:this.idIndex_[r.toString()]=e),n&&(lt(!(t in this.uidIndex_),30),this.uidIndex_[t]=e),n}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],n=[],r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],u=_t(a);this.addToIndex_(u,a)&&n.push(a)}for(let s=0,o=n.length;s<o;s++){const a=n[s],u=_t(a);this.setupChangeEvents_(u,a);const c=a.getGeometry();if(c){const l=c.getExtent();e.push(l),r.push(a)}else this.nullGeometryFeatures_[u]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,r),this.hasListener(Ae.ADDFEATURE))for(let s=0,o=n.length;s<o;s++)this.dispatchEvent(new nn(Ae.ADDFEATURE,n[s]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(Ae.ADDFEATURE,function(n){e||(e=!0,t.push(n.feature),e=!1)}),this.addEventListener(Ae.REMOVEFEATURE,function(n){e||(e=!0,t.remove(n.feature),e=!1)}),t.addEventListener(me.ADD,n=>{e||(e=!0,this.addFeature(n.element),e=!1)}),t.addEventListener(me.REMOVE,n=>{e||(e=!0,this.removeFeature(n.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const n in this.featureChangeKeys_)this.featureChangeKeys_[n].forEach(St);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const n=r=>{this.removeFeatureInternal(r)};this.featuresRtree_.forEach(n);for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new nn(Ae.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,function(r){if(r.getGeometry().intersectsCoordinate(t))return e(r)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(n){if(n.getGeometry().intersectsExtent(t)){const s=e(n);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),yi(this.nullGeometryFeatures_)||Ys(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(n){e.push(n)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const r=nc(t,e);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}else if(this.featuresCollection_)return this.featuresCollection_.getArray().slice(0);return[]}getClosestFeatureToCoordinate(t,e){const n=t[0],r=t[1];let s=null;const o=[NaN,NaN];let a=1/0;const u=[-1/0,-1/0,1/0,1/0];return e=e||Di,this.featuresRtree_.forEachInExtent(u,function(c){if(e(c)){const l=c.getGeometry(),h=a;if(a=l.closestPointXY(n,r,o,a),a<h){s=c;const f=Math.sqrt(a);u[0]=n-f,u[1]=r-f,u[2]=n+f,u[3]=r+f}}}),s}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,n=_t(e),r=e.getGeometry();if(!r)n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);else{const o=r.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}const s=e.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[o]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[n]=e;this.changed(),this.dispatchEvent(new nn(Ae.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:_t(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&yi(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,n){const r=this.loadedExtentsRtree_,s=this.strategy_(t,e,n);for(let o=0,a=s.length;o<a;++o){const u=s[o];r.forEachInExtent(u,function(l){return Zn(l.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new nn(Ae.FEATURESLOADSTART)),this.loader_.call(this,u,e,n,l=>{--this.loadingExtentsCount_,this.dispatchEvent(new nn(Ae.FEATURESLOADEND,void 0,l))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new nn(Ae.FEATURESLOADERROR))}),r.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let n;e.forEachInExtent(t,function(r){if(Ei(r.extent,t))return n=r,!0}),n&&e.remove(n)}removeFeature(t){if(!t)return;const e=_t(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=_t(t),n=this.featureChangeKeys_[e];if(!n)return;n.forEach(St),delete this.featureChangeKeys_[e];const r=t.getId();return r!==void 0&&delete this.idIndex_[r.toString()],delete this.uidIndex_[e],this.dispatchEvent(new nn(Ae.REMOVEFEATURE,t)),t}removeFromIdIndex_(t){let e=!1;for(const n in this.idIndex_)if(this.idIndex_[n]===t){delete this.idIndex_[n],e=!0;break}return e}setLoader(t){this.loader_=t}setUrl(t){lt(this.format_,7),this.url_=t,this.setLoader(Ta(t,this.format_))}}const Od=Nd,j={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class Pd extends Sr{constructor(t,e,n){super(),n=n||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=n.transition===void 0?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent(at.CHANGE)}release(){this.state===j.ERROR&&this.setState(j.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){if(!this.interimTile)return this;let t=this.interimTile;do{if(t.getState()==j.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){if(!this.interimTile)return;let t=this.interimTile,e=this;do{if(t.getState()==j.LOADED){t.interimTile=null;break}else t.getState()==j.LOADING?e=t:t.getState()==j.IDLE?e.interimTile=t.interimTile:e=t;t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==j.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){gt()}getAlpha(t,e){if(!this.transition_)return 1;let n=this.transitionStarts_[t];if(!n)n=e,this.transitionStarts_[t]=n;else if(n===-1)return 1;const r=e-n+1e3/60;return r>=this.transition_?1:Zu(r/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}}const nl=Pd;class Bd extends nl{constructor(t,e,n,r,s,o){super(t,e,o),this.crossOrigin_=r,this.src_=n,this.key=n,this.image_=new Image,r!==null&&(this.image_.crossOrigin=r),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(t){this.image_=t,this.state=j.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=j.ERROR,this.unlistenImage_(),this.image_=zd(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=j.LOADED:this.state=j.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==j.ERROR&&(this.state=j.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==j.IDLE&&(this.state=j.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=$u(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function zd(){const i=ce(1,1);return i.fillStyle="rgba(0,0,0,0)",i.fillRect(0,0,1,1),i.canvas}const il=Bd;class kd{constructor(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let n=e-3;for(;n>0&&this.points_[n+2]>t;)n-=3;const r=this.points_[e+2]-this.points_[n+2];if(r<1e3/60)return!1;const s=this.points_[e]-this.points_[n],o=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const Gd=kd;class Xd extends Xs{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){gt()}calculateMatrices2D(t){const e=t.viewState,n=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;dn(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Vs(r,n)}forEachFeatureAtCoordinate(t,e,n,r,s,o,a,u){let c;const l=e.viewState;function h(y,E,C,F){return s.call(o,E,y?C:null,F)}const f=l.projection,g=pu(t.slice(),f),m=[[0,0]];if(f.canWrapX()&&r){const y=f.getExtent(),E=xt(y);m.push([-E,0],[E,0])}const d=e.layerStatesArray,_=d.length,p=[],D=[];for(let y=0;y<m.length;y++)for(let E=_-1;E>=0;--E){const C=d[E],F=C.layer;if(F.hasRenderer()&&wo(C,l)&&a.call(u,F)){const w=F.getRenderer(),A=F.getSource();if(w&&A){const T=A.getWrapX()?g:t,I=h.bind(null,C.managed);D[0]=T[0]+m[y][0],D[1]=T[1]+m[y][1],c=w.forEachFeatureAtCoordinate(D,e,n,I,p)}if(c)return c}}if(p.length===0)return;const v=1/p.length;return p.forEach((y,E)=>y.distanceSq+=E*v),p.sort((y,E)=>y.distanceSq-E.distanceSq),p.some(y=>c=y.callback(y.feature,y.layer,y.geometry)),c}hasFeatureAtCoordinate(t,e,n,r,s,o){return this.forEachFeatureAtCoordinate(t,e,n,r,Di,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(t){gt()}scheduleExpireIconCache(t){mr.canExpireCache()&&t.postRenderFunctions.push(Wd)}}function Wd(i,t){mr.expire()}const Yd=Xd;class Ud extends Yd{constructor(t){super(t),this.fontChangeListenerKey_=mt(Ke,ti.PROPERTYCHANGE,t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=Or+" ol-layers";const n=t.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const n=this.getMap();if(n.hasListener(t)){const r=new ju(t,void 0,e);n.dispatchEvent(r)}}disposeInternal(){St(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(cn.PRECOMPOSE,t);const e=t.layerStatesArray.sort(function(o,a){return o.zIndex-a.zIndex}),n=t.viewState;this.children_.length=0;const r=[];let s=null;for(let o=0,a=e.length;o<a;++o){const u=e[o];t.layerIndex=o;const c=u.layer,l=c.getSourceState();if(!wo(u,n)||l!="ready"&&l!="undefined"){c.unrender();continue}const h=c.render(t,s);h&&(h!==s&&(this.children_.push(h),s=h),"getDeclutter"in c&&r.push(c))}for(let o=r.length-1;o>=0;--o)r[o].renderDeclutter(t);Jc(this.element_,this.children_),this.dispatchRenderEvent(cn.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}}const Zd=Ud;class an extends je{constructor(t,e){super(t),this.layer=e}}const is={LAYERS:"layers"};class Ao extends Uu{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let n=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(is.LAYERS,this.handleLayersChanged_),n?Array.isArray(n)?n=new Pe(n.slice(),{unique:!0}):lt(typeof n.getArray=="function",43):n=new Pe(void 0,{unique:!0}),this.setLayers(n)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(St),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(mt(t,me.ADD,this.handleLayersAdd_,this),mt(t,me.REMOVE,this.handleLayersRemove_,this));for(const n in this.listenerKeys_)this.listenerKeys_[n].forEach(St);Ni(this.listenerKeys_);const e=t.getArray();for(let n=0,r=e.length;n<r;n++){const s=e[n];this.registerLayerListeners_(s),this.dispatchEvent(new an("addlayer",s))}this.changed()}registerLayerListeners_(t){const e=[mt(t,ti.PROPERTYCHANGE,this.handleLayerChange_,this),mt(t,at.CHANGE,this.handleLayerChange_,this)];t instanceof Ao&&e.push(mt(t,"addlayer",this.handleLayerGroupAdd_,this),mt(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[_t(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new an("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new an("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new an("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,n=_t(e);this.listenerKeys_[n].forEach(St),delete this.listenerKeys_[n],this.dispatchEvent(new an("removelayer",e)),this.changed()}getLayers(){return this.get(is.LAYERS)}setLayers(t){const e=this.getLayers();if(e){const n=e.getArray();for(let r=0,s=n.length;r<s;++r)this.dispatchEvent(new an("removelayer",n[r]))}this.set(is.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=t!==void 0?t:[],n=e.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(e)});const r=this.getLayerState();let s=r.zIndex;!t&&r.zIndex===void 0&&(s=0);for(let o=n,a=e.length;o<a;o++){const u=e[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),r.extent!==void 0&&(u.extent!==void 0?u.extent=_i(u.extent,r.extent):u.extent=r.extent),u.zIndex===void 0&&(u.zIndex=s)}return e}getSourceState(){return"ready"}}const zr=Ao;class Vd extends je{constructor(t,e,n){super(t),this.map=e,this.frameState=n!==void 0?n:null}}const Yn=Vd;class Kd extends Yn{constructor(t,e,n,r,s,o){super(t,e,s),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const sn=Kd,Lt={SINGLECLICK:"singleclick",CLICK:at.CLICK,DBLCLICK:at.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Ss={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};class $d extends Sr{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;const n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=mt(n,Ss.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=mt(n,Ss.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(at.TOUCHMOVE,this.boundHandleTouchMove_,cu?{passive:!1}:!1)}emulateClick_(t){let e=new sn(Lt.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new sn(Lt.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const n=new sn(Lt.SINGLECLICK,this.map_,t);this.dispatchEvent(n)},250)}updateActivePointers_(t){const e=t,n=e.pointerId;if(e.type==Lt.POINTERUP||e.type==Lt.POINTERCANCEL){delete this.trackedTouches_[n];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==e.target){delete this.trackedTouches_[r];break}}else(e.type==Lt.POINTERDOWN||e.type==Lt.POINTERMOVE)&&(this.trackedTouches_[n]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new sn(Lt.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(St),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);const e=new sn(Lt.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){const n=this.map_.getOwnerDocument();this.dragListenerKeys_.push(mt(n,Lt.POINTERMOVE,this.handlePointerMove_,this),mt(n,Lt.POINTERUP,this.handlePointerUp_,this),mt(this.element_,Lt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==n&&this.dragListenerKeys_.push(mt(this.element_.getRootNode(),Lt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new sn(Lt.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new sn(Lt.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(St(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(at.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(St(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(St),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const qd=$d,on={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},re={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},_r=1/0;class Hd{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Ni(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,n=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const r=this.keyFunction_(n);return delete this.queuedElements_[r],n}enqueue(t){lt(!(this.keyFunction_(t)in this.queuedElements_),31);const e=this.priorityFunction_(t);return e!=_r?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,n=this.priorities_,r=e.length,s=e[t],o=n[t],a=t;for(;t<r>>1;){const u=this.getLeftChildIndex_(t),c=this.getRightChildIndex_(t),l=c<r&&n[c]<n[u]?c:u;e[t]=e[l],n[t]=n[l],t=l}e[t]=s,n[t]=o,this.siftDown_(a,t)}siftDown_(t,e){const n=this.elements_,r=this.priorities_,s=n[e],o=r[e];for(;e>t;){const a=this.getParentIndex_(e);if(r[a]>o)n[e]=n[a],r[e]=r[a],e=a;else break}n[e]=s,r[e]=o}reprioritize(){const t=this.priorityFunction_,e=this.elements_,n=this.priorities_;let r=0;const s=e.length;let o,a,u;for(a=0;a<s;++a)o=e[a],u=t(o),u==_r?delete this.queuedElements_[this.keyFunction_(o)]:(n[r]=u,e[r++]=o);e.length=r,n.length=r,this.heapify_()}}const jd=Hd;class Jd extends jd{constructor(t,e){super(function(n){return t.apply(null,n)},function(n){return n[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(at.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,n=e.getState();if(n===j.LOADED||n===j.ERROR||n===j.EMPTY){n!==j.ERROR&&e.removeEventListener(at.CHANGE,this.boundHandleTileChange_);const r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let n=0,r,s,o;for(;this.tilesLoading_<t&&n<e&&this.getCount()>0;)s=this.dequeue()[0],o=s.getKey(),r=s.getState(),r===j.IDLE&&!(o in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[o]=!0,++this.tilesLoading_,++n,s.load())}}const Qd=Jd;function tg(i,t,e,n,r){if(!i||!(e in i.wantedTiles)||!i.wantedTiles[e][t.getKey()])return _r;const s=i.viewState.center,o=n[0]-s[0],a=n[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}class eg extends We{constructor(t){super();const e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){Cs(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&Cs(this.element);for(let e=0,n=this.listenerKeys.length;e<n;++e)St(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==ei&&this.listenerKeys.push(mt(t,on.POSTRENDER,this.render,this)),t.render())}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}}const Fo=eg;class ng extends Fo{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1);const e=t.className!==void 0?t.className:"ol-attribution",n=t.tipLabel!==void 0?t.tipLabel:"Attributions",r=t.expandClassName!==void 0?t.expandClassName:e+"-expand",s=t.collapseLabel!==void 0?t.collapseLabel:"›",o=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=t.label!==void 0?t.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=n,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(at.CLICK,this.handleClick_.bind(this),!1);const c=e+" "+Or+" "+mo+(this.collapsed_&&this.collapsible_?" "+aa:"")+(this.collapsible_?"":" ol-uncollapsible"),l=this.element;l.className=c,l.appendChild(this.toggleButton_),l.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=Array.from(new Set(this.getMap().getAllLayers().flatMap(r=>r.getAttributions(t)))),n=!this.getMap().getAllLayers().some(r=>r.getSource()&&r.getSource().getAttributionsCollapsible()===!1);return this.overrideCollapsible_||this.setCollapsible(n),e}updateElement_(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=this.collectSourceAttributions_(t),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!mn(e,this.renderedAttributions_)){jc(this.ulElement_);for(let r=0,s=e.length;r<s;++r){const o=document.createElement("li");o.innerHTML=e[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(aa),this.collapsed_?oa(this.collapseLabel_,this.label_):oa(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}}const ig=ng;class rg extends Fo{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=t.className!==void 0?t.className:"ol-rotate",n=t.label!==void 0?t.label:"⇧",r=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof n=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(r));const s=t.tipLabel?t.tipLabel:"Reset rotation",o=document.createElement("button");o.className=e+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(at.CLICK,this.handleClick_.bind(this),!1);const a=e+" "+Or+" "+mo,u=this.element;u.className=a,u.appendChild(o),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add($i)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const e=this.getMap().getView();if(!e)return;const n=e.getRotation();n!==void 0&&(this.duration_>0&&n%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:oi}):e.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const n=e.viewState.rotation;if(n!=this.rotation_){const r="rotate("+n+"rad)";if(this.autoHide_){const s=this.element.classList.contains($i);!s&&n===0?this.element.classList.add($i):s&&n!==0&&this.element.classList.remove($i)}this.label_.style.transform=r}this.rotation_=n}}const sg=rg;class og extends Fo{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=t.className!==void 0?t.className:"ol-zoom",n=t.delta!==void 0?t.delta:1,r=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",s=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",o=t.zoomInLabel!==void 0?t.zoomInLabel:"+",a=t.zoomOutLabel!==void 0?t.zoomOutLabel:"–",u=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",c=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",l=document.createElement("button");l.className=r,l.setAttribute("type","button"),l.title=u,l.appendChild(typeof o=="string"?document.createTextNode(o):o),l.addEventListener(at.CLICK,this.handleClick_.bind(this,n),!1);const h=document.createElement("button");h.className=s,h.setAttribute("type","button"),h.title=c,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(at.CLICK,this.handleClick_.bind(this,-n),!1);const f=e+" "+Or+" "+mo,g=this.element;g.className=f,g.appendChild(l),g.appendChild(h),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const n=this.getMap().getView();if(!n)return;const r=n.getZoom();if(r!==void 0){const s=n.getConstrainedZoom(r+t);this.duration_>0?(n.getAnimating()&&n.cancelAnimations(),n.animate({zoom:s,duration:this.duration_,easing:oi})):n.setZoom(s)}}}const ag=og;function ug(i){i=i||{};const t=new Pe;return(i.zoom!==void 0?i.zoom:!0)&&t.push(new ag(i.zoomOptions)),(i.rotate!==void 0?i.rotate:!0)&&t.push(new sg(i.rotateOptions)),(i.attribution!==void 0?i.attribution:!0)&&t.push(new ig(i.attributionOptions)),t}const Ra={ACTIVE:"active"};class lg extends We{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Ra.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(Ra.ACTIVE,t)}setMap(t){this.map_=t}}function hg(i,t,e){const n=i.getCenterInternal();if(n){const r=[n[0]+t[0],n[1]+t[1]];i.animateInternal({duration:e!==void 0?e:250,easing:vf,center:i.getConstrainedCenter(r)})}}function So(i,t,e,n){const r=i.getZoom();if(r===void 0)return;const s=i.getConstrainedZoom(r+t),o=i.getResolutionForZoom(s);i.getAnimating()&&i.cancelAnimations(),i.animate({resolution:o,anchor:e,duration:n!==void 0?n:250,easing:oi})}const ki=lg;class cg extends ki{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==Lt.DBLCLICK){const n=t.originalEvent,r=t.map,s=t.coordinate,o=n.shiftKey?-this.delta_:this.delta_,a=r.getView();So(a,o,s,this.duration_),n.preventDefault(),e=!0}return!e}}const fg=cg;class dg extends ki{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Lt.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Lt.POINTERUP){const n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==Lt.POINTERDOWN){const n=this.handleDownEvent(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==Lt.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}}function To(i){const t=i.length;let e=0,n=0;for(let r=0;r<t;r++)e+=i[r].clientX,n+=i[r].clientY;return{clientX:e/t,clientY:n/t}}const Gi=dg;function Ts(i){const t=arguments;return function(e){let n=!0;for(let r=0,s=t.length;r<s&&(n=n&&t[r](e),!!n);++r);return n}}const gg=function(i){const t=i.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},mg=function(i){const t=i.map.getTargetElement(),e=i.map.getOwnerDocument().activeElement;return t.contains(e)},rl=function(i){return i.map.getTargetElement().hasAttribute("tabindex")?mg(i):!0},_g=Di,sl=function(i){const t=i.originalEvent;return t.button==0&&!(Wh&&Yh&&t.ctrlKey)},ol=function(i){const t=i.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},pg=function(i){const t=i.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},al=function(i){const t=i.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},rs=function(i){const t=i.originalEvent;return lt(t!==void 0,56),t.pointerType=="mouse"},vg=function(i){const t=i.originalEvent;return lt(t!==void 0,56),t.isPrimary&&t.button===0};class Dg extends Gi{constructor(t){super({stopDown:Fr}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:Ts(ol,vg);this.condition_=t.onFocusOnly?Ts(rl,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const n=this.targetPointers,r=e.getEventPixel(To(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=t.map.getView();_c(s,a.getResolution()),Qs(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,n=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=n.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),u=e.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);n.animateInternal({center:n.getConstrainedCenter(u),duration:500,easing:oi})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const n=t.map.getView();return this.lastCentroid=null,n.getAnimating()&&n.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}const yg=Dg;class Eg extends Gi{constructor(t){t=t||{},super({stopDown:Fr}),this.condition_=t.condition?t.condition:gg,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!rs(t))return;const e=t.map,n=e.getView();if(n.getConstraints().rotation===Co)return;const r=e.getSize(),s=t.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;n.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(t){return rs(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return rs(t)&&sl(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}const Cg=Eg;class wg extends Xs{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,n="px",r=this.element_.style;r.left=Math.min(t[0],e[0])+n,r.top=Math.min(t[1],e[1])+n,r.width=Math.abs(e[0]-t[0])+n,r.height=Math.abs(e[1]-t[1])+n}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,r=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new wi([r])}getGeometry(){return this.geometry_}}const xg=wg,Qi={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class ss extends je{constructor(t,e,n){super(t),this.coordinate=e,this.mapBrowserEvent=n}}class Ag extends Gi{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new xg(t.className||"ol-dragbox"),this.minArea_=t.minArea!==void 0?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:sl,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,n){const r=n[0]-e[0],s=n[1]-e[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new ss(Qi.BOXDRAG,t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new ss(e?Qi.BOXEND:Qi.BOXCANCEL,t.coordinate,t)),!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new ss(Qi.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}}const Fg=Ag;class Sg extends Fg{constructor(t){t=t||{};const e=t.condition?t.condition:pg;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){const n=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=n.rotatedExtentForGeometry(r),o=n.getResolutionForExtentInternal(s),a=n.getResolution()/o;r=r.clone(),r.scale(a*a)}n.fitInternal(r,{duration:this.duration_,easing:oi})}}const Tg=Sg,vn={LEFT:37,UP:38,RIGHT:39,DOWN:40};class Rg extends ki{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return ol(e)&&al(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==at.KEYDOWN){const n=t.originalEvent,r=n.keyCode;if(this.condition_(t)&&(r==vn.DOWN||r==vn.LEFT||r==vn.RIGHT||r==vn.UP)){const o=t.map.getView(),a=o.getResolution()*this.pixelDelta_;let u=0,c=0;r==vn.DOWN?c=-a:r==vn.LEFT?u=-a:r==vn.RIGHT?u=a:c=a;const l=[u,c];Qs(l,o.getRotation()),hg(o,l,this.duration_),n.preventDefault(),e=!0}}return!e}}const Mg=Rg;class Ig extends ki{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:al,this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==at.KEYDOWN||t.type==at.KEYPRESS){const n=t.originalEvent,r=n.key;if(this.condition_(t)&&(r==="+"||r==="-")){const s=t.map,o=r==="+"?this.delta_:-this.delta_,a=s.getView();So(a,o,void 0,this.duration_),n.preventDefault(),e=!0}}return!e}}const bg=Ig;class Lg extends ki{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;const e=t.condition?t.condition:_g;this.condition_=t.onFocusOnly?Ts(rl,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t)||t.type!==at.WHEEL)return!0;const n=t.map,r=t.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate);let s;if(t.type==at.WHEEL&&(s=r.deltaY,Gh&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(s/=hu),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(s*=40)),s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=n.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=o,!1;this.totalDelta_+=s;const u=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),u),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let n=-kt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),So(e,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}const Ng=Lg;class Og extends Gi{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=Fr),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0;const n=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-n.clientY,r.clientX-n.clientX);if(this.lastAngle_!==void 0){const u=s-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=u}this.lastAngle_=s;const o=t.map,a=o.getView();a.getConstraints().rotation!==Co&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(To(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}const Pg=Og;class Bg extends Gi{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=Fr),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const n=this.targetPointers[0],r=this.targetPointers[1],s=n.clientX-r.clientX,o=n.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(e=this.lastDistance_/a),this.lastDistance_=a;const u=t.map,c=u.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(To(this.targetPointers))),u.render(),c.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const n=t.map.getView(),r=this.lastScaleDelta_>1?1:-1;return n.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}const zg=Bg;function kg(i){i=i||{};const t=new Pe,e=new Gd(-.005,.05,100);return(i.altShiftDragRotate!==void 0?i.altShiftDragRotate:!0)&&t.push(new Cg),(i.doubleClickZoom!==void 0?i.doubleClickZoom:!0)&&t.push(new fg({delta:i.zoomDelta,duration:i.zoomDuration})),(i.dragPan!==void 0?i.dragPan:!0)&&t.push(new yg({onFocusOnly:i.onFocusOnly,kinetic:e})),(i.pinchRotate!==void 0?i.pinchRotate:!0)&&t.push(new Pg),(i.pinchZoom!==void 0?i.pinchZoom:!0)&&t.push(new zg({duration:i.zoomDuration})),(i.keyboard!==void 0?i.keyboard:!0)&&(t.push(new Mg),t.push(new bg({delta:i.zoomDelta,duration:i.zoomDuration}))),(i.mouseWheelZoom!==void 0?i.mouseWheelZoom:!0)&&t.push(new Ng({onFocusOnly:i.onFocusOnly,duration:i.zoomDuration})),(i.shiftDragZoom!==void 0?i.shiftDragZoom:!0)&&t.push(new Tg({duration:i.zoomDuration})),t}function ul(i){if(i instanceof Br){i.setMapInternal(null);return}i instanceof zr&&i.getLayers().forEach(ul)}function ll(i,t){if(i instanceof Br){i.setMapInternal(t);return}if(i instanceof zr){const e=i.getLayers().getArray();for(let n=0,r=e.length;n<r;++n)ll(e[n],t)}}let Gg=class extends We{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=Xg(t);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:hu,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=ze(),this.pixelToCoordinateTransform_=ze(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=e.controls||ug(),this.interactions=e.interactions||kg({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new Qd(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(re.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(re.VIEW,this.handleViewChanged_),this.addChangeListener(re.SIZE,this.handleSizeChanged_),this.addChangeListener(re.TARGET,this.handleTargetChanged_),this.setProperties(e.values);const n=this;t.view&&!(t.view instanceof Ne)&&t.view.then(function(r){n.setView(new Ne(r))}),this.controls.addEventListener(me.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(me.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(me.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(me.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(me.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(me.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){ll(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,n){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(t);n=n!==void 0?n:{};const s=n.hitTolerance!==void 0?n.hitTolerance:0,o=n.layerFilter!==void 0?n.layerFilter:Di,a=n.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,e,null,o,null)}getFeaturesAtPixel(t,e){const n=[];return this.forEachFeatureAtPixel(t,function(r){n.push(r)},e),n}getAllLayers(){const t=[];function e(n){n.forEach(function(r){r instanceof zr?e(r.getLayers()):t.push(r)})}return e(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const n=this.getCoordinateFromPixelInternal(t);e=e!==void 0?e:{};const r=e.layerFilter!==void 0?e.layerFilter:Di,s=e.hitTolerance!==void 0?e.hitTolerance:0,o=e.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,s,o,r,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const n=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=n.width/r[0],o=n.height/r[1],a="changedTouches"in t?t.changedTouches[0]:t;return[(a.clientX-n.left)/s,(a.clientY-n.top)/o]}getTarget(){return this.get(re.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return Es(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?Ht(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(re.LAYERGROUP)}setLayers(t){const e=this.getLayerGroup();if(t instanceof Pe){e.setLayers(t);return}const n=e.getLayers();n.clear(),n.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const r=t[e];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(t){const e=Ve(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?Ht(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(re.SIZE)}getView(){return this.get(re.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,n,r){return tg(this.frameState_,t,e,n,r)}handleBrowserEvent(t,e){e=e||t.type;const n=new sn(e,this,t);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,n=e.type;if(n===Ss.POINTERDOWN||n===at.WHEEL||n===at.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=e.target;if(this.overlayContainerStopEvent_.contains(o)||!(s===r?r.documentElement:s).contains(o))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let r=this.maxTilesLoading_,s=r;if(t){const o=t.viewHints;if(o[se.ANIMATING]||o[se.INTERACTING]){const a=Date.now()-t.time>8;r=a?0:8,s=a?0:2}}e.getTilesLoading()<r&&(e.reprioritize(),e.loadMoreTiles(r,s))}t&&this.renderer_&&!t.animate&&(this.renderComplete_===!0?(this.hasListener(cn.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(cn.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Yn(on.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Yn(on.LOADSTART,this,t))));const n=this.postRenderFunctions_;for(let r=0,s=n.length;r<s;++r)n[r](this,t);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let n=0,r=this.targetChangeHandlerKeys_.length;n<r;++n)St(this.targetChangeHandlerKeys_[n]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(at.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(at.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Cs(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const n=this.targetElement_.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.unobserve(n.host)}const t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,!e)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new Zd(this)),this.mapBrowserEventHandler_=new qd(this,this.moveTolerance_);for(const s in Lt)this.mapBrowserEventHandler_.addEventListener(Lt[s],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(at.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(at.WHEEL,this.boundHandleBrowserEvent_,cu?{passive:!1}:!1);const n=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[mt(n,at.KEYDOWN,this.handleBrowserEvent,this),mt(n,at.KEYPRESS,this.handleBrowserEvent,this)];const r=e.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_.observe(e)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(St(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(St(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=mt(t,ti.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=mt(t,at.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(St),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new an("addlayer",t)),this.layerGroupPropertyListenerKeys_=[mt(t,ti.PROPERTYCHANGE,this.render,this),mt(t,at.CHANGE,this.render,this),mt(t,"addlayer",this.handleLayerAdd_,this),mt(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const r=t[e].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){ul(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),n=this.getView(),r=this.frameState_;let s=null;if(e!==void 0&&ra(e)&&n&&n.isDef()){const o=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=n.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:ms(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:_t(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const u=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=ms(a.nextCenter,a.nextResolution,u,e)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!Hs(this.previousExtent_)&&!Ei(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Yn(on.MOVESTART,this,r)),this.previousExtent_=Mr(this.previousExtent_)),this.previousExtent_&&!s.viewHints[se.ANIMATING]&&!s.viewHints[se.INTERACTING]&&!Ei(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Yn(on.MOVEEND,this,s)),du(s.extent,this.previousExtent_))),this.dispatchEvent(new Yn(on.POSTRENDER,this,s)),this.renderComplete_=this.hasListener(on.LOADSTART)||this.hasListener(on.LOADEND)||this.hasListener(cn.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new an("removelayer",e)),this.set(re.LAYERGROUP,t)}setSize(t){this.set(re.SIZE,t)}setTarget(t){this.set(re.TARGET,t)}setView(t){if(!t||t instanceof Ne){this.set(re.VIEW,t);return}this.set(re.VIEW,new Ne);const e=this;t.then(function(n){e.setView(new Ne(n))})}updateSize(){const t=this.getTargetElement();let e;if(t){const r=getComputedStyle(t),s=t.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),o=t.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);!isNaN(s)&&!isNaN(o)&&(e=[s,o],!ra(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&Eu("No map visible because the map container's width or height are 0."))}const n=this.getSize();e&&(!n||!mn(e,n))&&(this.setSize(e),this.updateViewportSize_())}updateViewportSize_(){const t=this.getView();if(t){let e;const n=getComputedStyle(this.viewport_);n.width&&n.height&&(e=[parseInt(n.width,10),parseInt(n.height,10)]),t.setViewportSize(e)}}};function Xg(i){let t=null;i.keyboardEventTarget!==void 0&&(t=typeof i.keyboardEventTarget=="string"?document.getElementById(i.keyboardEventTarget):i.keyboardEventTarget);const e={},n=i.layers&&typeof i.layers.getLayers=="function"?i.layers:new zr({layers:i.layers});e[re.LAYERGROUP]=n,e[re.TARGET]=i.target,e[re.VIEW]=i.view instanceof Ne?i.view:new Ne;let r;i.controls!==void 0&&(Array.isArray(i.controls)?r=new Pe(i.controls.slice()):(lt(typeof i.controls.getArray=="function",47),r=i.controls));let s;i.interactions!==void 0&&(Array.isArray(i.interactions)?s=new Pe(i.interactions.slice()):(lt(typeof i.interactions.getArray=="function",48),s=i.interactions));let o;return i.overlays!==void 0?Array.isArray(i.overlays)?o=new Pe(i.overlays.slice()):(lt(typeof i.overlays.getArray=="function",49),o=i.overlays):o=new Pe,{controls:r,interactions:s,keyboardEventTarget:t,overlays:o,values:e}}const Wg=Gg;class Yg{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const n=this.entries_[t];return lt(n!==void 0,15),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}remove(t){const e=this.entries_[t];return lt(e!==void 0,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.key_;return t}getValues(){const t=new Array(this.count_);let e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){if(this.containsKey(t))return this.entries_[t].value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){lt(!(t in this.entries_),16);const n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_}setSize(t){this.highWaterMark=t}}const Ug=Yg;function Ma(i,t,e,n){return n!==void 0?(n[0]=i,n[1]=t,n[2]=e,n):[i,t,e]}function kr(i,t,e){return i+"/"+t+"/"+e}function hl(i){return kr(i[0],i[1],i[2])}function Zg(i){return i.split("/").map(Number)}function Vg(i){return(i[1]<<i[0])+i[2]}function Kg(i,t){const e=i[0],n=i[1],r=i[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;const s=t.getFullTileRange(e);return s?s.containsXY(n,r):!0}class $g extends Ug{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(this.getCount()===0)return;const t=this.peekFirstKey(),n=Zg(t)[0];this.forEach(r=>{r.tileCoord[0]!==n&&(this.remove(hl(r.tileCoord)),r.release())})}}const cl=$g;class fl{constructor(t,e,n,r){this.minX=t,this.maxX=e,this.minY=n,this.maxY=r}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function Pn(i,t,e,n,r){return r!==void 0?(r.minX=i,r.maxX=t,r.minY=e,r.maxY=n,r):new fl(i,t,e,n)}const dl=fl,tr={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class qg extends Br{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getPreload(){return this.get(tr.PRELOAD)}setPreload(t){this.set(tr.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(tr.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(tr.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}}const Hg=qg,jg=.5,Jg=10,Ia=.25;class Qg{constructor(t,e,n,r,s,o){this.sourceProj_=t,this.targetProj_=e;let a={};const u=ar(this.targetProj_,this.sourceProj_);this.transformInv_=function(D){const v=D[0]+"/"+D[1];return a[v]||(a[v]=u(D)),a[v]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&xt(r)==xt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?xt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?xt(this.targetProj_.getExtent()):null;const c=Tn(n),l=Lr(n),h=br(n),f=Ir(n),g=this.transformInv_(c),m=this.transformInv_(l),d=this.transformInv_(h),_=this.transformInv_(f),p=Jg+(o?Math.max(0,Math.ceil(Math.log2(gs(n)/(o*o*256*256)))):0);if(this.addQuad_(c,l,h,f,g,m,d,_,p),this.wrapsXInSource_){let D=1/0;this.triangles_.forEach(function(v,y,E){D=Math.min(D,v.source[0][0],v.source[1][0],v.source[2][0])}),this.triangles_.forEach(v=>{if(Math.max(v.source[0][0],v.source[1][0],v.source[2][0])-D>this.sourceWorldWidth_/2){const y=[[v.source[0][0],v.source[0][1]],[v.source[1][0],v.source[1][1]],[v.source[2][0],v.source[2][1]]];y[0][0]-D>this.sourceWorldWidth_/2&&(y[0][0]-=this.sourceWorldWidth_),y[1][0]-D>this.sourceWorldWidth_/2&&(y[1][0]-=this.sourceWorldWidth_),y[2][0]-D>this.sourceWorldWidth_/2&&(y[2][0]-=this.sourceWorldWidth_);const E=Math.min(y[0][0],y[1][0],y[2][0]);Math.max(y[0][0],y[1][0],y[2][0])-E<this.sourceWorldWidth_/2&&(v.source=y)}})}a={}}addTriangle_(t,e,n,r,s,o){this.triangles_.push({source:[r,s,o],target:[t,e,n]})}addQuad_(t,e,n,r,s,o,a,u,c){const l=Vo([s,o,a,u]),h=this.sourceWorldWidth_?xt(l)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,g=this.sourceProj_.canWrapX()&&h>.5&&h<1;let m=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const _=Vo([t,e,n,r]);m=xt(_)/this.targetWorldWidth_>Ia||m}!g&&this.sourceProj_.isGlobal()&&h&&(m=h>Ia||m)}if(!m&&this.maxSourceExtent_&&isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(l[3])&&!oe(l,this.maxSourceExtent_))return;let d=0;if(!m&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(u[0])||!isFinite(u[1]))){if(c>0)m=!0;else if(d=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),d!=1&&d!=2&&d!=4&&d!=8)return}if(c>0){if(!m){const _=[(t[0]+n[0])/2,(t[1]+n[1])/2],p=this.transformInv_(_);let D;g?D=(An(s[0],f)+An(a[0],f))/2-An(p[0],f):D=(s[0]+a[0])/2-p[0];const v=(s[1]+a[1])/2-p[1];m=D*D+v*v>this.errorThresholdSquared_}if(m){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){const _=[(e[0]+n[0])/2,(e[1]+n[1])/2],p=this.transformInv_(_),D=[(r[0]+t[0])/2,(r[1]+t[1])/2],v=this.transformInv_(D);this.addQuad_(t,e,_,D,s,o,p,v,c-1),this.addQuad_(D,_,n,r,v,p,a,u,c-1)}else{const _=[(t[0]+e[0])/2,(t[1]+e[1])/2],p=this.transformInv_(_),D=[(n[0]+r[0])/2,(n[1]+r[1])/2],v=this.transformInv_(D);this.addQuad_(t,_,D,r,s,p,v,u,c-1),this.addQuad_(_,e,n,D,p,o,a,v,c-1)}return}}if(g){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}d&11||this.addTriangle_(t,n,r,s,a,u),d&14||this.addTriangle_(t,n,e,s,a,o),d&&(d&13||this.addTriangle_(e,r,t,o,u,s),d&7||this.addTriangle_(e,r,n,o,u,a))}calculateSourceExtent(){const t=Re();return this.triangles_.forEach(function(e,n,r){const s=e.source;mi(t,s[0]),mi(t,s[1]),mi(t,s[2])}),t}getTriangles(){return this.triangles_}}const t0=Qg;let os;const jn=[];function ba(i,t,e,n,r){i.beginPath(),i.moveTo(0,0),i.lineTo(t,e),i.lineTo(n,r),i.closePath(),i.save(),i.clip(),i.fillRect(0,0,Math.max(t,n)+1,Math.max(e,r)),i.restore()}function as(i,t){return Math.abs(i[t*4]-210)>2||Math.abs(i[t*4+3]-.75*255)>2}function e0(){if(os===void 0){const i=ce(6,6,jn);i.globalCompositeOperation="lighter",i.fillStyle="rgba(210, 0, 0, 0.75)",ba(i,4,5,4,0),ba(i,4,5,0,5);const t=i.getImageData(0,0,3,3).data;os=as(t,0)||as(t,4)||as(t,8),Nr(i),jn.push(i.canvas)}return os}function La(i,t,e,n){const r=io(e,t,i);let s=ys(t,n,e);const o=t.getMetersPerUnit();o!==void 0&&(s*=o);const a=i.getMetersPerUnit();a!==void 0&&(s/=a);const u=i.getExtent();if(!u||Rr(u,r)){const c=ys(i,s,r)/s;isFinite(c)&&c>0&&(s/=c)}return s}function n0(i,t,e,n){const r=ni(e);let s=La(i,t,r,n);return(!isFinite(s)||s<=0)&&qs(e,function(o){return s=La(i,t,o,n),isFinite(s)&&s>0}),s}function i0(i,t,e,n,r,s,o,a,u,c,l,h){const f=ce(Math.round(e*i),Math.round(e*t),jn);if(h||(f.imageSmoothingEnabled=!1),u.length===0)return f.canvas;f.scale(e,e);function g(y){return Math.round(y*e)/e}f.globalCompositeOperation="lighter";const m=Re();u.forEach(function(y,E,C){jh(m,y.extent)});const d=xt(m),_=Ge(m),p=ce(Math.round(e*d/n),Math.round(e*_/n),jn);h||(p.imageSmoothingEnabled=!1);const D=e/n;u.forEach(function(y,E,C){const F=y.extent[0]-m[0],w=-(y.extent[3]-m[3]),A=xt(y.extent),T=Ge(y.extent);y.image.width>0&&y.image.height>0&&p.drawImage(y.image,c,c,y.image.width-2*c,y.image.height-2*c,F*D,w*D,A*D,T*D)});const v=Tn(o);return a.getTriangles().forEach(function(y,E,C){const F=y.source,w=y.target;let A=F[0][0],T=F[0][1],I=F[1][0],N=F[1][1],X=F[2][0],U=F[2][1];const b=g((w[0][0]-v[0])/s),M=g(-(w[0][1]-v[1])/s),L=g((w[1][0]-v[0])/s),k=g(-(w[1][1]-v[1])/s),V=g((w[2][0]-v[0])/s),$=g(-(w[2][1]-v[1])/s),tt=A,O=T;A=0,T=0,I-=tt,N-=O,X-=tt,U-=O;const it=[[I,N,0,0,L-b],[X,U,0,0,V-b],[0,0,I,N,k-M],[0,0,X,U,$-M]],J=gc(it);if(J){if(f.save(),f.beginPath(),e0()||!h){f.moveTo(L,k);const et=4,Dt=b-L,ht=M-k;for(let ft=0;ft<et;ft++)f.lineTo(L+g((ft+1)*Dt/et),k+g(ft*ht/(et-1))),ft!=et-1&&f.lineTo(L+g((ft+1)*Dt/et),k+g((ft+1)*ht/(et-1)));f.lineTo(V,$)}else f.moveTo(L,k),f.lineTo(b,M),f.lineTo(V,$);f.clip(),f.transform(J[0],J[2],J[1],J[3],b,M),f.translate(m[0]-tt,m[3]-O),f.scale(n/e,-n/e),f.drawImage(p.canvas,0,0),f.restore()}}),Nr(p),jn.push(p.canvas),l&&(f.save(),f.globalCompositeOperation="source-over",f.strokeStyle="black",f.lineWidth=1,a.getTriangles().forEach(function(y,E,C){const F=y.target,w=(F[0][0]-v[0])/s,A=-(F[0][1]-v[1])/s,T=(F[1][0]-v[0])/s,I=-(F[1][1]-v[1])/s,N=(F[2][0]-v[0])/s,X=-(F[2][1]-v[1])/s;f.beginPath(),f.moveTo(T,I),f.lineTo(w,A),f.lineTo(N,X),f.closePath(),f.stroke()}),f.restore()),f.canvas}class r0 extends nl{constructor(t,e,n,r,s,o,a,u,c,l,h,f){super(s,j.IDLE,{interpolate:!!f}),this.renderEdges_=h!==void 0?h:!1,this.pixelRatio_=a,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const g=r.getTileCoordExtent(this.wrappedTileCoord_),m=this.targetTileGrid_.getExtent();let d=this.sourceTileGrid_.getExtent();const _=m?_i(g,m):g;if(gs(_)===0){this.state=j.EMPTY;return}const p=t.getExtent();p&&(d?d=_i(d,p):d=p);const D=r.getResolution(this.wrappedTileCoord_[0]),v=n0(t,n,_,D);if(!isFinite(v)||v<=0){this.state=j.EMPTY;return}const y=l!==void 0?l:jg;if(this.triangulation_=new t0(t,n,_,d,v*y,D),this.triangulation_.getTriangles().length===0){this.state=j.EMPTY;return}this.sourceZ_=e.getZForResolution(v);let E=this.triangulation_.calculateSourceExtent();if(d&&(t.canWrapX()?(E[1]=kt(E[1],d[1],d[3]),E[3]=kt(E[3],d[1],d[3])):E=_i(E,d)),!gs(E))this.state=j.EMPTY;else{const C=e.getTileRangeForExtentAndZ(E,this.sourceZ_);for(let F=C.minX;F<=C.maxX;F++)for(let w=C.minY;w<=C.maxY;w++){const A=c(this.sourceZ_,F,w,a);A&&this.sourceTiles_.push(A)}this.sourceTiles_.length===0&&(this.state=j.EMPTY)}}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{e&&e.getState()==j.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}),this.sourceTiles_.length=0,t.length===0)this.state=j.ERROR;else{const e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),r=typeof n=="number"?n:n[0],s=typeof n=="number"?n:n[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=i0(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,u,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=j.LOADED}this.changed()}load(){if(this.state==j.IDLE){this.state=j.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(e=>{const n=e.getState();if(n==j.IDLE||n==j.LOADING){t++;const r=mt(e,at.CHANGE,function(s){const o=e.getState();(o==j.LOADED||o==j.ERROR||o==j.EMPTY)&&(St(r),t--,t===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(r)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(e,n,r){e.getState()==j.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(St),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Nr(this.canvas_.getContext("2d")),jn.push(this.canvas_),this.canvas_=null),super.release()}}const Rs=r0;class s0 extends Ju{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=Re(),this.tmpTileRange_=new dl(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),n=t.getState(),r=e.getUseInterimTilesOnError();return n==j.LOADED||n==j.EMPTY||n==j.ERROR&&!r}getTile(t,e,n,r){const s=r.pixelRatio,o=r.viewState.projection,a=this.getLayer();let c=a.getSource().getTile(t,e,n,s,o);return c.getState()==j.ERROR&&a.getUseInterimTilesOnError()&&a.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(c)||(c=c.getInterimTile()),c}getData(t){const e=this.frameState;if(!e)return null;const n=this.getLayer(),r=Ht(e.pixelToCoordinateTransform,t.slice()),s=n.getExtent();if(s&&!Rr(s,r))return null;const o=e.pixelRatio,a=e.viewState.projection,u=e.viewState,c=n.getRenderSource(),l=c.getTileGridForProjection(u.projection),h=c.getTilePixelRatio(e.pixelRatio);for(let f=l.getZForResolution(u.resolution);f>=l.getMinZoom();--f){const g=l.getTileCoordForCoordAndZ(r,f),m=c.getTile(f,g[1],g[2],o,a);if(!(m instanceof il||m instanceof Rs)||m instanceof Rs&&m.getState()===j.EMPTY)return null;if(m.getState()!==j.LOADED)continue;const d=l.getOrigin(f),_=De(l.getTileSize(f)),p=l.getResolution(f),D=Math.floor(h*((r[0]-d[0])/p-g[1]*_[0])),v=Math.floor(h*((d[1]-r[1])/p-g[2]*_[1])),y=Math.round(h*c.getGutterForProjection(u.projection));return this.getImageData(m.getImage(),D+y,v+y)}return null}loadedTileCallback(t,e,n){return this.isDrawableTile(n)?super.loadedTileCallback(t,e,n):!1}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const n=t.layerStatesArray[t.layerIndex],r=t.viewState,s=r.projection,o=r.resolution,a=r.center,u=r.rotation,c=t.pixelRatio,l=this.getLayer(),h=l.getSource(),f=h.getRevision(),g=h.getTileGridForProjection(s),m=g.getZForResolution(o,h.zDirection),d=g.getResolution(m);let _=t.extent;const p=t.viewState.resolution,D=h.getTilePixelRatio(c),v=Math.round(xt(_)/p*c),y=Math.round(Ge(_)/p*c),E=n.extent&&yn(n.extent);E&&(_=_i(_,yn(n.extent)));const C=d*v/2/D,F=d*y/2/D,w=[a[0]-C,a[1]-F,a[0]+C,a[1]+F],A=g.getTileRangeForExtentAndZ(_,m),T={};T[m]={};const I=this.createLoadedTileFinder(h,s,T),N=this.tmpExtent,X=this.tmpTileRange_;this.newTiles_=!1;const U=u?_s(r.center,p,u,t.size):void 0;for(let it=A.minX;it<=A.maxX;++it)for(let J=A.minY;J<=A.maxY;++J){if(u&&!g.tileCoordIntersectsViewport([m,it,J],U))continue;const et=this.getTile(m,it,J,t);if(this.isDrawableTile(et)){const ft=_t(this);if(et.getState()==j.LOADED){T[m][et.tileCoord.toString()]=et;let ut=et.inTransition(ft);ut&&n.opacity!==1&&(et.endTransition(ft),ut=!1),!this.newTiles_&&(ut||!this.renderedTiles.includes(et))&&(this.newTiles_=!0)}if(et.getAlpha(ft,t.time)===1)continue}const Dt=g.getTileCoordChildTileRange(et.tileCoord,X,N);let ht=!1;Dt&&(ht=I(m+1,Dt)),ht||g.forEachTileCoordParentTileRange(et.tileCoord,I,X,N)}const b=d/o*c/D;dn(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/c,1/c,u,-v/2,-y/2);const M=fu(this.pixelTransform);this.useContainer(e,M,this.getBackground(t));const L=this.context,k=L.canvas;Vs(this.inversePixelTransform,this.pixelTransform),dn(this.tempTransform,v/2,y/2,b,b,0,-v/2,-y/2),k.width!=v||k.height!=y?(k.width=v,k.height=y):this.containerReused||L.clearRect(0,0,v,y),E&&this.clipUnrotated(L,t,E),h.getInterpolate()||(L.imageSmoothingEnabled=!1),this.preRender(L,t),this.renderedTiles.length=0;let V=Object.keys(T).map(Number);V.sort(Sn);let $,tt,O;n.opacity===1&&(!this.containerReused||h.getOpaque(t.viewState.projection))?V=V.reverse():($=[],tt=[]);for(let it=V.length-1;it>=0;--it){const J=V[it],et=h.getTilePixelSize(J,c,s),ht=g.getResolution(J)/d,ft=et[0]*ht*b,ut=et[1]*ht*b,ct=g.getTileCoordForCoordAndZ(Tn(w),J),jt=g.getTileCoordExtent(ct),At=Ht(this.tempTransform,[D*(jt[0]-w[0])/d,D*(w[3]-jt[3])/d]),dt=D*h.getGutterForProjection(s),Et=T[J];for(const Yt in Et){const Ut=Et[Yt],fe=Ut.tileCoord,Ee=ct[1]-fe[1],Ce=Math.round(At[0]-(Ee-1)*ft),Ie=ct[2]-fe[2],ai=Math.round(At[1]-(Ie-1)*ut),Jt=Math.round(At[0]-Ee*ft),x=Math.round(At[1]-Ie*ut),S=Ce-Jt,R=ai-x,P=m===J,W=P&&Ut.getAlpha(_t(this),t.time)!==1;let Y=!1;if(!W)if($){O=[Jt,x,Jt+S,x,Jt+S,x+R,Jt,x+R];for(let Z=0,B=$.length;Z<B;++Z)if(m!==J&&J<tt[Z]){const G=$[Z];oe([Jt,x,Jt+S,x+R],[G[0],G[3],G[4],G[7]])&&(Y||(L.save(),Y=!0),L.beginPath(),L.moveTo(O[0],O[1]),L.lineTo(O[2],O[3]),L.lineTo(O[4],O[5]),L.lineTo(O[6],O[7]),L.moveTo(G[6],G[7]),L.lineTo(G[4],G[5]),L.lineTo(G[2],G[3]),L.lineTo(G[0],G[1]),L.clip())}$.push(O),tt.push(J)}else L.clearRect(Jt,x,S,R);this.drawTileImage(Ut,t,Jt,x,S,R,dt,P),$&&!W?(Y&&L.restore(),this.renderedTiles.unshift(Ut)):this.renderedTiles.push(Ut),this.updateUsedTiles(t.usedTiles,h,Ut)}}return this.renderedRevision=f,this.renderedResolution=d,this.extentChanged=!this.renderedExtent_||!Ei(this.renderedExtent_,w),this.renderedExtent_=w,this.renderedPixelRatio=c,this.renderedProjection=s,this.manageTilePyramid(t,h,g,c,s,_,m,l.getPreload()),this.scheduleExpireCache(t,h),this.postRender(L,t),n.extent&&L.restore(),L.imageSmoothingEnabled=!0,M!==k.style.transform&&(k.style.transform=M),this.container}drawTileImage(t,e,n,r,s,o,a,u){const c=this.getTileImage(t);if(!c)return;const l=_t(this),h=e.layerStatesArray[e.layerIndex],f=h.opacity*(u?t.getAlpha(l,e.time):1),g=f!==this.context.globalAlpha;g&&(this.context.save(),this.context.globalAlpha=f),this.context.drawImage(c,a,a,c.width-2*a,c.height-2*a,n,r,s,o),g&&this.context.restore(),f!==h.opacity?e.animate=!0:u&&t.endTransition(l)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const n=function(r,s,o){const a=_t(r);a in o.usedTiles&&r.expireCache(o.viewState.projection,o.usedTiles[a])}.bind(null,e);t.postRenderFunctions.push(n)}}updateUsedTiles(t,e,n){const r=_t(e);r in t||(t[r]={}),t[r][n.getKey()]=!0}manageTilePyramid(t,e,n,r,s,o,a,u,c){const l=_t(e);l in t.wantedTiles||(t.wantedTiles[l]={});const h=t.wantedTiles[l],f=t.tileQueue,g=n.getMinZoom(),m=t.viewState.rotation,d=m?_s(t.viewState.center,t.viewState.resolution,m,t.size):void 0;let _=0,p,D,v,y,E,C;for(C=g;C<=a;++C)for(D=n.getTileRangeForExtentAndZ(o,C,D),v=n.getResolution(C),y=D.minX;y<=D.maxX;++y)for(E=D.minY;E<=D.maxY;++E)m&&!n.tileCoordIntersectsViewport([C,y,E],d)||(a-C<=u?(++_,p=e.getTile(C,y,E,r,s),p.getState()==j.IDLE&&(h[p.getKey()]=!0,f.isKeyQueued(p.getKey())||f.enqueue([p,l,n.getTileCoordCenter(p.tileCoord),v])),c!==void 0&&c(p)):e.useTile(C,y,E,s));e.updateCacheSize(_,s)}}const o0=s0;class a0 extends Hg{constructor(t){super(t)}createRenderer(){return new o0(this)}}const u0=a0,us={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},Bn=[0,0,0],rn=5;class l0{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,lt(bh(this.resolutions_,function(r,s){return s-r},!0),17);let e;if(!t.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!e)e=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,lt(this.origins_.length==this.resolutions_.length,20));const n=t.extent;n!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Tn(n)),lt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,lt(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:Do,lt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=n!==void 0?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map(function(r,s){const o=new dl(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(n){const a=this.getTileRangeForExtentAndZ(n,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o},this):n&&this.calculateTileRanges_(n)}forEachTileCoord(t,e,n){const r=this.getTileRangeForExtentAndZ(t,e);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,u=r.maxY;a<=u;++a)n([e,s,a])}forEachTileCoordParentTileRange(t,e,n,r){let s,o,a,u=null,c=t[0]-1;for(this.zoomFactor_===2?(o=t[1],a=t[2]):u=this.getTileCoordExtent(t,r);c>=this.minZoom;){if(this.zoomFactor_===2?(o=Math.floor(o/2),a=Math.floor(a/2),s=Pn(o,o,a,a,n)):s=this.getTileRangeForExtentAndZ(u,c,n),e(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,n){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){const s=t[1]*2,o=t[2]*2;return Pn(s,s+1,o,o+1,e)}const r=this.getTileCoordExtent(t,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,n){if(e>this.maxZoom||e<this.minZoom)return null;const r=t[0],s=t[1],o=t[2];if(e===r)return Pn(s,o,s,o,n);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,e-r),c=Math.floor(s*u),l=Math.floor(o*u);if(e<r)return Pn(c,c,l,l,n);const h=Math.floor(u*(s+1))-1,f=Math.floor(u*(o+1))-1;return Pn(c,h,l,f,n)}const a=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e,n)}getTileRangeExtent(t,e,n){const r=this.getOrigin(t),s=this.getResolution(t),o=De(this.getTileSize(t),this.tmpSize_),a=r[0]+e.minX*o[0]*s,u=r[0]+(e.maxX+1)*o[0]*s,c=r[1]+e.minY*o[1]*s,l=r[1]+(e.maxY+1)*o[1]*s;return ke(a,c,u,l,n)}getTileRangeForExtentAndZ(t,e,n){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,Bn);const r=Bn[1],s=Bn[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,Bn);const o=Bn[1],a=Bn[2];return Pn(r,o,s,a,n)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=De(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*n,e[1]-(t[2]+.5)*r[1]*n]}getTileCoordExtent(t,e){const n=this.getOrigin(t[0]),r=this.getResolution(t[0]),s=De(this.getTileSize(t[0]),this.tmpSize_),o=n[0]+t[1]*s[0]*r,a=n[1]-(t[2]+1)*s[1]*r,u=o+s[0]*r,c=a+s[1]*r;return ke(o,a,u,c,e)}getTileCoordForCoordAndResolution(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)}getTileCoordForXYAndResolution_(t,e,n,r,s){const o=this.getZForResolution(n),a=n/this.getResolution(o),u=this.getOrigin(o),c=De(this.getTileSize(o),this.tmpSize_);let l=a*(t-u[0])/n/c[0],h=a*(u[1]-e)/n/c[1];return r?(l=Ki(l,rn)-1,h=Ki(h,rn)-1):(l=Vi(l,rn),h=Vi(h,rn)),Ma(o,l,h,s)}getTileCoordForXYAndZ_(t,e,n,r,s){const o=this.getOrigin(n),a=this.getResolution(n),u=De(this.getTileSize(n),this.tmpSize_);let c=(t-o[0])/a/u[0],l=(o[1]-e)/a/u[1];return r?(c=Ki(c,rn)-1,l=Ki(l,rn)-1):(c=Vi(c,rn),l=Vi(l,rn)),Ma(n,c,l,s)}getTileCoordForCoordAndZ(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){const n=Ws(this.resolutions_,t,e||0);return kt(n,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return bu(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,n=new Array(e);for(let r=this.minZoom;r<e;++r)n[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=n}}const gl=l0;function ml(i){let t=i.getDefaultTileGrid();return t||(t=d0(i),i.setDefaultTileGrid(t)),t}function h0(i,t,e){const n=t[0],r=i.getTileCoordCenter(t),s=Ro(e);if(!Rr(s,r)){const o=xt(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,i.getTileCoordForCoordAndZ(r,n)}return t}function c0(i,t,e,n){n=n!==void 0?n:"top-left";const r=_l(i,t,e);return new gl({extent:i,origin:Qh(i,n),resolutions:r,tileSize:e})}function f0(i){const t=i||{},e=t.extent||Me("EPSG:3857").getExtent(),n={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:_l(e,t.maxZoom,t.tileSize,t.maxResolution)};return new gl(n)}function _l(i,t,e,n){t=t!==void 0?t:cf,e=De(e!==void 0?e:Do);const r=Ge(i),s=xt(i);n=n>0?n:Math.max(s/e[0],r/e[1]);const o=t+1,a=new Array(o);for(let u=0;u<o;++u)a[u]=n/Math.pow(2,u);return a}function d0(i,t,e,n){const r=Ro(i);return c0(r,t,e,n)}function Ro(i){i=Me(i);let t=i.getExtent();if(!t){const e=180*Ci.degrees/i.getMetersPerUnit();t=ke(-e,-e,e,e)}return t}class g0 extends el{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.opaque_=t.opaque!==void 0?t.opaque:!1,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;const e=[256,256];this.tileGrid&&De(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tileCache=new cl(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const n=this.getTileCacheForProjection(t);n&&n.expireCache(e)}forEachLoadedTile(t,e,n,r){const s=this.getTileCacheForProjection(t);if(!s)return!1;let o=!0,a,u,c;for(let l=n.minX;l<=n.maxX;++l)for(let h=n.minY;h<=n.maxY;++h)u=kr(e,l,h),c=!1,s.containsKey(u)&&(a=s.get(u),c=a.getState()===j.LOADED,c&&(c=r(a)!==!1)),c||(o=!1);return o}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,n,r,s){return gt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:ml(t)}getTileCacheForProjection(t){const e=this.getProjection();return lt(e===null||kn(e,t),68),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,n){const r=this.getTileGridForProjection(n),s=this.getTilePixelRatio(e),o=De(r.getTileSize(t),this.tmpSize);return s==1?o:Zc(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){e=e!==void 0?e:this.getProjection();const n=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=h0(n,t,e)),Kg(t,n)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){const n=this.getTileCacheForProjection(e);t>n.highWaterMark&&(n.highWaterMark=t)}useTile(t,e,n,r){}}class m0 extends je{constructor(t,e){super(t),this.tile=e}}const _0=g0;function p0(i,t){const e=/\{z\}/g,n=/\{x\}/g,r=/\{y\}/g,s=/\{-y\}/g;return function(o,a,u){if(o)return i.replace(e,o[0].toString()).replace(n,o[1].toString()).replace(r,o[2].toString()).replace(s,function(){const c=o[0],l=t.getFullTileRange(c);return lt(l,55),(l.getHeight()-o[2]-1).toString()})}}function v0(i,t){const e=i.length,n=new Array(e);for(let r=0;r<e;++r)n[r]=p0(i[r],t);return D0(n)}function D0(i){return i.length===1?i[0]:function(t,e,n){if(!t)return;const r=Vg(t),s=An(r,i.length);return i[s](t,e,n)}}function y0(i){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(i);if(e){const n=e[1].charCodeAt(0),r=e[2].charCodeAt(0);let s;for(s=n;s<=r;++s)t.push(i.replace(e[0],String.fromCharCode(s)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(i),e){const n=parseInt(e[2],10);for(let r=parseInt(e[1],10);r<=n;r++)t.push(i.replace(e[0],r.toString()));return t}return t.push(i),t}class Mo extends _0{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Mo.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,n=_t(e),r=e.getState();let s;r==j.LOADING?(this.tileLoadingKeys_[n]=!0,s=us.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],s=r==j.ERROR?us.TILELOADERROR:r==j.LOADED?us.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new m0(s,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=y0(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(v0(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,n){}useTile(t,e,n){const r=kr(t,e,n);this.tileCache.containsKey(r)&&this.tileCache.get(r)}}const E0=Mo;class C0 extends E0{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:w0,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:il,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const n=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==n?e:{});for(const r in this.tileCacheForProjection){const s=this.tileCacheForProjection[r];s.expireCache(s==n?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!kn(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return this.getProjection()&&t&&!kn(this.getProjection(),t)?!1:super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||kn(e,t)))return this.tileGrid;const n=_t(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=ml(t)),this.tileGridForProjection[n]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||kn(e,t))return this.tileCache;const n=_t(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new cl(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]}createTile_(t,e,n,r,s,o){const a=[t,e,n],u=this.getTileCoordForTileUrlFunction(a,s),c=u?this.tileUrlFunction(u,r,s):void 0,l=new this.tileClass(a,c!==void 0?j.IDLE:j.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return l.key=o,l.addEventListener(at.CHANGE,this.handleTileChange.bind(this)),l}getTile(t,e,n,r,s){const o=this.getProjection();if(!o||!s||kn(o,s))return this.getTileInternal(t,e,n,r,o||s);const a=this.getTileCacheForProjection(s),u=[t,e,n];let c;const l=hl(u);a.containsKey(l)&&(c=a.get(l));const h=this.getKey();if(c&&c.key==h)return c;const f=this.getTileGridForProjection(o),g=this.getTileGridForProjection(s),m=this.getTileCoordForTileUrlFunction(u,s),d=new Rs(o,f,s,g,u,m,this.getTilePixelRatio(r),this.getGutter(),(_,p,D,v)=>this.getTileInternal(_,p,D,v,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return d.key=h,c?(d.interimTile=c,d.refreshInterimChain(),a.replace(l,d)):a.set(l,d),d}getTileInternal(t,e,n,r,s){let o=null;const a=kr(t,e,n),u=this.getKey();if(!this.tileCache.containsKey(a))o=this.createTile_(t,e,n,r,s,u),this.tileCache.set(a,o);else if(o=this.tileCache.get(a),o.key!=u){const c=o;o=this.createTile_(t,e,n,r,s,u),c.getState()==j.IDLE?o.interimTile=c.interimTile:o.interimTile=c,o.refreshInterimChain(),this.tileCache.replace(a,o)}return o}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}}setTileGridForProjection(t,e){const n=Me(t);if(n){const r=_t(n);r in this.tileGridForProjection||(this.tileGridForProjection[r]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}}function w0(i,t){i.getImage().src=t}const x0=C0;class A0 extends x0{constructor(t){t=t||{};const e=t.projection!==void 0?t.projection:"EPSG:3857",n=t.tileGrid!==void 0?t.tileGrid:f0({extent:Ro(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0}getGutter(){return this.gutter_}}const F0=A0,S0='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class T0 extends F0{constructor(t){t=t||{};let e;t.attributions!==void 0?e=t.attributions:e=[S0];const n=t.crossOrigin!==void 0?t.crossOrigin:"anonymous",r=t.url!==void 0?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:n,interpolate:t.interpolate,maxZoom:t.maxZoom!==void 0?t.maxZoom:19,opaque:t.opaque!==void 0?t.opaque:!0,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:r,wrapX:t.wrapX,zDirection:t.zDirection})}}const R0=T0;class Gr extends Pi{constructor(t,e,n){super(),n!==void 0&&e===void 0?this.setFlatCoordinates(n,t):(e=e||0,this.setCenterAndRadius(t,e,n))}clone(){const t=new Gr(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,r){const s=this.flatCoordinates,o=t-s[0],a=e-s[1],u=o*o+a*a;if(u<r){if(u===0)for(let c=0;c<this.stride;++c)n[c]=s[c];else{const c=this.getRadius()/Math.sqrt(u);n[0]=s[0]+c*o,n[1]=s[1]+c*a;for(let l=2;l<this.stride;++l)n[l]=s[l]}return n.length=this.stride,u}return r}containsXY(t,e){const n=this.flatCoordinates,r=t-n[0],s=e-n[1];return r*r+s*s<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(t){const e=this.flatCoordinates,n=e[this.stride]-e[0];return ke(e[0]-n,e[1]-n,e[0]+n,e[1]+n,t)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e}getType(){return"Circle"}intersectsExtent(t){const e=this.getExtent();if(oe(t,e)){const n=this.getCenter();return t[0]<=n[0]&&t[2]>=n[0]||t[1]<=n[1]&&t[3]>=n[1]?!0:qs(t,this.intersectsCoordinate.bind(this))}return!1}setCenter(t){const e=this.stride,n=this.flatCoordinates[e]-this.flatCoordinates[0],r=t.slice();r[e]=r[0]+n;for(let s=1;s<e;++s)r[e+s]=t[s];this.setFlatCoordinates(this.layout,r),this.changed()}setCenterAndRadius(t,e,n){this.setLayout(n,t,0),this.flatCoordinates||(this.flatCoordinates=[]);const r=this.flatCoordinates;let s=Fu(r,0,t,this.stride);r[s++]=r[0]+e;for(let o=1,a=this.stride;o<a;++o)r[s++]=r[o];r.length=s,this.changed()}getCoordinates(){return null}setCoordinates(t,e){}setRadius(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()}rotate(t,e){const n=this.getCenter(),r=this.getStride();this.setCenter(ro(n,0,n.length,r,t,e,n)),this.changed()}translate(t,e){const n=this.getCenter(),r=this.getStride();this.setCenter(Au(n,0,n.length,r,t,e,n)),this.changed()}}Gr.prototype.transform;const M0=Gr;function Ms(){return Ms=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},Ms.apply(this,arguments)}var pl={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function Mt(i){return typeof i=="number"}function ae(i){return!i||typeof i!="object"||typeof i.constructor!="function"?!1:i.isBigNumber===!0&&typeof i.constructor.prototype=="object"&&i.constructor.prototype.isBigNumber===!0||typeof i.constructor.isDecimal=="function"&&i.constructor.isDecimal(i)===!0}function vl(i){return i&&typeof i=="object"&&Object.getPrototypeOf(i).isComplex===!0||!1}function Dl(i){return i&&typeof i=="object"&&Object.getPrototypeOf(i).isFraction===!0||!1}function yl(i){return i&&i.constructor.prototype.isUnit===!0||!1}function Le(i){return typeof i=="string"}var Tt=Array.isArray;function Wt(i){return i&&i.constructor.prototype.isMatrix===!0||!1}function pr(i){return Array.isArray(i)||Wt(i)}function I0(i){return i&&i.isDenseMatrix&&i.constructor.prototype.isMatrix===!0||!1}function b0(i){return i&&i.isSparseMatrix&&i.constructor.prototype.isMatrix===!0||!1}function L0(i){return i&&i.constructor.prototype.isRange===!0||!1}function Io(i){return i&&i.constructor.prototype.isIndex===!0||!1}function N0(i){return typeof i=="boolean"}function O0(i){return i&&i.constructor.prototype.isResultSet===!0||!1}function P0(i){return i&&i.constructor.prototype.isHelp===!0||!1}function B0(i){return typeof i=="function"}function z0(i){return i instanceof Date}function k0(i){return i instanceof RegExp}function G0(i){return!!(i&&typeof i=="object"&&i.constructor===Object&&!vl(i)&&!Dl(i))}function X0(i){return i===null}function W0(i){return i===void 0}function Y0(i){return i&&i.isAccessorNode===!0&&i.constructor.prototype.isNode===!0||!1}function U0(i){return i&&i.isArrayNode===!0&&i.constructor.prototype.isNode===!0||!1}function Z0(i){return i&&i.isAssignmentNode===!0&&i.constructor.prototype.isNode===!0||!1}function V0(i){return i&&i.isBlockNode===!0&&i.constructor.prototype.isNode===!0||!1}function K0(i){return i&&i.isConditionalNode===!0&&i.constructor.prototype.isNode===!0||!1}function $0(i){return i&&i.isConstantNode===!0&&i.constructor.prototype.isNode===!0||!1}function q0(i){return i&&i.isFunctionAssignmentNode===!0&&i.constructor.prototype.isNode===!0||!1}function H0(i){return i&&i.isFunctionNode===!0&&i.constructor.prototype.isNode===!0||!1}function j0(i){return i&&i.isIndexNode===!0&&i.constructor.prototype.isNode===!0||!1}function J0(i){return i&&i.isNode===!0&&i.constructor.prototype.isNode===!0||!1}function Q0(i){return i&&i.isObjectNode===!0&&i.constructor.prototype.isNode===!0||!1}function tm(i){return i&&i.isOperatorNode===!0&&i.constructor.prototype.isNode===!0||!1}function em(i){return i&&i.isParenthesisNode===!0&&i.constructor.prototype.isNode===!0||!1}function nm(i){return i&&i.isRangeNode===!0&&i.constructor.prototype.isNode===!0||!1}function im(i){return i&&i.isRelationalNode===!0&&i.constructor.prototype.isNode===!0||!1}function rm(i){return i&&i.isSymbolNode===!0&&i.constructor.prototype.isNode===!0||!1}function sm(i){return i&&i.constructor.prototype.isChain===!0||!1}function Jn(i){var t=typeof i;return t==="object"?i===null?"null":ae(i)?"BigNumber":i.constructor&&i.constructor.name?i.constructor.name:"Object":t}function wt(i){var t=typeof i;if(t==="number"||t==="string"||t==="boolean"||i===null||i===void 0)return i;if(typeof i.clone=="function")return i.clone();if(Array.isArray(i))return i.map(function(e){return wt(e)});if(i instanceof Date)return new Date(i.valueOf());if(ae(i))return i;if(i instanceof RegExp)throw new TypeError("Cannot clone "+i);return om(i,wt)}function om(i,t){var e={};for(var n in i)bi(i,n)&&(e[n]=t(i[n]));return e}function am(i,t){for(var e in t)bi(t,e)&&(i[e]=t[e]);return i}function vr(i,t){var e,n,r;if(Array.isArray(i)){if(!Array.isArray(t)||i.length!==t.length)return!1;for(n=0,r=i.length;n<r;n++)if(!vr(i[n],t[n]))return!1;return!0}else{if(typeof i=="function")return i===t;if(i instanceof Object){if(Array.isArray(t)||!(t instanceof Object))return!1;for(e in i)if(!(e in t)||!vr(i[e],t[e]))return!1;for(e in t)if(!(e in i))return!1;return!0}else return i===t}}function bi(i,t){return i&&Object.hasOwnProperty.call(i,t)}function um(i,t){for(var e={},n=0;n<t.length;n++){var r=t[n],s=i[r];s!==void 0&&(e[r]=s)}return e}var lm=["Matrix","Array"],hm=["number","BigNumber","Fraction"],Xi=function(t){if(t)throw new Error(`The global config is readonly. 
Please create a mathjs instance if you want to change the default configuration. 
Example:

  import { create, all } from 'mathjs';
  const mathjs = create(all);
  mathjs.config({ number: 'BigNumber' });
`);return Object.freeze(pl)};Ms(Xi,pl,{MATRIX_OPTIONS:lm,NUMBER_OPTIONS:hm});function Fe(i,t){var e=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!e){if(Array.isArray(i)||(e=cm(i))||t&&i&&typeof i.length=="number"){e&&(i=e);var n=0,r=function(){};return{s:r,n:function(){return n>=i.length?{done:!0}:{done:!1,value:i[n++]}},e:function(c){throw c},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,a;return{s:function(){e=e.call(i)},n:function(){var c=e.next();return s=c.done,c},e:function(c){o=!0,a=c},f:function(){try{!s&&e.return!=null&&e.return()}finally{if(o)throw a}}}}function cm(i,t){if(i){if(typeof i=="string")return Na(i,t);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Na(i,t)}}function Na(i,t){(t==null||t>i.length)&&(t=i.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=i[e];return n}function Kn(i){return Kn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kn(i)}function Oa(){return!0}function ye(){return!1}function zn(){}var Pa="Argument is not a typed-function.";function El(){function i(x){return Kn(x)==="object"&&x!==null&&x.constructor===Object}var t=[{name:"number",test:function(S){return typeof S=="number"}},{name:"string",test:function(S){return typeof S=="string"}},{name:"boolean",test:function(S){return typeof S=="boolean"}},{name:"Function",test:function(S){return typeof S=="function"}},{name:"Array",test:Array.isArray},{name:"Date",test:function(S){return S instanceof Date}},{name:"RegExp",test:function(S){return S instanceof RegExp}},{name:"Object",test:i},{name:"null",test:function(S){return S===null}},{name:"undefined",test:function(S){return S===void 0}}],e={name:"any",test:Oa,isAny:!0},n,r,s=0,o={createCount:0};function a(x){var S=n.get(x);if(S)return S;var R='Unknown type "'+x+'"',P=x.toLowerCase(),W,Y=Fe(r),Z;try{for(Y.s();!(Z=Y.n()).done;)if(W=Z.value,W.toLowerCase()===P){R+='. Did you mean "'+W+'" ?';break}}catch(B){Y.e(B)}finally{Y.f()}throw new TypeError(R)}function u(x){for(var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"any",R=S?a(S).index:r.length,P=[],W=0;W<x.length;++W){if(!x[W]||typeof x[W].name!="string"||typeof x[W].test!="function")throw new TypeError("Object with properties {name: string, test: function} expected");var Y=x[W].name;if(n.has(Y))throw new TypeError('Duplicate type name "'+Y+'"');P.push(Y),n.set(Y,{name:Y,test:x[W].test,isAny:x[W].isAny,index:R+W,conversionsTo:[]})}var Z=r.slice(R);r=r.slice(0,R).concat(P).concat(Z);for(var B=R+P.length;B<r.length;++B)n.get(r[B]).index=B}function c(){n=new Map,r=[],s=0,u([e],!1)}c(),u(t);function l(){var x,S=Fe(r),R;try{for(S.s();!(R=S.n()).done;)x=R.value,n.get(x).conversionsTo=[]}catch(P){S.e(P)}finally{S.f()}s=0}function h(x){var S=r.filter(function(R){var P=n.get(R);return!P.isAny&&P.test(x)});return S.length?S:["any"]}function f(x){return x&&typeof x=="function"&&"_typedFunctionData"in x}function g(x,S,R){if(!f(x))throw new TypeError(Pa);var P=R&&R.exact,W=Array.isArray(S)?S.join(","):S,Y=y(W),Z=_(Y);if(!P||Z in x.signatures){var B=x._typedFunctionData.signatureMap.get(Z);if(B)return B}var G=Y.length,q;if(P){q=[];var ot;for(ot in x.signatures)q.push(x._typedFunctionData.signatureMap.get(ot))}else q=x._typedFunctionData.signatures;for(var K=0;K<G;++K){var Zt=Y[K],Pt=[],Bt=void 0,bt=Fe(q),Vt;try{for(bt.s();!(Vt=bt.n()).done;){Bt=Vt.value;var Ft=w(Bt.params,K);if(!(!Ft||Zt.restParam&&!Ft.restParam)){if(!Ft.hasAny){var Kt=function(){var yt=v(Ft);if(Zt.types.some(function(de){return!yt.has(de.name)}))return"continue"}();if(Kt==="continue")continue}Pt.push(Bt)}}}catch(yt){bt.e(yt)}finally{bt.f()}if(q=Pt,q.length===0)break}var Ot,$t=Fe(q),be;try{for($t.s();!(be=$t.n()).done;)if(Ot=be.value,Ot.params.length<=G)return Ot}catch(yt){$t.e(yt)}finally{$t.f()}throw new TypeError("Signature not found (signature: "+(x.name||"unnamed")+"("+_(Y,", ")+"))")}function m(x,S,R){return g(x,S,R).implementation}function d(x,S){var R=a(S);if(R.test(x))return x;var P=R.conversionsTo;if(P.length===0)throw new Error("There are no conversions to "+S+" defined.");for(var W=0;W<P.length;W++){var Y=a(P[W].from);if(Y.test(x))return P[W].convert(x)}throw new Error("Cannot convert "+x+" to "+S)}function _(x){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:",";return x.map(function(R){return R.name}).join(S)}function p(x){var S=x.indexOf("...")===0,R=S?x.length>3?x.slice(3):"any":x,P=R.split("|").map(function(B){return a(B.trim())}),W=!1,Y=S?"...":"",Z=P.map(function(B){return W=B.isAny||W,Y+=B.name+"|",{name:B.name,typeIndex:B.index,test:B.test,isAny:B.isAny,conversion:null,conversionIndex:-1}});return{types:Z,name:Y.slice(0,-1),hasAny:W,hasConversion:!1,restParam:S}}function D(x){var S=x.types.map(function(Z){return Z.name}),R=L(S),P=x.hasAny,W=x.name,Y=R.map(function(Z){var B=a(Z.from);return P=B.isAny||P,W+="|"+Z.from,{name:Z.from,typeIndex:B.index,test:B.test,isAny:B.isAny,conversion:Z,conversionIndex:Z.index}});return{types:x.types.concat(Y),name:W,hasAny:P,hasConversion:Y.length>0,restParam:x.restParam}}function v(x){return x.typeSet||(x.typeSet=new Set,x.types.forEach(function(S){return x.typeSet.add(S.name)})),x.typeSet}function y(x){var S=[];if(typeof x!="string")throw new TypeError("Signatures must be strings");var R=x.trim();if(R==="")return S;for(var P=R.split(","),W=0;W<P.length;++W){var Y=p(P[W].trim());if(Y.restParam&&W!==P.length-1)throw new SyntaxError('Unexpected rest parameter "'+P[W]+'": only allowed for the last parameter');if(Y.types.length===0)return null;S.push(Y)}return S}function E(x){var S=ut(x);return S?S.restParam:!1}function C(x){if(!x||x.types.length===0)return Oa;if(x.types.length===1)return a(x.types[0].name).test;if(x.types.length===2){var S=a(x.types[0].name).test,R=a(x.types[1].name).test;return function(Y){return S(Y)||R(Y)}}else{var P=x.types.map(function(W){return a(W.name).test});return function(Y){for(var Z=0;Z<P.length;Z++)if(P[Z](Y))return!0;return!1}}}function F(x){var S,R,P;if(E(x)){S=ft(x).map(C);var W=S.length,Y=C(ut(x)),Z=function(G){for(var q=W;q<G.length;q++)if(!Y(G[q]))return!1;return!0};return function(G){for(var q=0;q<S.length;q++)if(!S[q](G[q]))return!1;return Z(G)&&G.length>=W+1}}else return x.length===0?function(G){return G.length===0}:x.length===1?(R=C(x[0]),function(G){return R(G[0])&&G.length===1}):x.length===2?(R=C(x[0]),P=C(x[1]),function(G){return R(G[0])&&P(G[1])&&G.length===2}):(S=x.map(C),function(G){for(var q=0;q<S.length;q++)if(!S[q](G[q]))return!1;return G.length===S.length})}function w(x,S){return S<x.length?x[S]:E(x)?ut(x):null}function A(x,S){var R=w(x,S);return R?v(R):new Set}function T(x){return x.conversion===null||x.conversion===void 0}function I(x,S){var R=new Set;return x.forEach(function(P){var W=A(P.params,S),Y,Z=Fe(W),B;try{for(Z.s();!(B=Z.n()).done;)Y=B.value,R.add(Y)}catch(G){Z.e(G)}finally{Z.f()}}),R.has("any")?["any"]:Array.from(R)}function N(x,S,R){var P,W,Y=x||"unnamed",Z=R,B,G=function(){var bt=[];if(Z.forEach(function(Ft){var Kt=w(Ft.params,B),Ot=C(Kt);(B<Ft.params.length||E(Ft.params))&&Ot(S[B])&&bt.push(Ft)}),bt.length===0){if(W=I(Z,B),W.length>0){var Vt=h(S[B]);return P=new TypeError("Unexpected type of argument in function "+Y+" (expected: "+W.join(" or ")+", actual: "+Vt.join(" | ")+", index: "+B+")"),P.data={category:"wrongType",fn:Y,index:B,actual:Vt,expected:W},{v:P}}}else Z=bt};for(B=0;B<S.length;B++){var q=G();if(Kn(q)==="object")return q.v}var ot=Z.map(function(Bt){return E(Bt.params)?1/0:Bt.params.length});if(S.length<Math.min.apply(null,ot))return W=I(Z,B),P=new TypeError("Too few arguments in function "+Y+" (expected: "+W.join(" or ")+", index: "+S.length+")"),P.data={category:"tooFewArgs",fn:Y,index:S.length,expected:W},P;var K=Math.max.apply(null,ot);if(S.length>K)return P=new TypeError("Too many arguments in function "+Y+" (expected: "+K+", actual: "+S.length+")"),P.data={category:"tooManyArgs",fn:Y,index:S.length,expectedLength:K},P;for(var Zt=[],Pt=0;Pt<S.length;++Pt)Zt.push(h(S[Pt]).join("|"));return P=new TypeError('Arguments of type "'+Zt.join(", ")+'" do not match any of the defined signatures of function '+Y+"."),P.data={category:"mismatch",actual:Zt},P}function X(x){for(var S=r.length+1,R=0;R<x.types.length;R++)T(x.types[R])&&(S=Math.min(S,x.types[R].typeIndex));return S}function U(x){for(var S=s+1,R=0;R<x.types.length;R++)T(x.types[R])||(S=Math.min(S,x.types[R].conversionIndex));return S}function b(x,S){if(x.hasAny){if(!S.hasAny)return 1}else if(S.hasAny)return-1;if(x.restParam){if(!S.restParam)return 1}else if(S.restParam)return-1;if(x.hasConversion){if(!S.hasConversion)return 1}else if(S.hasConversion)return-1;var R=X(x)-X(S);if(R<0)return-1;if(R>0)return 1;var P=U(x)-U(S);return P<0?-1:P>0?1:0}function M(x,S){var R=x.params,P=S.params,W=ut(R),Y=ut(P),Z=E(R),B=E(P);if(Z&&W.hasAny){if(!B||!Y.hasAny)return 1}else if(B&&Y.hasAny)return-1;var G=0,q=0,ot,K=Fe(R),Zt;try{for(K.s();!(Zt=K.n()).done;)ot=Zt.value,ot.hasAny&&++G,ot.hasConversion&&++q}catch(le){K.e(le)}finally{K.f()}var Pt=0,Bt=0,bt=Fe(P),Vt;try{for(bt.s();!(Vt=bt.n()).done;)ot=Vt.value,ot.hasAny&&++Pt,ot.hasConversion&&++Bt}catch(le){bt.e(le)}finally{bt.f()}if(G!==Pt)return G-Pt;if(Z&&W.hasConversion){if(!B||!Y.hasConversion)return 1}else if(B&&Y.hasConversion)return-1;if(q!==Bt)return q-Bt;if(Z){if(!B)return 1}else if(B)return-1;var Ft=(R.length-P.length)*(Z?-1:1);if(Ft!==0)return Ft;for(var Kt=[],Ot=0,$t=0;$t<R.length;++$t){var be=b(R[$t],P[$t]);Kt.push(be),Ot+=be}if(Ot!==0)return Ot;for(var yt,de=0,Qt=Kt;de<Qt.length;de++)if(yt=Qt[de],yt!==0)return yt;return 0}function L(x){if(x.length===0)return[];var S=x.map(a);x.length>1&&S.sort(function(G,q){return G.index-q.index});var R=S[0].conversionsTo;if(x.length===1)return R;R=R.concat([]);for(var P=new Set(x),W=1;W<S.length;++W){var Y=void 0,Z=Fe(S[W].conversionsTo),B;try{for(Z.s();!(B=Z.n()).done;)Y=B.value,P.has(Y.from)||(R.push(Y),P.add(Y.from))}catch(G){Z.e(G)}finally{Z.f()}}return R}function k(x,S){var R=S;if(x.some(function(B){return B.hasConversion})){var P=E(x),W=x.map(V);R=function(){for(var G=[],q=P?arguments.length-1:arguments.length,ot=0;ot<q;ot++)G[ot]=W[ot](arguments[ot]);return P&&(G[q]=arguments[q].map(W[q])),S.apply(this,G)}}var Y=R;if(E(x)){var Z=x.length-1;Y=function(){return R.apply(this,ct(arguments,0,Z).concat([ct(arguments,Z)]))}}return Y}function V(x){var S,R,P,W,Y=[],Z=[];switch(x.types.forEach(function(B){B.conversion&&(Y.push(a(B.conversion.from).test),Z.push(B.conversion.convert))}),Z.length){case 0:return function(G){return G};case 1:return S=Y[0],P=Z[0],function(G){return S(G)?P(G):G};case 2:return S=Y[0],R=Y[1],P=Z[0],W=Z[1],function(G){return S(G)?P(G):R(G)?W(G):G};default:return function(G){for(var q=0;q<Z.length;q++)if(Y[q](G))return Z[q](G);return G}}}function $(x){function S(R,P,W){if(P<R.length){var Y=R[P],Z=[];if(Y.restParam){var B=Y.types.filter(T);B.length<Y.types.length&&Z.push({types:B,name:"..."+B.map(function(G){return G.name}).join("|"),hasAny:B.some(function(G){return G.isAny}),hasConversion:!1,restParam:!0}),Z.push(Y)}else Z=Y.types.map(function(G){return{types:[G],name:G.name,hasAny:G.isAny,hasConversion:G.conversion,restParam:!1}});return At(Z,function(G){return S(R,P+1,W.concat([G]))})}else return[W]}return S(x,0,[])}function tt(x,S){for(var R=Math.max(x.length,S.length),P=0;P<R;P++){var W=A(x,P),Y=A(S,P),Z=!1,B=void 0,G=Fe(Y),q;try{for(G.s();!(q=G.n()).done;)if(B=q.value,W.has(B)){Z=!0;break}}catch(Bt){G.e(Bt)}finally{G.f()}if(!Z)return!1}var ot=x.length,K=S.length,Zt=E(x),Pt=E(S);return Zt?Pt?ot===K:K>=ot:Pt?ot>=K:ot===K}function O(x){return x.map(function(S){return fe(S)?Yt(S.referToSelf.callback):Ut(S)?Et(S.referTo.references,S.referTo.callback):S})}function it(x,S,R){var P=[],W,Y=Fe(x),Z;try{for(Y.s();!(Z=Y.n()).done;){W=Z.value;var B=R[W];if(typeof B!="number")throw new TypeError('No definition for referenced signature "'+W+'"');if(B=S[B],typeof B!="function")return!1;P.push(B)}}catch(G){Y.e(G)}finally{Y.f()}return P}function J(x,S,R){for(var P=O(x),W=new Array(P.length).fill(!1),Y=!0;Y;){Y=!1;for(var Z=!0,B=0;B<P.length;++B)if(!W[B]){var G=P[B];if(fe(G))P[B]=G.referToSelf.callback(R),P[B].referToSelf=G.referToSelf,W[B]=!0,Z=!1;else if(Ut(G)){var q=it(G.referTo.references,P,S);q?(P[B]=G.referTo.callback.apply(this,q),P[B].referTo=G.referTo,W[B]=!0,Z=!1):Y=!0}}if(Z&&Y)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return P}function et(x){var S=/\bthis(\(|\.signatures\b)/;Object.keys(x).forEach(function(R){var P=x[R];if(S.test(P.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")})}function Dt(x,S){if(o.createCount++,Object.keys(S).length===0)throw new SyntaxError("No signatures provided");o.warnAgainstDeprecatedThis&&et(S);var R=[],P=[],W={},Y=[],Z,B=function(){if(!Object.prototype.hasOwnProperty.call(S,Z))return"continue";var te=y(Z);if(!te)return"continue";R.forEach(function(bn){if(tt(bn,te))throw new TypeError('Conflicting signatures "'+_(bn)+'" and "'+_(te)+'".')}),R.push(te);var ko=P.length;P.push(S[Z]);var Ah=te.map(D),Wi=void 0,Yi=Fe($(Ah)),Go;try{for(Yi.s();!(Go=Yi.n()).done;){Wi=Go.value;var Xo=_(Wi);Y.push({params:Wi,name:Xo,fn:ko}),Wi.every(function(bn){return!bn.hasConversion})&&(W[Xo]=ko)}}catch(bn){Yi.e(bn)}finally{Yi.f()}};for(Z in S)var G=B();Y.sort(M);var q=J(P,W,li),ot;for(ot in W)Object.prototype.hasOwnProperty.call(W,ot)&&(W[ot]=q[W[ot]]);for(var K=[],Zt=new Map,Pt=0,Bt=Y;Pt<Bt.length;Pt++)ot=Bt[Pt],Zt.has(ot.name)||(ot.fn=q[ot.fn],K.push(ot),Zt.set(ot.name,ot));for(var bt=K[0]&&K[0].params.length<=2&&!E(K[0].params),Vt=K[1]&&K[1].params.length<=2&&!E(K[1].params),Ft=K[2]&&K[2].params.length<=2&&!E(K[2].params),Kt=K[3]&&K[3].params.length<=2&&!E(K[3].params),Ot=K[4]&&K[4].params.length<=2&&!E(K[4].params),$t=K[5]&&K[5].params.length<=2&&!E(K[5].params),be=bt&&Vt&&Ft&&Kt&&Ot&&$t,yt=0;yt<K.length;++yt)K[yt].test=F(K[yt].params);for(var de=bt?C(K[0].params[0]):ye,Qt=Vt?C(K[1].params[0]):ye,le=Ft?C(K[2].params[0]):ye,he=Kt?C(K[3].params[0]):ye,Mn=Ot?C(K[4].params[0]):ye,In=$t?C(K[5].params[0]):ye,ie=bt?C(K[0].params[1]):ye,ge=Vt?C(K[1].params[1]):ye,we=Ft?C(K[2].params[1]):ye,$r=Kt?C(K[3].params[1]):ye,oh=Ot?C(K[4].params[1]):ye,ah=$t?C(K[5].params[1]):ye,ui=0;ui<K.length;++ui)K[ui].implementation=k(K[ui].params,K[ui].fn);var uh=bt?K[0].implementation:zn,lh=Vt?K[1].implementation:zn,hh=Ft?K[2].implementation:zn,ch=Kt?K[3].implementation:zn,fh=Ot?K[4].implementation:zn,dh=$t?K[5].implementation:zn,gh=bt?K[0].params.length:-1,mh=Vt?K[1].params.length:-1,_h=Ft?K[2].params.length:-1,ph=Kt?K[3].params.length:-1,vh=Ot?K[4].params.length:-1,Dh=$t?K[5].params.length:-1,yh=be?6:0,Eh=K.length,Ch=K.map(function(pe){return pe.test}),wh=K.map(function(pe){return pe.implementation}),xh=function(){for(var te=yh;te<Eh;te++)if(Ch[te](arguments))return wh[te].apply(this,arguments);return o.onMismatch(x,arguments,K)};function li(pe,te){return arguments.length===gh&&de(pe)&&ie(te)?uh.apply(this,arguments):arguments.length===mh&&Qt(pe)&&ge(te)?lh.apply(this,arguments):arguments.length===_h&&le(pe)&&we(te)?hh.apply(this,arguments):arguments.length===ph&&he(pe)&&$r(te)?ch.apply(this,arguments):arguments.length===vh&&Mn(pe)&&oh(te)?fh.apply(this,arguments):arguments.length===Dh&&In(pe)&&ah(te)?dh.apply(this,arguments):xh.apply(this,arguments)}try{Object.defineProperty(li,"name",{value:x})}catch{}return li.signatures=W,li._typedFunctionData={signatures:K,signatureMap:Zt},li}function ht(x,S,R){throw N(x,S,R)}function ft(x){return ct(x,0,x.length-1)}function ut(x){return x[x.length-1]}function ct(x,S,R){return Array.prototype.slice.call(x,S,R)}function jt(x,S){for(var R=0;R<x.length;R++)if(S(x[R]))return x[R]}function At(x,S){return Array.prototype.concat.apply([],x.map(S))}function dt(){var x=ft(arguments).map(function(R){return _(y(R))}),S=ut(arguments);if(typeof S!="function")throw new TypeError("Callback function expected as last argument");return Et(x,S)}function Et(x,S){return{referTo:{references:x,callback:S}}}function Yt(x){if(typeof x!="function")throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:x}}}function Ut(x){return x&&Kn(x.referTo)==="object"&&Array.isArray(x.referTo.references)&&typeof x.referTo.callback=="function"}function fe(x){return x&&Kn(x.referToSelf)==="object"&&typeof x.referToSelf.callback=="function"}function Ee(x,S){if(!x)return S;if(S&&S!==x){var R=new Error("Function names do not match (expected: "+x+", actual: "+S+")");throw R.data={actual:S,expected:x},R}return x}function Ce(x){var S;for(var R in x)Object.prototype.hasOwnProperty.call(x,R)&&(f(x[R])||typeof x[R].signature=="string")&&(S=Ee(S,x[R].name));return S}function Ie(x,S){var R;for(R in S)if(Object.prototype.hasOwnProperty.call(S,R)){if(R in x&&S[R]!==x[R]){var P=new Error('Signature "'+R+'" is defined twice');throw P.data={signature:R,sourceFunction:S[R],destFunction:x[R]},P}x[R]=S[R]}}var ai=o;o=function(S){for(var R=typeof S=="string",P=R?1:0,W=R?S:"",Y={},Z=P;Z<arguments.length;++Z){var B=arguments[Z],G={},q=void 0;if(typeof B=="function"?(q=B.name,typeof B.signature=="string"?G[B.signature]=B:f(B)&&(G=B.signatures)):i(B)&&(G=B,R||(q=Ce(B))),Object.keys(G).length===0){var ot=new TypeError("Argument to 'typed' at index "+Z+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw ot.data={index:Z,argument:B},ot}R||(W=Ee(W,q)),Ie(Y,G)}return Dt(W||"",Y)},o.create=El,o.createCount=ai.createCount,o.onMismatch=ht,o.throwMismatchError=ht,o.createError=N,o.clear=c,o.clearConversions=l,o.addTypes=u,o._findType=a,o.referTo=dt,o.referToSelf=Yt,o.convert=d,o.findSignature=g,o.find=m,o.isTypedFunction=f,o.warnAgainstDeprecatedThis=!0,o.addType=function(x,S){var R="any";S!==!1&&n.has("Object")&&(R="Object"),o.addTypes([x],R)};function Jt(x){if(!x||typeof x.from!="string"||typeof x.to!="string"||typeof x.convert!="function")throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(x.to===x.from)throw new SyntaxError('Illegal to define conversion from "'+x.from+'" to itself.')}return o.addConversion=function(x){Jt(x);var S=a(x.to);if(S.conversionsTo.every(function(R){return R.from!==x.from}))S.conversionsTo.push({from:x.from,convert:x.convert,index:s++});else throw new Error('There is already a conversion from "'+x.from+'" to "'+S.name+'"')},o.addConversions=function(x){x.forEach(o.addConversion)},o.removeConversion=function(x){Jt(x);var S=a(x.to),R=jt(S.conversionsTo,function(W){return W.from===x.from});if(!R)throw new Error("Attempt to remove nonexistent conversion from "+x.from+" to "+x.to);if(R.convert!==x.convert)throw new Error("Conversion to remove does not match existing conversion");var P=S.conversionsTo.indexOf(R);S.conversionsTo.splice(P,1)},o.resolve=function(x,S){if(!f(x))throw new TypeError(Pa);for(var R=x._typedFunctionData.signatures,P=0;P<R.length;++P)if(R[P].test(S))return R[P];return null},o}const Ba=El();function zt(i){return typeof i=="boolean"?!0:isFinite(i)?i===Math.round(i):!1}function ls(i,t,e){var n={2:"0b",8:"0o",16:"0x"},r=n[t],s="";if(e){if(e<1)throw new Error("size must be in greater than 0");if(!zt(e))throw new Error("size must be an integer");if(i>2**(e-1)-1||i<-(2**(e-1)))throw new Error("Value must be in range [-2^".concat(e-1,", 2^").concat(e-1,"-1]"));if(!zt(i))throw new Error("Value must be an integer");i<0&&(i=i+2**e),s="i".concat(e)}var o="";return i<0&&(i=-i,o="-"),"".concat(o).concat(r).concat(i.toString(t)).concat(s)}function Is(i,t){if(typeof t=="function")return t(i);if(i===1/0)return"Infinity";if(i===-1/0)return"-Infinity";if(isNaN(i))return"NaN";var e="auto",n,r;if(t&&(t.notation&&(e=t.notation),Mt(t)?n=t:Mt(t.precision)&&(n=t.precision),t.wordSize&&(r=t.wordSize,typeof r!="number")))throw new Error('Option "wordSize" must be a number');switch(e){case"fixed":return dm(i,n);case"exponential":return Cl(i,n);case"engineering":return fm(i,n);case"bin":return ls(i,2,r);case"oct":return ls(i,8,r);case"hex":return ls(i,16,r);case"auto":return gm(i,n,t&&t).replace(/((\.\d*?)(0+))($|e)/,function(){var s=arguments[2],o=arguments[4];return s!=="."?s+o:o});default:throw new Error('Unknown notation "'+e+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function Xr(i){var t=String(i).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!t)throw new SyntaxError("Invalid number "+i);var e=t[1],n=t[2],r=parseFloat(t[4]||"0"),s=n.indexOf(".");r+=s!==-1?s-1:n.length-1;var o=n.replace(".","").replace(/^0*/,function(a){return r-=a.length,""}).replace(/0*$/,"").split("").map(function(a){return parseInt(a)});return o.length===0&&(o.push(0),r++),{sign:e,coefficients:o,exponent:r}}function fm(i,t){if(isNaN(i)||!isFinite(i))return String(i);var e=Xr(i),n=Wr(e,t),r=n.exponent,s=n.coefficients,o=r%3===0?r:r<0?r-3-r%3:r-r%3;if(Mt(t))for(;t>s.length||r-o+1>s.length;)s.push(0);else for(var a=Math.abs(r-o)-(s.length-1),u=0;u<a;u++)s.push(0);for(var c=Math.abs(r-o),l=1;c>0;)l++,c--;var h=s.slice(l).join(""),f=Mt(t)&&h.length||h.match(/[1-9]/)?"."+h:"",g=s.slice(0,l).join("")+f+"e"+(r>=0?"+":"")+o.toString();return n.sign+g}function dm(i,t){if(isNaN(i)||!isFinite(i))return String(i);var e=Xr(i),n=typeof t=="number"?Wr(e,e.exponent+1+t):e,r=n.coefficients,s=n.exponent+1,o=s+(t||0);return r.length<o&&(r=r.concat(Qn(o-r.length))),s<0&&(r=Qn(-s+1).concat(r),s=1),s<r.length&&r.splice(s,0,s===0?"0.":"."),n.sign+r.join("")}function Cl(i,t){if(isNaN(i)||!isFinite(i))return String(i);var e=Xr(i),n=t?Wr(e,t):e,r=n.coefficients,s=n.exponent;r.length<t&&(r=r.concat(Qn(t-r.length)));var o=r.shift();return n.sign+o+(r.length>0?"."+r.join(""):"")+"e"+(s>=0?"+":"")+s}function gm(i,t,e){if(isNaN(i)||!isFinite(i))return String(i);var n=e&&e.lowerExp!==void 0?e.lowerExp:-3,r=e&&e.upperExp!==void 0?e.upperExp:5,s=Xr(i),o=t?Wr(s,t):s;if(o.exponent<n||o.exponent>=r)return Cl(i,t);var a=o.coefficients,u=o.exponent;a.length<t&&(a=a.concat(Qn(t-a.length))),a=a.concat(Qn(u-a.length+1+(a.length<t?t-a.length:0))),a=Qn(-u).concat(a);var c=u>0?u:0;return c<a.length-1&&a.splice(c+1,0,"."),o.sign+a.join("")}function Wr(i,t){for(var e={sign:i.sign,coefficients:i.coefficients,exponent:i.exponent},n=e.coefficients;t<=0;)n.unshift(0),e.exponent++,t++;if(n.length>t){var r=n.splice(t,n.length-t);if(r[0]>=5){var s=t-1;for(n[s]++;n[s]===10;)n.pop(),s===0&&(n.unshift(0),e.exponent++,s++),s--,n[s]++}}return e}function Qn(i){for(var t=[],e=0;e<i;e++)t.push(0);return t}function mm(i){return i.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}var _m=Number.EPSILON||2220446049250313e-31;function Dr(i,t,e){if(e==null)return i===t;if(i===t)return!0;if(isNaN(i)||isNaN(t))return!1;if(isFinite(i)&&isFinite(t)){var n=Math.abs(i-t);return n<_m?!0:n<=Math.max(Math.abs(i),Math.abs(t))*e}return!1}function hs(i,t,e){var n=i.constructor,r=new n(2),s="";if(e){if(e<1)throw new Error("size must be in greater than 0");if(!zt(e))throw new Error("size must be an integer");if(i.greaterThan(r.pow(e-1).sub(1))||i.lessThan(r.pow(e-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(e-1,", 2^").concat(e-1,"-1]"));if(!i.isInteger())throw new Error("Value must be an integer");i.lessThan(0)&&(i=i.add(r.pow(e))),s="i".concat(e)}switch(t){case 2:return"".concat(i.toBinary()).concat(s);case 8:return"".concat(i.toOctal()).concat(s);case 16:return"".concat(i.toHexadecimal()).concat(s);default:throw new Error("Base ".concat(t," not supported "))}}function pm(i,t){if(typeof t=="function")return t(i);if(!i.isFinite())return i.isNaN()?"NaN":i.gt(0)?"Infinity":"-Infinity";var e="auto",n,r;if(t!==void 0&&(t.notation&&(e=t.notation),typeof t=="number"?n=t:t.precision&&(n=t.precision),t.wordSize&&(r=t.wordSize,typeof r!="number")))throw new Error('Option "wordSize" must be a number');switch(e){case"fixed":return Dm(i,n);case"exponential":return za(i,n);case"engineering":return vm(i,n);case"bin":return hs(i,2,r);case"oct":return hs(i,8,r);case"hex":return hs(i,16,r);case"auto":{var s=t&&t.lowerExp!==void 0?t.lowerExp:-3,o=t&&t.upperExp!==void 0?t.upperExp:5;if(i.isZero())return"0";var a,u=i.toSignificantDigits(n),c=u.e;return c>=s&&c<o?a=u.toFixed():a=za(i,n),a.replace(/((\.\d*?)(0+))($|e)/,function(){var l=arguments[2],h=arguments[4];return l!=="."?l+h:h})}default:throw new Error('Unknown notation "'+e+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function vm(i,t){var e=i.e,n=e%3===0?e:e<0?e-3-e%3:e-e%3,r=i.mul(Math.pow(10,-n)),s=r.toPrecision(t);return s.indexOf("e")!==-1&&(s=r.toString()),s+"e"+(e>=0?"+":"")+n.toString()}function za(i,t){return t!==void 0?i.toExponential(t-1):i.toExponential()}function Dm(i,t){return i.toFixed(t)}function Nt(i,t){var e=ym(i,t);return t&&typeof t=="object"&&"truncate"in t&&e.length>t.truncate?e.substring(0,t.truncate-3)+"...":e}function ym(i,t){if(typeof i=="number")return Is(i,t);if(ae(i))return pm(i,t);if(Em(i))return!t||t.fraction!=="decimal"?i.s*i.n+"/"+i.d:i.toString();if(Array.isArray(i))return wl(i,t);if(Le(i))return'"'+i+'"';if(typeof i=="function")return i.syntax?String(i.syntax):"function";if(i&&typeof i=="object"){if(typeof i.format=="function")return i.format(t);if(i&&i.toString(t)!=={}.toString())return i.toString(t);var e=Object.keys(i).map(n=>'"'+n+'": '+Nt(i[n],t));return"{"+e.join(", ")+"}"}return String(i)}function wl(i,t){if(Array.isArray(i)){for(var e="[",n=i.length,r=0;r<n;r++)r!==0&&(e+=", "),e+=wl(i[r],t);return e+="]",e}else return Nt(i,t)}function Em(i){return i&&typeof i=="object"&&typeof i.s=="number"&&typeof i.n=="number"&&typeof i.d=="number"||!1}function vt(i,t,e){if(!(this instanceof vt))throw new SyntaxError("Constructor must be called with the new operator");this.actual=i,this.expected=t,this.relation=e,this.message="Dimension mismatch ("+(Array.isArray(i)?"["+i.join(", ")+"]":i)+" "+(this.relation||"!=")+" "+(Array.isArray(t)?"["+t.join(", ")+"]":t)+")",this.stack=new Error().stack}vt.prototype=new RangeError;vt.prototype.constructor=RangeError;vt.prototype.name="DimensionError";vt.prototype.isDimensionError=!0;function Rn(i,t,e){if(!(this instanceof Rn))throw new SyntaxError("Constructor must be called with the new operator");this.index=i,arguments.length<3?(this.min=0,this.max=t):(this.min=t,this.max=e),this.min!==void 0&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":this.max!==void 0&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=new Error().stack}Rn.prototype=new RangeError;Rn.prototype.constructor=RangeError;Rn.prototype.name="IndexError";Rn.prototype.isIndexError=!0;function He(i){for(var t=[];Array.isArray(i);)t.push(i.length),i=i[0];return t}function xl(i,t,e){var n,r=i.length;if(r!==t[e])throw new vt(r,t[e]);if(e<t.length-1){var s=e+1;for(n=0;n<r;n++){var o=i[n];if(!Array.isArray(o))throw new vt(t.length-1,t.length,"<");xl(i[n],t,s)}}else for(n=0;n<r;n++)if(Array.isArray(i[n]))throw new vt(t.length+1,t.length,">")}function ka(i,t){var e=t.length===0;if(e){if(Array.isArray(i))throw new vt(i.length,0)}else xl(i,t,0)}function Rt(i,t){if(!Mt(i)||!zt(i))throw new TypeError("Index must be an integer (value: "+i+")");if(i<0||typeof t=="number"&&i>=t)throw new Rn(i,t)}function bs(i,t,e){if(!Array.isArray(i)||!Array.isArray(t))throw new TypeError("Array expected");if(t.length===0)throw new Error("Resizing to scalar is not supported");t.forEach(function(r){if(!Mt(r)||!zt(r)||r<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Nt(t)+")")});var n=e!==void 0?e:0;return Ls(i,t,0,n),i}function Ls(i,t,e,n){var r,s,o=i.length,a=t[e],u=Math.min(o,a);if(i.length=a,e<t.length-1){var c=e+1;for(r=0;r<u;r++)s=i[r],Array.isArray(s)||(s=[s],i[r]=s),Ls(s,t,c,n);for(r=u;r<a;r++)s=[],i[r]=s,Ls(s,t,c,n)}else{for(r=0;r<u;r++)for(;Array.isArray(i[r]);)i[r]=i[r][0];for(r=u;r<a;r++)i[r]=n}}function Cm(i,t){var e=xm(i),n=e.length;if(!Array.isArray(i)||!Array.isArray(t))throw new TypeError("Array expected");if(t.length===0)throw new vt(0,n,"!=");t=bo(t,n);var r=Al(t);if(n!==r)throw new vt(r,n,"!=");try{return wm(e,t)}catch(s){throw s instanceof vt?new vt(r,n,"!="):s}}function bo(i,t){var e=Al(i),n=i.slice(),r=-1,s=i.indexOf(r),o=i.indexOf(r,s+1)>=0;if(o)throw new Error("More than one wildcard in sizes");var a=s>=0,u=t%e===0;if(a)if(u)n[s]=-t/e;else throw new Error("Could not replace wildcard, since "+t+" is no multiple of "+-e);return n}function Al(i){return i.reduce((t,e)=>t*e,1)}function wm(i,t){for(var e=i,n,r=t.length-1;r>0;r--){var s=t[r];n=[];for(var o=e.length/s,a=0;a<o;a++)n.push(e.slice(a*s,(a+1)*s));e=n}return e}function Fl(i,t,e,n){var r=n||He(i);if(e)for(var s=0;s<e;s++)i=[i],r.unshift(1);for(i=Sl(i,t,0);r.length<t;)r.push(1);return i}function Sl(i,t,e){var n,r;if(Array.isArray(i)){var s=e+1;for(n=0,r=i.length;n<r;n++)i[n]=Sl(i[n],t,s)}else for(var o=e;o<t;o++)i=[i];return i}function xm(i){if(!Array.isArray(i))return i;var t=[];return i.forEach(function e(n){Array.isArray(n)?n.forEach(e):t.push(n)}),t}function yr(i,t){for(var e,n=0,r=0;r<i.length;r++){var s=i[r],o=Array.isArray(s);if(r===0&&o&&(n=s.length),o&&s.length!==n)return;var a=o?yr(s,t):t(s);if(e===void 0)e=a;else if(e!==a)return"mixed"}return e}function st(i,t,e,n){function r(s){var o=um(s,t.map(Sm));return Am(i,t,s),e(o)}return r.isFactory=!0,r.fn=i,r.dependencies=t.slice().sort(),n&&(r.meta=n),r}function Am(i,t,e){var n=t.filter(s=>!Fm(s)).every(s=>e[s]!==void 0);if(!n){var r=t.filter(s=>e[s]===void 0);throw new Error('Cannot create function "'.concat(i,'", ')+"some dependencies are missing: ".concat(r.map(s=>'"'.concat(s,'"')).join(", "),"."))}}function Fm(i){return i&&i[0]==="?"}function Sm(i){return i&&i[0]==="?"?i.slice(1):i}function Tm(i,t){if(Rl(i)&&Tl(i,t))return i[t];throw typeof i[t]=="function"&&Im(i,t)?new Error('Cannot access method "'+t+'" as a property'):new Error('No access to property "'+t+'"')}function Rm(i,t,e){if(Rl(i)&&Tl(i,t))return i[t]=e,e;throw new Error('No access to property "'+t+'"')}function Mm(i,t){return t in i}function Tl(i,t){return!i||typeof i!="object"?!1:bi(bm,t)?!0:!(t in Object.prototype||t in Function.prototype)}function Im(i,t){return i==null||typeof i[t]!="function"||bi(i,t)&&Object.getPrototypeOf&&t in Object.getPrototypeOf(i)?!1:bi(Lm,t)?!0:!(t in Object.prototype||t in Function.prototype)}function Rl(i){return typeof i=="object"&&i&&i.constructor===Object}var bm={length:!0,name:!0},Lm={toString:!0,valueOf:!0,toLocaleString:!0};class Nm{constructor(t){this.wrappedObject=t}keys(){return Object.keys(this.wrappedObject)}get(t){return Tm(this.wrappedObject,t)}set(t,e){return Rm(this.wrappedObject,t,e),this}has(t){return Mm(this.wrappedObject,t)}}function Om(i){return i?i instanceof Map||i instanceof Nm||typeof i.set=="function"&&typeof i.get=="function"&&typeof i.keys=="function"&&typeof i.has=="function":!1}var Ml=function(){return Ml=Ba.create,Ba},Pm=["?BigNumber","?Complex","?DenseMatrix","?Fraction"],Bm=st("typed",Pm,function(t){var{BigNumber:e,Complex:n,DenseMatrix:r,Fraction:s}=t,o=Ml();return o.clear(),o.addTypes([{name:"number",test:Mt},{name:"Complex",test:vl},{name:"BigNumber",test:ae},{name:"Fraction",test:Dl},{name:"Unit",test:yl},{name:"identifier",test:a=>Le&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(a)},{name:"string",test:Le},{name:"Chain",test:sm},{name:"Array",test:Tt},{name:"Matrix",test:Wt},{name:"DenseMatrix",test:I0},{name:"SparseMatrix",test:b0},{name:"Range",test:L0},{name:"Index",test:Io},{name:"boolean",test:N0},{name:"ResultSet",test:O0},{name:"Help",test:P0},{name:"function",test:B0},{name:"Date",test:z0},{name:"RegExp",test:k0},{name:"null",test:X0},{name:"undefined",test:W0},{name:"AccessorNode",test:Y0},{name:"ArrayNode",test:U0},{name:"AssignmentNode",test:Z0},{name:"BlockNode",test:V0},{name:"ConditionalNode",test:K0},{name:"ConstantNode",test:$0},{name:"FunctionNode",test:H0},{name:"FunctionAssignmentNode",test:q0},{name:"IndexNode",test:j0},{name:"Node",test:J0},{name:"ObjectNode",test:Q0},{name:"OperatorNode",test:tm},{name:"ParenthesisNode",test:em},{name:"RangeNode",test:nm},{name:"RelationalNode",test:im},{name:"SymbolNode",test:rm},{name:"Map",test:Om},{name:"Object",test:G0}]),o.addConversions([{from:"number",to:"BigNumber",convert:function(u){if(e||cs(u),mm(u)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+u+"). Use function bignumber(x) to convert to BigNumber.");return new e(u)}},{from:"number",to:"Complex",convert:function(u){return n||er(u),new n(u,0)}},{from:"BigNumber",to:"Complex",convert:function(u){return n||er(u),new n(u.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(u){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(u){return n||er(u),new n(u.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(u){s||fs(u);var c=new s(u);if(c.valueOf()!==u)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+u+"). Use function fraction(x) to convert to Fraction.");return c}},{from:"string",to:"number",convert:function(u){var c=Number(u);if(isNaN(c))throw new Error('Cannot convert "'+u+'" to a number');return c}},{from:"string",to:"BigNumber",convert:function(u){e||cs(u);try{return new e(u)}catch{throw new Error('Cannot convert "'+u+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(u){s||fs(u);try{return new s(u)}catch{throw new Error('Cannot convert "'+u+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(u){n||er(u);try{return new n(u)}catch{throw new Error('Cannot convert "'+u+'" to Complex')}}},{from:"boolean",to:"number",convert:function(u){return+u}},{from:"boolean",to:"BigNumber",convert:function(u){return e||cs(u),new e(+u)}},{from:"boolean",to:"Fraction",convert:function(u){return s||fs(u),new s(+u)}},{from:"boolean",to:"string",convert:function(u){return String(u)}},{from:"Array",to:"Matrix",convert:function(u){return r||zm(),new r(u)}},{from:"Matrix",to:"Array",convert:function(u){return u.valueOf()}}]),o.onMismatch=(a,u,c)=>{var l=o.createError(a,u,c);if(["wrongType","mismatch"].includes(l.data.category)&&u.length===1&&pr(u[0])&&c.some(f=>!f.params.includes(","))){var h=new TypeError("Function '".concat(a,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(a,")'."));throw h.data=l.data,h}throw l},o.onMismatch=(a,u,c)=>{var l=o.createError(a,u,c);if(["wrongType","mismatch"].includes(l.data.category)&&u.length===1&&pr(u[0])&&c.some(f=>!f.params.includes(","))){var h=new TypeError("Function '".concat(a,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(a,")'."));throw h.data=l.data,h}throw l},o});function cs(i){throw new Error("Cannot convert value ".concat(i," into a BigNumber: no class 'BigNumber' provided"))}function er(i){throw new Error("Cannot convert value ".concat(i," into a Complex number: no class 'Complex' provided"))}function zm(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}function fs(i){throw new Error("Cannot convert value ".concat(i," into a Fraction, no class 'Fraction' provided."))}/*!
 *  decimal.js v10.4.3
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var $n=9e15,_n=1e9,Ns="0123456789abcdef",Er="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Cr="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Os={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-$n,maxE:$n,crypto:!1},Il,$e,rt=!0,Yr="[DecimalError] ",gn=Yr+"Invalid argument: ",bl=Yr+"Precision limit exceeded",Ll=Yr+"crypto unavailable",Nl="[object Decimal]",ue=Math.floor,Gt=Math.pow,km=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Gm=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Xm=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Ol=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Te=1e7,Q=7,Wm=9007199254740991,Ym=Er.length-1,Ps=Cr.length-1,z={toStringTag:Nl};z.absoluteValue=z.abs=function(){var i=new this.constructor(this);return i.s<0&&(i.s=1),H(i)};z.ceil=function(){return H(new this.constructor(this),this.e+1,2)};z.clampedTo=z.clamp=function(i,t){var e,n=this,r=n.constructor;if(i=new r(i),t=new r(t),!i.s||!t.s)return new r(NaN);if(i.gt(t))throw Error(gn+t);return e=n.cmp(i),e<0?i:n.cmp(t)>0?t:new r(n)};z.comparedTo=z.cmp=function(i){var t,e,n,r,s=this,o=s.d,a=(i=new s.constructor(i)).d,u=s.s,c=i.s;if(!o||!a)return!u||!c?NaN:u!==c?u:o===a?0:!o^u<0?1:-1;if(!o[0]||!a[0])return o[0]?u:a[0]?-c:0;if(u!==c)return u;if(s.e!==i.e)return s.e>i.e^u<0?1:-1;for(n=o.length,r=a.length,t=0,e=n<r?n:r;t<e;++t)if(o[t]!==a[t])return o[t]>a[t]^u<0?1:-1;return n===r?0:n>r^u<0?1:-1};z.cosine=z.cos=function(){var i,t,e=this,n=e.constructor;return e.d?e.d[0]?(i=n.precision,t=n.rounding,n.precision=i+Math.max(e.e,e.sd())+Q,n.rounding=1,e=Um(n,Gl(n,e)),n.precision=i,n.rounding=t,H($e==2||$e==3?e.neg():e,i,t,!0)):new n(1):new n(NaN)};z.cubeRoot=z.cbrt=function(){var i,t,e,n,r,s,o,a,u,c,l=this,h=l.constructor;if(!l.isFinite()||l.isZero())return new h(l);for(rt=!1,s=l.s*Gt(l.s*l,1/3),!s||Math.abs(s)==1/0?(e=ne(l.d),i=l.e,(s=(i-e.length+1)%3)&&(e+=s==1||s==-2?"0":"00"),s=Gt(e,1/3),i=ue((i+1)/3)-(i%3==(i<0?-1:2)),s==1/0?e="5e"+i:(e=s.toExponential(),e=e.slice(0,e.indexOf("e")+1)+i),n=new h(e),n.s=l.s):n=new h(s.toString()),o=(i=h.precision)+3;;)if(a=n,u=a.times(a).times(a),c=u.plus(l),n=Ct(c.plus(l).times(a),c.plus(u),o+2,1),ne(a.d).slice(0,o)===(e=ne(n.d)).slice(0,o))if(e=e.slice(o-3,o+1),e=="9999"||!r&&e=="4999"){if(!r&&(H(a,i+1,0),a.times(a).times(a).eq(l))){n=a;break}o+=4,r=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(H(n,i+1,1),t=!n.times(n).times(n).eq(l));break}return rt=!0,H(n,i,h.rounding,t)};z.decimalPlaces=z.dp=function(){var i,t=this.d,e=NaN;if(t){if(i=t.length-1,e=(i-ue(this.e/Q))*Q,i=t[i],i)for(;i%10==0;i/=10)e--;e<0&&(e=0)}return e};z.dividedBy=z.div=function(i){return Ct(this,new this.constructor(i))};z.dividedToIntegerBy=z.divToInt=function(i){var t=this,e=t.constructor;return H(Ct(t,new e(i),0,1,1),e.precision,e.rounding)};z.equals=z.eq=function(i){return this.cmp(i)===0};z.floor=function(){return H(new this.constructor(this),this.e+1,3)};z.greaterThan=z.gt=function(i){return this.cmp(i)>0};z.greaterThanOrEqualTo=z.gte=function(i){var t=this.cmp(i);return t==1||t===0};z.hyperbolicCosine=z.cosh=function(){var i,t,e,n,r,s=this,o=s.constructor,a=new o(1);if(!s.isFinite())return new o(s.s?1/0:NaN);if(s.isZero())return a;e=o.precision,n=o.rounding,o.precision=e+Math.max(s.e,s.sd())+4,o.rounding=1,r=s.d.length,r<32?(i=Math.ceil(r/3),t=(1/Zr(4,i)).toString()):(i=16,t="2.3283064365386962890625e-10"),s=ri(o,1,s.times(t),new o(1),!0);for(var u,c=i,l=new o(8);c--;)u=s.times(s),s=a.minus(u.times(l.minus(u.times(l))));return H(s,o.precision=e,o.rounding=n,!0)};z.hyperbolicSine=z.sinh=function(){var i,t,e,n,r=this,s=r.constructor;if(!r.isFinite()||r.isZero())return new s(r);if(t=s.precision,e=s.rounding,s.precision=t+Math.max(r.e,r.sd())+4,s.rounding=1,n=r.d.length,n<3)r=ri(s,2,r,r,!0);else{i=1.4*Math.sqrt(n),i=i>16?16:i|0,r=r.times(1/Zr(5,i)),r=ri(s,2,r,r,!0);for(var o,a=new s(5),u=new s(16),c=new s(20);i--;)o=r.times(r),r=r.times(a.plus(o.times(u.times(o).plus(c))))}return s.precision=t,s.rounding=e,H(r,t,e,!0)};z.hyperbolicTangent=z.tanh=function(){var i,t,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(i=n.precision,t=n.rounding,n.precision=i+7,n.rounding=1,Ct(e.sinh(),e.cosh(),n.precision=i,n.rounding=t)):new n(e.s)};z.inverseCosine=z.acos=function(){var i,t=this,e=t.constructor,n=t.abs().cmp(1),r=e.precision,s=e.rounding;return n!==-1?n===0?t.isNeg()?Se(e,r,s):new e(0):new e(NaN):t.isZero()?Se(e,r+4,s).times(.5):(e.precision=r+6,e.rounding=1,t=t.asin(),i=Se(e,r+4,s).times(.5),e.precision=r,e.rounding=s,i.minus(t))};z.inverseHyperbolicCosine=z.acosh=function(){var i,t,e=this,n=e.constructor;return e.lte(1)?new n(e.eq(1)?0:NaN):e.isFinite()?(i=n.precision,t=n.rounding,n.precision=i+Math.max(Math.abs(e.e),e.sd())+4,n.rounding=1,rt=!1,e=e.times(e).minus(1).sqrt().plus(e),rt=!0,n.precision=i,n.rounding=t,e.ln()):new n(e)};z.inverseHyperbolicSine=z.asinh=function(){var i,t,e=this,n=e.constructor;return!e.isFinite()||e.isZero()?new n(e):(i=n.precision,t=n.rounding,n.precision=i+2*Math.max(Math.abs(e.e),e.sd())+6,n.rounding=1,rt=!1,e=e.times(e).plus(1).sqrt().plus(e),rt=!0,n.precision=i,n.rounding=t,e.ln())};z.inverseHyperbolicTangent=z.atanh=function(){var i,t,e,n,r=this,s=r.constructor;return r.isFinite()?r.e>=0?new s(r.abs().eq(1)?r.s/0:r.isZero()?r:NaN):(i=s.precision,t=s.rounding,n=r.sd(),Math.max(n,i)<2*-r.e-1?H(new s(r),i,t,!0):(s.precision=e=n-r.e,r=Ct(r.plus(1),new s(1).minus(r),e+i,1),s.precision=i+4,s.rounding=1,r=r.ln(),s.precision=i,s.rounding=t,r.times(.5))):new s(NaN)};z.inverseSine=z.asin=function(){var i,t,e,n,r=this,s=r.constructor;return r.isZero()?new s(r):(t=r.abs().cmp(1),e=s.precision,n=s.rounding,t!==-1?t===0?(i=Se(s,e+4,n).times(.5),i.s=r.s,i):new s(NaN):(s.precision=e+6,s.rounding=1,r=r.div(new s(1).minus(r.times(r)).sqrt().plus(1)).atan(),s.precision=e,s.rounding=n,r.times(2)))};z.inverseTangent=z.atan=function(){var i,t,e,n,r,s,o,a,u,c=this,l=c.constructor,h=l.precision,f=l.rounding;if(c.isFinite()){if(c.isZero())return new l(c);if(c.abs().eq(1)&&h+4<=Ps)return o=Se(l,h+4,f).times(.25),o.s=c.s,o}else{if(!c.s)return new l(NaN);if(h+4<=Ps)return o=Se(l,h+4,f).times(.5),o.s=c.s,o}for(l.precision=a=h+10,l.rounding=1,e=Math.min(28,a/Q+2|0),i=e;i;--i)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(rt=!1,t=Math.ceil(a/Q),n=1,u=c.times(c),o=new l(c),r=c;i!==-1;)if(r=r.times(u),s=o.minus(r.div(n+=2)),r=r.times(u),o=s.plus(r.div(n+=2)),o.d[t]!==void 0)for(i=t;o.d[i]===s.d[i]&&i--;);return e&&(o=o.times(2<<e-1)),rt=!0,H(o,l.precision=h,l.rounding=f,!0)};z.isFinite=function(){return!!this.d};z.isInteger=z.isInt=function(){return!!this.d&&ue(this.e/Q)>this.d.length-2};z.isNaN=function(){return!this.s};z.isNegative=z.isNeg=function(){return this.s<0};z.isPositive=z.isPos=function(){return this.s>0};z.isZero=function(){return!!this.d&&this.d[0]===0};z.lessThan=z.lt=function(i){return this.cmp(i)<0};z.lessThanOrEqualTo=z.lte=function(i){return this.cmp(i)<1};z.logarithm=z.log=function(i){var t,e,n,r,s,o,a,u,c=this,l=c.constructor,h=l.precision,f=l.rounding,g=5;if(i==null)i=new l(10),t=!0;else{if(i=new l(i),e=i.d,i.s<0||!e||!e[0]||i.eq(1))return new l(NaN);t=i.eq(10)}if(e=c.d,c.s<0||!e||!e[0]||c.eq(1))return new l(e&&!e[0]?-1/0:c.s!=1?NaN:e?0:1/0);if(t)if(e.length>1)s=!0;else{for(r=e[0];r%10===0;)r/=10;s=r!==1}if(rt=!1,a=h+g,o=hn(c,a),n=t?wr(l,a+10):hn(i,a),u=Ct(o,n,a,1),Li(u.d,r=h,f))do if(a+=10,o=hn(c,a),n=t?wr(l,a+10):hn(i,a),u=Ct(o,n,a,1),!s){+ne(u.d).slice(r+1,r+15)+1==1e14&&(u=H(u,h+1,0));break}while(Li(u.d,r+=10,f));return rt=!0,H(u,h,f)};z.minus=z.sub=function(i){var t,e,n,r,s,o,a,u,c,l,h,f,g=this,m=g.constructor;if(i=new m(i),!g.d||!i.d)return!g.s||!i.s?i=new m(NaN):g.d?i.s=-i.s:i=new m(i.d||g.s!==i.s?g:NaN),i;if(g.s!=i.s)return i.s=-i.s,g.plus(i);if(c=g.d,f=i.d,a=m.precision,u=m.rounding,!c[0]||!f[0]){if(f[0])i.s=-i.s;else if(c[0])i=new m(g);else return new m(u===3?-0:0);return rt?H(i,a,u):i}if(e=ue(i.e/Q),l=ue(g.e/Q),c=c.slice(),s=l-e,s){for(h=s<0,h?(t=c,s=-s,o=f.length):(t=f,e=l,o=c.length),n=Math.max(Math.ceil(a/Q),o)+2,s>n&&(s=n,t.length=1),t.reverse(),n=s;n--;)t.push(0);t.reverse()}else{for(n=c.length,o=f.length,h=n<o,h&&(o=n),n=0;n<o;n++)if(c[n]!=f[n]){h=c[n]<f[n];break}s=0}for(h&&(t=c,c=f,f=t,i.s=-i.s),o=c.length,n=f.length-o;n>0;--n)c[o++]=0;for(n=f.length;n>s;){if(c[--n]<f[n]){for(r=n;r&&c[--r]===0;)c[r]=Te-1;--c[r],c[n]+=Te}c[n]-=f[n]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--e;return c[0]?(i.d=c,i.e=Ur(c,e),rt?H(i,a,u):i):new m(u===3?-0:0)};z.modulo=z.mod=function(i){var t,e=this,n=e.constructor;return i=new n(i),!e.d||!i.s||i.d&&!i.d[0]?new n(NaN):!i.d||e.d&&!e.d[0]?H(new n(e),n.precision,n.rounding):(rt=!1,n.modulo==9?(t=Ct(e,i.abs(),0,3,1),t.s*=i.s):t=Ct(e,i,0,n.modulo,1),t=t.times(i),rt=!0,e.minus(t))};z.naturalExponential=z.exp=function(){return Bs(this)};z.naturalLogarithm=z.ln=function(){return hn(this)};z.negated=z.neg=function(){var i=new this.constructor(this);return i.s=-i.s,H(i)};z.plus=z.add=function(i){var t,e,n,r,s,o,a,u,c,l,h=this,f=h.constructor;if(i=new f(i),!h.d||!i.d)return!h.s||!i.s?i=new f(NaN):h.d||(i=new f(i.d||h.s===i.s?h:NaN)),i;if(h.s!=i.s)return i.s=-i.s,h.minus(i);if(c=h.d,l=i.d,a=f.precision,u=f.rounding,!c[0]||!l[0])return l[0]||(i=new f(h)),rt?H(i,a,u):i;if(s=ue(h.e/Q),n=ue(i.e/Q),c=c.slice(),r=s-n,r){for(r<0?(e=c,r=-r,o=l.length):(e=l,n=s,o=c.length),s=Math.ceil(a/Q),o=s>o?s+1:o+1,r>o&&(r=o,e.length=1),e.reverse();r--;)e.push(0);e.reverse()}for(o=c.length,r=l.length,o-r<0&&(r=o,e=l,l=c,c=e),t=0;r;)t=(c[--r]=c[r]+l[r]+t)/Te|0,c[r]%=Te;for(t&&(c.unshift(t),++n),o=c.length;c[--o]==0;)c.pop();return i.d=c,i.e=Ur(c,n),rt?H(i,a,u):i};z.precision=z.sd=function(i){var t,e=this;if(i!==void 0&&i!==!!i&&i!==1&&i!==0)throw Error(gn+i);return e.d?(t=Pl(e.d),i&&e.e+1>t&&(t=e.e+1)):t=NaN,t};z.round=function(){var i=this,t=i.constructor;return H(new t(i),i.e+1,t.rounding)};z.sine=z.sin=function(){var i,t,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(i=n.precision,t=n.rounding,n.precision=i+Math.max(e.e,e.sd())+Q,n.rounding=1,e=Vm(n,Gl(n,e)),n.precision=i,n.rounding=t,H($e>2?e.neg():e,i,t,!0)):new n(NaN)};z.squareRoot=z.sqrt=function(){var i,t,e,n,r,s,o=this,a=o.d,u=o.e,c=o.s,l=o.constructor;if(c!==1||!a||!a[0])return new l(!c||c<0&&(!a||a[0])?NaN:a?o:1/0);for(rt=!1,c=Math.sqrt(+o),c==0||c==1/0?(t=ne(a),(t.length+u)%2==0&&(t+="0"),c=Math.sqrt(t),u=ue((u+1)/2)-(u<0||u%2),c==1/0?t="5e"+u:(t=c.toExponential(),t=t.slice(0,t.indexOf("e")+1)+u),n=new l(t)):n=new l(c.toString()),e=(u=l.precision)+3;;)if(s=n,n=s.plus(Ct(o,s,e+2,1)).times(.5),ne(s.d).slice(0,e)===(t=ne(n.d)).slice(0,e))if(t=t.slice(e-3,e+1),t=="9999"||!r&&t=="4999"){if(!r&&(H(s,u+1,0),s.times(s).eq(o))){n=s;break}e+=4,r=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(H(n,u+1,1),i=!n.times(n).eq(o));break}return rt=!0,H(n,u,l.rounding,i)};z.tangent=z.tan=function(){var i,t,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(i=n.precision,t=n.rounding,n.precision=i+10,n.rounding=1,e=e.sin(),e.s=1,e=Ct(e,new n(1).minus(e.times(e)).sqrt(),i+10,0),n.precision=i,n.rounding=t,H($e==2||$e==4?e.neg():e,i,t,!0)):new n(NaN)};z.times=z.mul=function(i){var t,e,n,r,s,o,a,u,c,l=this,h=l.constructor,f=l.d,g=(i=new h(i)).d;if(i.s*=l.s,!f||!f[0]||!g||!g[0])return new h(!i.s||f&&!f[0]&&!g||g&&!g[0]&&!f?NaN:!f||!g?i.s/0:i.s*0);for(e=ue(l.e/Q)+ue(i.e/Q),u=f.length,c=g.length,u<c&&(s=f,f=g,g=s,o=u,u=c,c=o),s=[],o=u+c,n=o;n--;)s.push(0);for(n=c;--n>=0;){for(t=0,r=u+n;r>n;)a=s[r]+g[n]*f[r-n-1]+t,s[r--]=a%Te|0,t=a/Te|0;s[r]=(s[r]+t)%Te|0}for(;!s[--o];)s.pop();return t?++e:s.shift(),i.d=s,i.e=Ur(s,e),rt?H(i,h.precision,h.rounding):i};z.toBinary=function(i,t){return Lo(this,2,i,t)};z.toDecimalPlaces=z.toDP=function(i,t){var e=this,n=e.constructor;return e=new n(e),i===void 0?e:(_e(i,0,_n),t===void 0?t=n.rounding:_e(t,0,8),H(e,i+e.e+1,t))};z.toExponential=function(i,t){var e,n=this,r=n.constructor;return i===void 0?e=Xe(n,!0):(_e(i,0,_n),t===void 0?t=r.rounding:_e(t,0,8),n=H(new r(n),i+1,t),e=Xe(n,!0,i+1)),n.isNeg()&&!n.isZero()?"-"+e:e};z.toFixed=function(i,t){var e,n,r=this,s=r.constructor;return i===void 0?e=Xe(r):(_e(i,0,_n),t===void 0?t=s.rounding:_e(t,0,8),n=H(new s(r),i+r.e+1,t),e=Xe(n,!1,i+n.e+1)),r.isNeg()&&!r.isZero()?"-"+e:e};z.toFraction=function(i){var t,e,n,r,s,o,a,u,c,l,h,f,g=this,m=g.d,d=g.constructor;if(!m)return new d(g);if(c=e=new d(1),n=u=new d(0),t=new d(n),s=t.e=Pl(m)-g.e-1,o=s%Q,t.d[0]=Gt(10,o<0?Q+o:o),i==null)i=s>0?t:c;else{if(a=new d(i),!a.isInt()||a.lt(c))throw Error(gn+a);i=a.gt(t)?s>0?t:c:a}for(rt=!1,a=new d(ne(m)),l=d.precision,d.precision=s=m.length*Q*2;h=Ct(a,t,0,1,1),r=e.plus(h.times(n)),r.cmp(i)!=1;)e=n,n=r,r=c,c=u.plus(h.times(r)),u=r,r=t,t=a.minus(h.times(r)),a=r;return r=Ct(i.minus(e),n,0,1,1),u=u.plus(r.times(c)),e=e.plus(r.times(n)),u.s=c.s=g.s,f=Ct(c,n,s,1).minus(g).abs().cmp(Ct(u,e,s,1).minus(g).abs())<1?[c,n]:[u,e],d.precision=l,rt=!0,f};z.toHexadecimal=z.toHex=function(i,t){return Lo(this,16,i,t)};z.toNearest=function(i,t){var e=this,n=e.constructor;if(e=new n(e),i==null){if(!e.d)return e;i=new n(1),t=n.rounding}else{if(i=new n(i),t===void 0?t=n.rounding:_e(t,0,8),!e.d)return i.s?e:i;if(!i.d)return i.s&&(i.s=e.s),i}return i.d[0]?(rt=!1,e=Ct(e,i,0,t,1).times(i),rt=!0,H(e)):(i.s=e.s,e=i),e};z.toNumber=function(){return+this};z.toOctal=function(i,t){return Lo(this,8,i,t)};z.toPower=z.pow=function(i){var t,e,n,r,s,o,a=this,u=a.constructor,c=+(i=new u(i));if(!a.d||!i.d||!a.d[0]||!i.d[0])return new u(Gt(+a,c));if(a=new u(a),a.eq(1))return a;if(n=u.precision,s=u.rounding,i.eq(1))return H(a,n,s);if(t=ue(i.e/Q),t>=i.d.length-1&&(e=c<0?-c:c)<=Wm)return r=Bl(u,a,e,n),i.s<0?new u(1).div(r):H(r,n,s);if(o=a.s,o<0){if(t<i.d.length-1)return new u(NaN);if(i.d[t]&1||(o=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=o,a}return e=Gt(+a,c),t=e==0||!isFinite(e)?ue(c*(Math.log("0."+ne(a.d))/Math.LN10+a.e+1)):new u(e+"").e,t>u.maxE+1||t<u.minE-1?new u(t>0?o/0:0):(rt=!1,u.rounding=a.s=1,e=Math.min(12,(t+"").length),r=Bs(i.times(hn(a,n+e)),n),r.d&&(r=H(r,n+5,1),Li(r.d,n,s)&&(t=n+10,r=H(Bs(i.times(hn(a,t+e)),t),t+5,1),+ne(r.d).slice(n+1,n+15)+1==1e14&&(r=H(r,n+1,0)))),r.s=o,rt=!0,u.rounding=s,H(r,n,s))};z.toPrecision=function(i,t){var e,n=this,r=n.constructor;return i===void 0?e=Xe(n,n.e<=r.toExpNeg||n.e>=r.toExpPos):(_e(i,1,_n),t===void 0?t=r.rounding:_e(t,0,8),n=H(new r(n),i,t),e=Xe(n,i<=n.e||n.e<=r.toExpNeg,i)),n.isNeg()&&!n.isZero()?"-"+e:e};z.toSignificantDigits=z.toSD=function(i,t){var e=this,n=e.constructor;return i===void 0?(i=n.precision,t=n.rounding):(_e(i,1,_n),t===void 0?t=n.rounding:_e(t,0,8)),H(new n(e),i,t)};z.toString=function(){var i=this,t=i.constructor,e=Xe(i,i.e<=t.toExpNeg||i.e>=t.toExpPos);return i.isNeg()&&!i.isZero()?"-"+e:e};z.truncated=z.trunc=function(){return H(new this.constructor(this),this.e+1,1)};z.valueOf=z.toJSON=function(){var i=this,t=i.constructor,e=Xe(i,i.e<=t.toExpNeg||i.e>=t.toExpPos);return i.isNeg()?"-"+e:e};function ne(i){var t,e,n,r=i.length-1,s="",o=i[0];if(r>0){for(s+=o,t=1;t<r;t++)n=i[t]+"",e=Q-n.length,e&&(s+=un(e)),s+=n;o=i[t],n=o+"",e=Q-n.length,e&&(s+=un(e))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}function _e(i,t,e){if(i!==~~i||i<t||i>e)throw Error(gn+i)}function Li(i,t,e,n){var r,s,o,a;for(s=i[0];s>=10;s/=10)--t;return--t<0?(t+=Q,r=0):(r=Math.ceil((t+1)/Q),t%=Q),s=Gt(10,Q-t),a=i[r]%s|0,n==null?t<3?(t==0?a=a/100|0:t==1&&(a=a/10|0),o=e<4&&a==99999||e>3&&a==49999||a==5e4||a==0):o=(e<4&&a+1==s||e>3&&a+1==s/2)&&(i[r+1]/s/100|0)==Gt(10,t-2)-1||(a==s/2||a==0)&&(i[r+1]/s/100|0)==0:t<4?(t==0?a=a/1e3|0:t==1?a=a/100|0:t==2&&(a=a/10|0),o=(n||e<4)&&a==9999||!n&&e>3&&a==4999):o=((n||e<4)&&a+1==s||!n&&e>3&&a+1==s/2)&&(i[r+1]/s/1e3|0)==Gt(10,t-3)-1,o}function ir(i,t,e){for(var n,r=[0],s,o=0,a=i.length;o<a;){for(s=r.length;s--;)r[s]*=t;for(r[0]+=Ns.indexOf(i.charAt(o++)),n=0;n<r.length;n++)r[n]>e-1&&(r[n+1]===void 0&&(r[n+1]=0),r[n+1]+=r[n]/e|0,r[n]%=e)}return r.reverse()}function Um(i,t){var e,n,r;if(t.isZero())return t;n=t.d.length,n<32?(e=Math.ceil(n/3),r=(1/Zr(4,e)).toString()):(e=16,r="2.3283064365386962890625e-10"),i.precision+=e,t=ri(i,1,t.times(r),new i(1));for(var s=e;s--;){var o=t.times(t);t=o.times(o).minus(o).times(8).plus(1)}return i.precision-=e,t}var Ct=function(){function i(n,r,s){var o,a=0,u=n.length;for(n=n.slice();u--;)o=n[u]*r+a,n[u]=o%s|0,a=o/s|0;return a&&n.unshift(a),n}function t(n,r,s,o){var a,u;if(s!=o)u=s>o?1:-1;else for(a=u=0;a<s;a++)if(n[a]!=r[a]){u=n[a]>r[a]?1:-1;break}return u}function e(n,r,s,o){for(var a=0;s--;)n[s]-=a,a=n[s]<r[s]?1:0,n[s]=a*o+n[s]-r[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,r,s,o,a,u){var c,l,h,f,g,m,d,_,p,D,v,y,E,C,F,w,A,T,I,N,X=n.constructor,U=n.s==r.s?1:-1,b=n.d,M=r.d;if(!b||!b[0]||!M||!M[0])return new X(!n.s||!r.s||(b?M&&b[0]==M[0]:!M)?NaN:b&&b[0]==0||!M?U*0:U/0);for(u?(g=1,l=n.e-r.e):(u=Te,g=Q,l=ue(n.e/g)-ue(r.e/g)),I=M.length,A=b.length,p=new X(U),D=p.d=[],h=0;M[h]==(b[h]||0);h++);if(M[h]>(b[h]||0)&&l--,s==null?(C=s=X.precision,o=X.rounding):a?C=s+(n.e-r.e)+1:C=s,C<0)D.push(1),m=!0;else{if(C=C/g+2|0,h=0,I==1){for(f=0,M=M[0],C++;(h<A||f)&&C--;h++)F=f*u+(b[h]||0),D[h]=F/M|0,f=F%M|0;m=f||h<A}else{for(f=u/(M[0]+1)|0,f>1&&(M=i(M,f,u),b=i(b,f,u),I=M.length,A=b.length),w=I,v=b.slice(0,I),y=v.length;y<I;)v[y++]=0;N=M.slice(),N.unshift(0),T=M[0],M[1]>=u/2&&++T;do f=0,c=t(M,v,I,y),c<0?(E=v[0],I!=y&&(E=E*u+(v[1]||0)),f=E/T|0,f>1?(f>=u&&(f=u-1),d=i(M,f,u),_=d.length,y=v.length,c=t(d,v,_,y),c==1&&(f--,e(d,I<_?N:M,_,u))):(f==0&&(c=f=1),d=M.slice()),_=d.length,_<y&&d.unshift(0),e(v,d,y,u),c==-1&&(y=v.length,c=t(M,v,I,y),c<1&&(f++,e(v,I<y?N:M,y,u))),y=v.length):c===0&&(f++,v=[0]),D[h++]=f,c&&v[0]?v[y++]=b[w]||0:(v=[b[w]],y=1);while((w++<A||v[0]!==void 0)&&C--);m=v[0]!==void 0}D[0]||D.shift()}if(g==1)p.e=l,Il=m;else{for(h=1,f=D[0];f>=10;f/=10)h++;p.e=h+l*g-1,H(p,a?s+p.e+1:s,o,m)}return p}}();function H(i,t,e,n){var r,s,o,a,u,c,l,h,f,g=i.constructor;t:if(t!=null){if(h=i.d,!h)return i;for(r=1,a=h[0];a>=10;a/=10)r++;if(s=t-r,s<0)s+=Q,o=t,l=h[f=0],u=l/Gt(10,r-o-1)%10|0;else if(f=Math.ceil((s+1)/Q),a=h.length,f>=a)if(n){for(;a++<=f;)h.push(0);l=u=0,r=1,s%=Q,o=s-Q+1}else break t;else{for(l=a=h[f],r=1;a>=10;a/=10)r++;s%=Q,o=s-Q+r,u=o<0?0:l/Gt(10,r-o-1)%10|0}if(n=n||t<0||h[f+1]!==void 0||(o<0?l:l%Gt(10,r-o-1)),c=e<4?(u||n)&&(e==0||e==(i.s<0?3:2)):u>5||u==5&&(e==4||n||e==6&&(s>0?o>0?l/Gt(10,r-o):0:h[f-1])%10&1||e==(i.s<0?8:7)),t<1||!h[0])return h.length=0,c?(t-=i.e+1,h[0]=Gt(10,(Q-t%Q)%Q),i.e=-t||0):h[0]=i.e=0,i;if(s==0?(h.length=f,a=1,f--):(h.length=f+1,a=Gt(10,Q-s),h[f]=o>0?(l/Gt(10,r-o)%Gt(10,o)|0)*a:0),c)for(;;)if(f==0){for(s=1,o=h[0];o>=10;o/=10)s++;for(o=h[0]+=a,a=1;o>=10;o/=10)a++;s!=a&&(i.e++,h[0]==Te&&(h[0]=1));break}else{if(h[f]+=a,h[f]!=Te)break;h[f--]=0,a=1}for(s=h.length;h[--s]===0;)h.pop()}return rt&&(i.e>g.maxE?(i.d=null,i.e=NaN):i.e<g.minE&&(i.e=0,i.d=[0])),i}function Xe(i,t,e){if(!i.isFinite())return kl(i);var n,r=i.e,s=ne(i.d),o=s.length;return t?(e&&(n=e-o)>0?s=s.charAt(0)+"."+s.slice(1)+un(n):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i.e<0?"e":"e+")+i.e):r<0?(s="0."+un(-r-1)+s,e&&(n=e-o)>0&&(s+=un(n))):r>=o?(s+=un(r+1-o),e&&(n=e-r-1)>0&&(s=s+"."+un(n))):((n=r+1)<o&&(s=s.slice(0,n)+"."+s.slice(n)),e&&(n=e-o)>0&&(r+1===o&&(s+="."),s+=un(n))),s}function Ur(i,t){var e=i[0];for(t*=Q;e>=10;e/=10)t++;return t}function wr(i,t,e){if(t>Ym)throw rt=!0,e&&(i.precision=e),Error(bl);return H(new i(Er),t,1,!0)}function Se(i,t,e){if(t>Ps)throw Error(bl);return H(new i(Cr),t,e,!0)}function Pl(i){var t=i.length-1,e=t*Q+1;if(t=i[t],t){for(;t%10==0;t/=10)e--;for(t=i[0];t>=10;t/=10)e++}return e}function un(i){for(var t="";i--;)t+="0";return t}function Bl(i,t,e,n){var r,s=new i(1),o=Math.ceil(n/Q+4);for(rt=!1;;){if(e%2&&(s=s.times(t),Xa(s.d,o)&&(r=!0)),e=ue(e/2),e===0){e=s.d.length-1,r&&s.d[e]===0&&++s.d[e];break}t=t.times(t),Xa(t.d,o)}return rt=!0,s}function Ga(i){return i.d[i.d.length-1]&1}function zl(i,t,e){for(var n,r=new i(t[0]),s=0;++s<t.length;)if(n=new i(t[s]),n.s)r[e](n)&&(r=n);else{r=n;break}return r}function Bs(i,t){var e,n,r,s,o,a,u,c=0,l=0,h=0,f=i.constructor,g=f.rounding,m=f.precision;if(!i.d||!i.d[0]||i.e>17)return new f(i.d?i.d[0]?i.s<0?0:1/0:1:i.s?i.s<0?0:i:0/0);for(t==null?(rt=!1,u=m):u=t,a=new f(.03125);i.e>-2;)i=i.times(a),h+=5;for(n=Math.log(Gt(2,h))/Math.LN10*2+5|0,u+=n,e=s=o=new f(1),f.precision=u;;){if(s=H(s.times(i),u,1),e=e.times(++l),a=o.plus(Ct(s,e,u,1)),ne(a.d).slice(0,u)===ne(o.d).slice(0,u)){for(r=h;r--;)o=H(o.times(o),u,1);if(t==null)if(c<3&&Li(o.d,u-n,g,c))f.precision=u+=10,e=s=a=new f(1),l=0,c++;else return H(o,f.precision=m,g,rt=!0);else return f.precision=m,o}o=a}}function hn(i,t){var e,n,r,s,o,a,u,c,l,h,f,g=1,m=10,d=i,_=d.d,p=d.constructor,D=p.rounding,v=p.precision;if(d.s<0||!_||!_[0]||!d.e&&_[0]==1&&_.length==1)return new p(_&&!_[0]?-1/0:d.s!=1?NaN:_?0:d);if(t==null?(rt=!1,l=v):l=t,p.precision=l+=m,e=ne(_),n=e.charAt(0),Math.abs(s=d.e)<15e14){for(;n<7&&n!=1||n==1&&e.charAt(1)>3;)d=d.times(i),e=ne(d.d),n=e.charAt(0),g++;s=d.e,n>1?(d=new p("0."+e),s++):d=new p(n+"."+e.slice(1))}else return c=wr(p,l+2,v).times(s+""),d=hn(new p(n+"."+e.slice(1)),l-m).plus(c),p.precision=v,t==null?H(d,v,D,rt=!0):d;for(h=d,u=o=d=Ct(d.minus(1),d.plus(1),l,1),f=H(d.times(d),l,1),r=3;;){if(o=H(o.times(f),l,1),c=u.plus(Ct(o,new p(r),l,1)),ne(c.d).slice(0,l)===ne(u.d).slice(0,l))if(u=u.times(2),s!==0&&(u=u.plus(wr(p,l+2,v).times(s+""))),u=Ct(u,new p(g),l,1),t==null)if(Li(u.d,l-m,D,a))p.precision=l+=m,c=o=d=Ct(h.minus(1),h.plus(1),l,1),f=H(d.times(d),l,1),r=a=1;else return H(u,p.precision=v,D,rt=!0);else return p.precision=v,u;u=c,r+=2}}function kl(i){return String(i.s*i.s/0)}function zs(i,t){var e,n,r;for((e=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(e<0&&(e=n),e+=+t.slice(n+1),t=t.substring(0,n)):e<0&&(e=t.length),n=0;t.charCodeAt(n)===48;n++);for(r=t.length;t.charCodeAt(r-1)===48;--r);if(t=t.slice(n,r),t){if(r-=n,i.e=e=e-n-1,i.d=[],n=(e+1)%Q,e<0&&(n+=Q),n<r){for(n&&i.d.push(+t.slice(0,n)),r-=Q;n<r;)i.d.push(+t.slice(n,n+=Q));t=t.slice(n),n=Q-t.length}else n-=r;for(;n--;)t+="0";i.d.push(+t),rt&&(i.e>i.constructor.maxE?(i.d=null,i.e=NaN):i.e<i.constructor.minE&&(i.e=0,i.d=[0]))}else i.e=0,i.d=[0];return i}function Zm(i,t){var e,n,r,s,o,a,u,c,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),Ol.test(t))return zs(i,t)}else if(t==="Infinity"||t==="NaN")return+t||(i.s=NaN),i.e=NaN,i.d=null,i;if(Gm.test(t))e=16,t=t.toLowerCase();else if(km.test(t))e=2;else if(Xm.test(t))e=8;else throw Error(gn+t);for(s=t.search(/p/i),s>0?(u=+t.slice(s+1),t=t.substring(2,s)):t=t.slice(2),s=t.indexOf("."),o=s>=0,n=i.constructor,o&&(t=t.replace(".",""),a=t.length,s=a-s,r=Bl(n,new n(e),s,s*2)),c=ir(t,e,Te),l=c.length-1,s=l;c[s]===0;--s)c.pop();return s<0?new n(i.s*0):(i.e=Ur(c,l),i.d=c,rt=!1,o&&(i=Ct(i,r,a*4)),u&&(i=i.times(Math.abs(u)<54?Gt(2,u):si.pow(2,u))),rt=!0,i)}function Vm(i,t){var e,n=t.d.length;if(n<3)return t.isZero()?t:ri(i,2,t,t);e=1.4*Math.sqrt(n),e=e>16?16:e|0,t=t.times(1/Zr(5,e)),t=ri(i,2,t,t);for(var r,s=new i(5),o=new i(16),a=new i(20);e--;)r=t.times(t),t=t.times(s.plus(r.times(o.times(r).minus(a))));return t}function ri(i,t,e,n,r){var s,o,a,u,c=i.precision,l=Math.ceil(c/Q);for(rt=!1,u=e.times(e),a=new i(n);;){if(o=Ct(a.times(u),new i(t++*t++),c,1),a=r?n.plus(o):n.minus(o),n=Ct(o.times(u),new i(t++*t++),c,1),o=a.plus(n),o.d[l]!==void 0){for(s=l;o.d[s]===a.d[s]&&s--;);if(s==-1)break}s=a,a=n,n=o,o=s}return rt=!0,o.d.length=l+1,o}function Zr(i,t){for(var e=i;--t;)e*=i;return e}function Gl(i,t){var e,n=t.s<0,r=Se(i,i.precision,1),s=r.times(.5);if(t=t.abs(),t.lte(s))return $e=n?4:1,t;if(e=t.divToInt(r),e.isZero())$e=n?3:2;else{if(t=t.minus(e.times(r)),t.lte(s))return $e=Ga(e)?n?2:3:n?4:1,t;$e=Ga(e)?n?1:4:n?3:2}return t.minus(r).abs()}function Lo(i,t,e,n){var r,s,o,a,u,c,l,h,f,g=i.constructor,m=e!==void 0;if(m?(_e(e,1,_n),n===void 0?n=g.rounding:_e(n,0,8)):(e=g.precision,n=g.rounding),!i.isFinite())l=kl(i);else{for(l=Xe(i),o=l.indexOf("."),m?(r=2,t==16?e=e*4-3:t==8&&(e=e*3-2)):r=t,o>=0&&(l=l.replace(".",""),f=new g(1),f.e=l.length-o,f.d=ir(Xe(f),10,r),f.e=f.d.length),h=ir(l,10,r),s=u=h.length;h[--u]==0;)h.pop();if(!h[0])l=m?"0p+0":"0";else{if(o<0?s--:(i=new g(i),i.d=h,i.e=s,i=Ct(i,f,e,n,0,r),h=i.d,s=i.e,c=Il),o=h[e],a=r/2,c=c||h[e+1]!==void 0,c=n<4?(o!==void 0||c)&&(n===0||n===(i.s<0?3:2)):o>a||o===a&&(n===4||c||n===6&&h[e-1]&1||n===(i.s<0?8:7)),h.length=e,c)for(;++h[--e]>r-1;)h[e]=0,e||(++s,h.unshift(1));for(u=h.length;!h[u-1];--u);for(o=0,l="";o<u;o++)l+=Ns.charAt(h[o]);if(m){if(u>1)if(t==16||t==8){for(o=t==16?4:3,--u;u%o;u++)l+="0";for(h=ir(l,r,t),u=h.length;!h[u-1];--u);for(o=1,l="1.";o<u;o++)l+=Ns.charAt(h[o])}else l=l.charAt(0)+"."+l.slice(1);l=l+(s<0?"p":"p+")+s}else if(s<0){for(;++s;)l="0"+l;l="0."+l}else if(++s>u)for(s-=u;s--;)l+="0";else s<u&&(l=l.slice(0,s)+"."+l.slice(s))}l=(t==16?"0x":t==2?"0b":t==8?"0o":"")+l}return i.s<0?"-"+l:l}function Xa(i,t){if(i.length>t)return i.length=t,!0}function Km(i){return new this(i).abs()}function $m(i){return new this(i).acos()}function qm(i){return new this(i).acosh()}function Hm(i,t){return new this(i).plus(t)}function jm(i){return new this(i).asin()}function Jm(i){return new this(i).asinh()}function Qm(i){return new this(i).atan()}function t_(i){return new this(i).atanh()}function e_(i,t){i=new this(i),t=new this(t);var e,n=this.precision,r=this.rounding,s=n+4;return!i.s||!t.s?e=new this(NaN):!i.d&&!t.d?(e=Se(this,s,1).times(t.s>0?.25:.75),e.s=i.s):!t.d||i.isZero()?(e=t.s<0?Se(this,n,r):new this(0),e.s=i.s):!i.d||t.isZero()?(e=Se(this,s,1).times(.5),e.s=i.s):t.s<0?(this.precision=s,this.rounding=1,e=this.atan(Ct(i,t,s,1)),t=Se(this,s,1),this.precision=n,this.rounding=r,e=i.s<0?e.minus(t):e.plus(t)):e=this.atan(Ct(i,t,s,1)),e}function n_(i){return new this(i).cbrt()}function i_(i){return H(i=new this(i),i.e+1,2)}function r_(i,t,e){return new this(i).clamp(t,e)}function s_(i){if(!i||typeof i!="object")throw Error(Yr+"Object expected");var t,e,n,r=i.defaults===!0,s=["precision",1,_n,"rounding",0,8,"toExpNeg",-$n,0,"toExpPos",0,$n,"maxE",0,$n,"minE",-$n,0,"modulo",0,9];for(t=0;t<s.length;t+=3)if(e=s[t],r&&(this[e]=Os[e]),(n=i[e])!==void 0)if(ue(n)===n&&n>=s[t+1]&&n<=s[t+2])this[e]=n;else throw Error(gn+e+": "+n);if(e="crypto",r&&(this[e]=Os[e]),(n=i[e])!==void 0)if(n===!0||n===!1||n===0||n===1)if(n)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[e]=!0;else throw Error(Ll);else this[e]=!1;else throw Error(gn+e+": "+n);return this}function o_(i){return new this(i).cos()}function a_(i){return new this(i).cosh()}function Xl(i){var t,e,n;function r(s){var o,a,u,c=this;if(!(c instanceof r))return new r(s);if(c.constructor=r,Wa(s)){c.s=s.s,rt?!s.d||s.e>r.maxE?(c.e=NaN,c.d=null):s.e<r.minE?(c.e=0,c.d=[0]):(c.e=s.e,c.d=s.d.slice()):(c.e=s.e,c.d=s.d?s.d.slice():s.d);return}if(u=typeof s,u==="number"){if(s===0){c.s=1/s<0?-1:1,c.e=0,c.d=[0];return}if(s<0?(s=-s,c.s=-1):c.s=1,s===~~s&&s<1e7){for(o=0,a=s;a>=10;a/=10)o++;rt?o>r.maxE?(c.e=NaN,c.d=null):o<r.minE?(c.e=0,c.d=[0]):(c.e=o,c.d=[s]):(c.e=o,c.d=[s]);return}else if(s*0!==0){s||(c.s=NaN),c.e=NaN,c.d=null;return}return zs(c,s.toString())}else if(u!=="string")throw Error(gn+s);return(a=s.charCodeAt(0))===45?(s=s.slice(1),c.s=-1):(a===43&&(s=s.slice(1)),c.s=1),Ol.test(s)?zs(c,s):Zm(c,s)}if(r.prototype=z,r.ROUND_UP=0,r.ROUND_DOWN=1,r.ROUND_CEIL=2,r.ROUND_FLOOR=3,r.ROUND_HALF_UP=4,r.ROUND_HALF_DOWN=5,r.ROUND_HALF_EVEN=6,r.ROUND_HALF_CEIL=7,r.ROUND_HALF_FLOOR=8,r.EUCLID=9,r.config=r.set=s_,r.clone=Xl,r.isDecimal=Wa,r.abs=Km,r.acos=$m,r.acosh=qm,r.add=Hm,r.asin=jm,r.asinh=Jm,r.atan=Qm,r.atanh=t_,r.atan2=e_,r.cbrt=n_,r.ceil=i_,r.clamp=r_,r.cos=o_,r.cosh=a_,r.div=u_,r.exp=l_,r.floor=h_,r.hypot=c_,r.ln=f_,r.log=d_,r.log10=m_,r.log2=g_,r.max=__,r.min=p_,r.mod=v_,r.mul=D_,r.pow=y_,r.random=E_,r.round=C_,r.sign=w_,r.sin=x_,r.sinh=A_,r.sqrt=F_,r.sub=S_,r.sum=T_,r.tan=R_,r.tanh=M_,r.trunc=I_,i===void 0&&(i={}),i&&i.defaults!==!0)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<n.length;)i.hasOwnProperty(e=n[t++])||(i[e]=this[e]);return r.config(i),r}function u_(i,t){return new this(i).div(t)}function l_(i){return new this(i).exp()}function h_(i){return H(i=new this(i),i.e+1,3)}function c_(){var i,t,e=new this(0);for(rt=!1,i=0;i<arguments.length;)if(t=new this(arguments[i++]),t.d)e.d&&(e=e.plus(t.times(t)));else{if(t.s)return rt=!0,new this(1/0);e=t}return rt=!0,e.sqrt()}function Wa(i){return i instanceof si||i&&i.toStringTag===Nl||!1}function f_(i){return new this(i).ln()}function d_(i,t){return new this(i).log(t)}function g_(i){return new this(i).log(2)}function m_(i){return new this(i).log(10)}function __(){return zl(this,arguments,"lt")}function p_(){return zl(this,arguments,"gt")}function v_(i,t){return new this(i).mod(t)}function D_(i,t){return new this(i).mul(t)}function y_(i,t){return new this(i).pow(t)}function E_(i){var t,e,n,r,s=0,o=new this(1),a=[];if(i===void 0?i=this.precision:_e(i,1,_n),n=Math.ceil(i/Q),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(n));s<n;)r=t[s],r>=429e7?t[s]=crypto.getRandomValues(new Uint32Array(1))[0]:a[s++]=r%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(n*=4);s<n;)r=t[s]+(t[s+1]<<8)+(t[s+2]<<16)+((t[s+3]&127)<<24),r>=214e7?crypto.randomBytes(4).copy(t,s):(a.push(r%1e7),s+=4);s=n/4}else throw Error(Ll);else for(;s<n;)a[s++]=Math.random()*1e7|0;for(n=a[--s],i%=Q,n&&i&&(r=Gt(10,Q-i),a[s]=(n/r|0)*r);a[s]===0;s--)a.pop();if(s<0)e=0,a=[0];else{for(e=-1;a[0]===0;e-=Q)a.shift();for(n=1,r=a[0];r>=10;r/=10)n++;n<Q&&(e-=Q-n)}return o.e=e,o.d=a,o}function C_(i){return H(i=new this(i),i.e+1,this.rounding)}function w_(i){return i=new this(i),i.d?i.d[0]?i.s:0*i.s:i.s||NaN}function x_(i){return new this(i).sin()}function A_(i){return new this(i).sinh()}function F_(i){return new this(i).sqrt()}function S_(i,t){return new this(i).sub(t)}function T_(){var i=0,t=arguments,e=new this(t[i]);for(rt=!1;e.s&&++i<t.length;)e=e.plus(t[i]);return rt=!0,H(e,this.precision,this.rounding)}function R_(i){return new this(i).tan()}function M_(i){return new this(i).tanh()}function I_(i){return H(i=new this(i),i.e+1,1)}z[Symbol.for("nodejs.util.inspect.custom")]=z.toString;z[Symbol.toStringTag]="Decimal";var si=z.constructor=Xl(Os);Er=new si(Er);Cr=new si(Cr);var b_="BigNumber",L_=["?on","config"],N_=st(b_,L_,i=>{var{on:t,config:e}=i,n=si.clone({precision:e.precision,modulo:si.EUCLID});return n.prototype=Object.create(n.prototype),n.prototype.type="BigNumber",n.prototype.isBigNumber=!0,n.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},n.fromJSON=function(r){return new n(r.value)},t&&t("config",function(r,s){r.precision!==s.precision&&n.config({precision:r.precision})}),n},{isClass:!0});function Wl(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Yl={exports:{}};/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(i,t){(function(e){var n=Math.cosh||function(h){return Math.abs(h)<1e-9?1-h:(Math.exp(h)+Math.exp(-h))*.5},r=Math.sinh||function(h){return Math.abs(h)<1e-9?h:(Math.exp(h)-Math.exp(-h))*.5},s=function(h){var f=Math.PI/4;if(-f>h||h>f)return Math.cos(h)-1;var g=h*h;return g*(g*(g*(g*(g*(g*(g*(g/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-1/2)},o=function(h,f){var g=Math.abs(h),m=Math.abs(f);return g<3e3&&m<3e3?Math.sqrt(g*g+m*m):(g<m?(g=m,m=h/f):m=f/h,g*Math.sqrt(1+m*m))},a=function(){throw SyntaxError("Invalid Param")};function u(h,f){var g=Math.abs(h),m=Math.abs(f);return h===0?Math.log(m):f===0?Math.log(g):g<3e3&&m<3e3?Math.log(h*h+f*f)*.5:(h=h/2,f=f/2,.5*Math.log(h*h+f*f)+Math.LN2)}var c=function(h,f){var g={re:0,im:0};if(h==null)g.re=g.im=0;else if(f!==void 0)g.re=h,g.im=f;else switch(typeof h){case"object":if("im"in h&&"re"in h)g.re=h.re,g.im=h.im;else if("abs"in h&&"arg"in h){if(!Number.isFinite(h.abs)&&Number.isFinite(h.arg))return l.INFINITY;g.re=h.abs*Math.cos(h.arg),g.im=h.abs*Math.sin(h.arg)}else if("r"in h&&"phi"in h){if(!Number.isFinite(h.r)&&Number.isFinite(h.phi))return l.INFINITY;g.re=h.r*Math.cos(h.phi),g.im=h.r*Math.sin(h.phi)}else h.length===2?(g.re=h[0],g.im=h[1]):a();break;case"string":g.im=g.re=0;var m=h.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),d=1,_=0;m===null&&a();for(var p=0;p<m.length;p++){var D=m[p];D===" "||D==="	"||D===`
`||(D==="+"?d++:D==="-"?_++:D==="i"||D==="I"?(d+_===0&&a(),m[p+1]!==" "&&!isNaN(m[p+1])?(g.im+=parseFloat((_%2?"-":"")+m[p+1]),p++):g.im+=parseFloat((_%2?"-":"")+"1"),d=_=0):((d+_===0||isNaN(D))&&a(),m[p+1]==="i"||m[p+1]==="I"?(g.im+=parseFloat((_%2?"-":"")+D),p++):g.re+=parseFloat((_%2?"-":"")+D),d=_=0))}d+_>0&&a();break;case"number":g.im=0,g.re=h;break;default:a()}return isNaN(g.re)||isNaN(g.im),g};function l(h,f){if(!(this instanceof l))return new l(h,f);var g=c(h,f);this.re=g.re,this.im=g.im}l.prototype={re:0,im:0,sign:function(){var h=this.abs();return new l(this.re/h,this.im/h)},add:function(h,f){var g=new l(h,f);return this.isInfinite()&&g.isInfinite()?l.NAN:this.isInfinite()||g.isInfinite()?l.INFINITY:new l(this.re+g.re,this.im+g.im)},sub:function(h,f){var g=new l(h,f);return this.isInfinite()&&g.isInfinite()?l.NAN:this.isInfinite()||g.isInfinite()?l.INFINITY:new l(this.re-g.re,this.im-g.im)},mul:function(h,f){var g=new l(h,f);return this.isInfinite()&&g.isZero()||this.isZero()&&g.isInfinite()?l.NAN:this.isInfinite()||g.isInfinite()?l.INFINITY:g.im===0&&this.im===0?new l(this.re*g.re,0):new l(this.re*g.re-this.im*g.im,this.re*g.im+this.im*g.re)},div:function(h,f){var g=new l(h,f);if(this.isZero()&&g.isZero()||this.isInfinite()&&g.isInfinite())return l.NAN;if(this.isInfinite()||g.isZero())return l.INFINITY;if(this.isZero()||g.isInfinite())return l.ZERO;h=this.re,f=this.im;var m=g.re,d=g.im,_,p;return d===0?new l(h/m,f/m):Math.abs(m)<Math.abs(d)?(p=m/d,_=m*p+d,new l((h*p+f)/_,(f*p-h)/_)):(p=d/m,_=d*p+m,new l((h+f*p)/_,(f-h*p)/_))},pow:function(h,f){var g=new l(h,f);if(h=this.re,f=this.im,g.isZero())return l.ONE;if(g.im===0){if(f===0&&h>0)return new l(Math.pow(h,g.re),0);if(h===0)switch((g.re%4+4)%4){case 0:return new l(Math.pow(f,g.re),0);case 1:return new l(0,Math.pow(f,g.re));case 2:return new l(-Math.pow(f,g.re),0);case 3:return new l(0,-Math.pow(f,g.re))}}if(h===0&&f===0&&g.re>0&&g.im>=0)return l.ZERO;var m=Math.atan2(f,h),d=u(h,f);return h=Math.exp(g.re*d-g.im*m),f=g.im*d+g.re*m,new l(h*Math.cos(f),h*Math.sin(f))},sqrt:function(){var h=this.re,f=this.im,g=this.abs(),m,d;if(h>=0){if(f===0)return new l(Math.sqrt(h),0);m=.5*Math.sqrt(2*(g+h))}else m=Math.abs(f)/Math.sqrt(2*(g-h));return h<=0?d=.5*Math.sqrt(2*(g-h)):d=Math.abs(f)/Math.sqrt(2*(g+h)),new l(m,f<0?-d:d)},exp:function(){var h=Math.exp(this.re);return this.im,new l(h*Math.cos(this.im),h*Math.sin(this.im))},expm1:function(){var h=this.re,f=this.im;return new l(Math.expm1(h)*Math.cos(f)+s(f),Math.exp(h)*Math.sin(f))},log:function(){var h=this.re,f=this.im;return new l(u(h,f),Math.atan2(f,h))},abs:function(){return o(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var h=this.re,f=this.im;return new l(Math.sin(h)*n(f),Math.cos(h)*r(f))},cos:function(){var h=this.re,f=this.im;return new l(Math.cos(h)*n(f),-Math.sin(h)*r(f))},tan:function(){var h=2*this.re,f=2*this.im,g=Math.cos(h)+n(f);return new l(Math.sin(h)/g,r(f)/g)},cot:function(){var h=2*this.re,f=2*this.im,g=Math.cos(h)-n(f);return new l(-Math.sin(h)/g,r(f)/g)},sec:function(){var h=this.re,f=this.im,g=.5*n(2*f)+.5*Math.cos(2*h);return new l(Math.cos(h)*n(f)/g,Math.sin(h)*r(f)/g)},csc:function(){var h=this.re,f=this.im,g=.5*n(2*f)-.5*Math.cos(2*h);return new l(Math.sin(h)*n(f)/g,-Math.cos(h)*r(f)/g)},asin:function(){var h=this.re,f=this.im,g=new l(f*f-h*h+1,-2*h*f).sqrt(),m=new l(g.re-f,g.im+h).log();return new l(m.im,-m.re)},acos:function(){var h=this.re,f=this.im,g=new l(f*f-h*h+1,-2*h*f).sqrt(),m=new l(g.re-f,g.im+h).log();return new l(Math.PI/2-m.im,m.re)},atan:function(){var h=this.re,f=this.im;if(h===0){if(f===1)return new l(0,1/0);if(f===-1)return new l(0,-1/0)}var g=h*h+(1-f)*(1-f),m=new l((1-f*f-h*h)/g,-2*h/g).log();return new l(-.5*m.im,.5*m.re)},acot:function(){var h=this.re,f=this.im;if(f===0)return new l(Math.atan2(1,h),0);var g=h*h+f*f;return g!==0?new l(h/g,-f/g).atan():new l(h!==0?h/0:0,f!==0?-f/0:0).atan()},asec:function(){var h=this.re,f=this.im;if(h===0&&f===0)return new l(0,1/0);var g=h*h+f*f;return g!==0?new l(h/g,-f/g).acos():new l(h!==0?h/0:0,f!==0?-f/0:0).acos()},acsc:function(){var h=this.re,f=this.im;if(h===0&&f===0)return new l(Math.PI/2,1/0);var g=h*h+f*f;return g!==0?new l(h/g,-f/g).asin():new l(h!==0?h/0:0,f!==0?-f/0:0).asin()},sinh:function(){var h=this.re,f=this.im;return new l(r(h)*Math.cos(f),n(h)*Math.sin(f))},cosh:function(){var h=this.re,f=this.im;return new l(n(h)*Math.cos(f),r(h)*Math.sin(f))},tanh:function(){var h=2*this.re,f=2*this.im,g=n(h)+Math.cos(f);return new l(r(h)/g,Math.sin(f)/g)},coth:function(){var h=2*this.re,f=2*this.im,g=n(h)-Math.cos(f);return new l(r(h)/g,-Math.sin(f)/g)},csch:function(){var h=this.re,f=this.im,g=Math.cos(2*f)-n(2*h);return new l(-2*r(h)*Math.cos(f)/g,2*n(h)*Math.sin(f)/g)},sech:function(){var h=this.re,f=this.im,g=Math.cos(2*f)+n(2*h);return new l(2*n(h)*Math.cos(f)/g,-2*r(h)*Math.sin(f)/g)},asinh:function(){var h=this.im;this.im=-this.re,this.re=h;var f=this.asin();return this.re=-this.im,this.im=h,h=f.re,f.re=-f.im,f.im=h,f},acosh:function(){var h=this.acos();if(h.im<=0){var f=h.re;h.re=-h.im,h.im=f}else{var f=h.im;h.im=-h.re,h.re=f}return h},atanh:function(){var h=this.re,f=this.im,g=h>1&&f===0,m=1-h,d=1+h,_=m*m+f*f,p=_!==0?new l((d*m-f*f)/_,(f*m+d*f)/_):new l(h!==-1?h/0:0,f!==0?f/0:0),D=p.re;return p.re=u(p.re,p.im)/2,p.im=Math.atan2(p.im,D)/2,g&&(p.im=-p.im),p},acoth:function(){var h=this.re,f=this.im;if(h===0&&f===0)return new l(0,Math.PI/2);var g=h*h+f*f;return g!==0?new l(h/g,-f/g).atanh():new l(h!==0?h/0:0,f!==0?-f/0:0).atanh()},acsch:function(){var h=this.re,f=this.im;if(f===0)return new l(h!==0?Math.log(h+Math.sqrt(h*h+1)):1/0,0);var g=h*h+f*f;return g!==0?new l(h/g,-f/g).asinh():new l(h!==0?h/0:0,f!==0?-f/0:0).asinh()},asech:function(){var h=this.re,f=this.im;if(this.isZero())return l.INFINITY;var g=h*h+f*f;return g!==0?new l(h/g,-f/g).acosh():new l(h!==0?h/0:0,f!==0?-f/0:0).acosh()},inverse:function(){if(this.isZero())return l.INFINITY;if(this.isInfinite())return l.ZERO;var h=this.re,f=this.im,g=h*h+f*f;return new l(h/g,-f/g)},conjugate:function(){return new l(this.re,-this.im)},neg:function(){return new l(-this.re,-this.im)},ceil:function(h){return h=Math.pow(10,h||0),new l(Math.ceil(this.re*h)/h,Math.ceil(this.im*h)/h)},floor:function(h){return h=Math.pow(10,h||0),new l(Math.floor(this.re*h)/h,Math.floor(this.im*h)/h)},round:function(h){return h=Math.pow(10,h||0),new l(Math.round(this.re*h)/h,Math.round(this.im*h)/h)},equals:function(h,f){var g=new l(h,f);return Math.abs(g.re-this.re)<=l.EPSILON&&Math.abs(g.im-this.im)<=l.EPSILON},clone:function(){return new l(this.re,this.im)},toString:function(){var h=this.re,f=this.im,g="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(h)<l.EPSILON&&(h=0),Math.abs(f)<l.EPSILON&&(f=0),f===0?g+h:(h!==0?(g+=h,g+=" ",f<0?(f=-f,g+="-"):g+="+",g+=" "):f<0&&(f=-f,g+="-"),f!==1&&(g+=f),g+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},l.ZERO=new l(0,0),l.ONE=new l(1,0),l.I=new l(0,1),l.PI=new l(Math.PI,0),l.E=new l(Math.E,0),l.INFINITY=new l(1/0,1/0),l.NAN=new l(NaN,NaN),l.EPSILON=1e-15,Object.defineProperty(l,"__esModule",{value:!0}),l.default=l,l.Complex=l,i.exports=l})()})(Yl);var O_=Yl.exports;const ee=Wl(O_);var P_="Complex",B_=[],z_=st(P_,B_,()=>(Object.defineProperty(ee,"name",{value:"Complex"}),ee.prototype.constructor=ee,ee.prototype.type="Complex",ee.prototype.isComplex=!0,ee.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},ee.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},ee.prototype.format=function(i){var t="",e=this.im,n=this.re,r=Is(this.re,i),s=Is(this.im,i),o=Mt(i)?i:i?i.precision:null;if(o!==null){var a=Math.pow(10,-o);Math.abs(n/e)<a&&(n=0),Math.abs(e/n)<a&&(e=0)}return e===0?t=r:n===0?e===1?t="i":e===-1?t="-i":t=s+"i":e<0?e===-1?t=r+" - i":t=r+" - "+s.substring(1)+"i":e===1?t=r+" + i":t=r+" + "+s+"i",t},ee.fromPolar=function(i){switch(arguments.length){case 1:{var t=arguments[0];if(typeof t=="object")return ee(t);throw new TypeError("Input has to be an object with r and phi keys.")}case 2:{var e=arguments[0],n=arguments[1];if(Mt(e)){if(yl(n)&&n.hasBase("ANGLE")&&(n=n.toNumber("rad")),Mt(n))return new ee({r:e,phi:n});throw new TypeError("Phi is not a number nor an angle unit.")}else throw new TypeError("Radius r is not a number.")}default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},ee.prototype.valueOf=ee.prototype.toString,ee.fromJSON=function(i){return new ee(i)},ee.compare=function(i,t){return i.re>t.re?1:i.re<t.re?-1:i.im>t.im?1:i.im<t.im?-1:0},ee),{isClass:!0}),Ul={exports:{}};/**
 * @license Fraction.js v4.2.0 05/03/2022
 * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2021, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(i,t){(function(e){var n=2e3,r={s:1,n:0,d:1};function s(m,d){if(isNaN(m=parseInt(m,10)))throw g.InvalidParameter;return m*d}function o(m,d){if(d===0)throw g.DivisionByZero;var _=Object.create(g.prototype);_.s=m<0?-1:1,m=m<0?-m:m;var p=f(m,d);return _.n=m/p,_.d=d/p,_}function a(m){for(var d={},_=m,p=2,D=4;D<=_;){for(;_%p===0;)_/=p,d[p]=(d[p]||0)+1;D+=1+2*p++}return _!==m?_>1&&(d[_]=(d[_]||0)+1):d[m]=(d[m]||0)+1,d}var u=function(m,d){var _=0,p=1,D=1,v=0,y=0,E=0,C=1,F=1,w=0,A=1,T=1,I=1,N=1e7,X;if(m!=null)if(d!==void 0){if(_=m,p=d,D=_*p,_%1!==0||p%1!==0)throw g.NonIntegerParameter}else switch(typeof m){case"object":{if("d"in m&&"n"in m)_=m.n,p=m.d,"s"in m&&(_*=m.s);else if(0 in m)_=m[0],1 in m&&(p=m[1]);else throw g.InvalidParameter;D=_*p;break}case"number":{if(m<0&&(D=m,m=-m),m%1===0)_=m;else if(m>0){for(m>=1&&(F=Math.pow(10,Math.floor(1+Math.log(m)/Math.LN10)),m/=F);A<=N&&I<=N;)if(X=(w+T)/(A+I),m===X){A+I<=N?(_=w+T,p=A+I):I>A?(_=T,p=I):(_=w,p=A);break}else m>X?(w+=T,A+=I):(T+=w,I+=A),A>N?(_=T,p=I):(_=w,p=A);_*=F}else(isNaN(m)||isNaN(d))&&(p=_=NaN);break}case"string":{if(A=m.match(/\d+|./g),A===null)throw g.InvalidParameter;if(A[w]==="-"?(D=-1,w++):A[w]==="+"&&w++,A.length===w+1?y=s(A[w++],D):A[w+1]==="."||A[w]==="."?(A[w]!=="."&&(v=s(A[w++],D)),w++,(w+1===A.length||A[w+1]==="("&&A[w+3]===")"||A[w+1]==="'"&&A[w+3]==="'")&&(y=s(A[w],D),C=Math.pow(10,A[w].length),w++),(A[w]==="("&&A[w+2]===")"||A[w]==="'"&&A[w+2]==="'")&&(E=s(A[w+1],D),F=Math.pow(10,A[w+1].length)-1,w+=3)):A[w+1]==="/"||A[w+1]===":"?(y=s(A[w],D),C=s(A[w+2],1),w+=3):A[w+3]==="/"&&A[w+1]===" "&&(v=s(A[w],D),y=s(A[w+2],D),C=s(A[w+4],1),w+=5),A.length<=w){p=C*F,D=_=E+p*v+F*y;break}}default:throw g.InvalidParameter}if(p===0)throw g.DivisionByZero;r.s=D<0?-1:1,r.n=Math.abs(_),r.d=Math.abs(p)};function c(m,d,_){for(var p=1;d>0;m=m*m%_,d>>=1)d&1&&(p=p*m%_);return p}function l(m,d){for(;d%2===0;d/=2);for(;d%5===0;d/=5);if(d===1)return 0;for(var _=10%d,p=1;_!==1;p++)if(_=_*10%d,p>n)return 0;return p}function h(m,d,_){for(var p=1,D=c(10,_,d),v=0;v<300;v++){if(p===D)return v;p=p*10%d,D=D*10%d}return 0}function f(m,d){if(!m)return d;if(!d)return m;for(;;){if(m%=d,!m)return d;if(d%=m,!d)return m}}function g(m,d){if(u(m,d),this instanceof g)m=f(r.d,r.n),this.s=r.s,this.n=r.n/m,this.d=r.d/m;else return o(r.s*r.n,r.d)}g.DivisionByZero=new Error("Division by Zero"),g.InvalidParameter=new Error("Invalid argument"),g.NonIntegerParameter=new Error("Parameters must be integer"),g.prototype={s:1,n:0,d:1,abs:function(){return o(this.n,this.d)},neg:function(){return o(-this.s*this.n,this.d)},add:function(m,d){return u(m,d),o(this.s*this.n*r.d+r.s*this.d*r.n,this.d*r.d)},sub:function(m,d){return u(m,d),o(this.s*this.n*r.d-r.s*this.d*r.n,this.d*r.d)},mul:function(m,d){return u(m,d),o(this.s*r.s*this.n*r.n,this.d*r.d)},div:function(m,d){return u(m,d),o(this.s*r.s*this.n*r.d,this.d*r.n)},clone:function(){return o(this.s*this.n,this.d)},mod:function(m,d){if(isNaN(this.n)||isNaN(this.d))return new g(NaN);if(m===void 0)return o(this.s*this.n%this.d,1);if(u(m,d),r.n===0&&this.d===0)throw g.DivisionByZero;return o(this.s*(r.d*this.n)%(r.n*this.d),r.d*this.d)},gcd:function(m,d){return u(m,d),o(f(r.n,this.n)*f(r.d,this.d),r.d*this.d)},lcm:function(m,d){return u(m,d),r.n===0&&this.n===0?o(0,1):o(r.n*this.n,f(r.n,this.n)*f(r.d,this.d))},ceil:function(m){return m=Math.pow(10,m||0),isNaN(this.n)||isNaN(this.d)?new g(NaN):o(Math.ceil(m*this.s*this.n/this.d),m)},floor:function(m){return m=Math.pow(10,m||0),isNaN(this.n)||isNaN(this.d)?new g(NaN):o(Math.floor(m*this.s*this.n/this.d),m)},round:function(m){return m=Math.pow(10,m||0),isNaN(this.n)||isNaN(this.d)?new g(NaN):o(Math.round(m*this.s*this.n/this.d),m)},inverse:function(){return o(this.s*this.d,this.n)},pow:function(m,d){if(u(m,d),r.d===1)return r.s<0?o(Math.pow(this.s*this.d,r.n),Math.pow(this.n,r.n)):o(Math.pow(this.s*this.n,r.n),Math.pow(this.d,r.n));if(this.s<0)return null;var _=a(this.n),p=a(this.d),D=1,v=1;for(var y in _)if(y!=="1"){if(y==="0"){D=0;break}if(_[y]*=r.n,_[y]%r.d===0)_[y]/=r.d;else return null;D*=Math.pow(y,_[y])}for(var y in p)if(y!=="1"){if(p[y]*=r.n,p[y]%r.d===0)p[y]/=r.d;else return null;v*=Math.pow(y,p[y])}return r.s<0?o(v,D):o(D,v)},equals:function(m,d){return u(m,d),this.s*this.n*r.d===r.s*r.n*this.d},compare:function(m,d){u(m,d);var _=this.s*this.n*r.d-r.s*r.n*this.d;return(0<_)-(_<0)},simplify:function(m){if(isNaN(this.n)||isNaN(this.d))return this;m=m||.001;for(var d=this.abs(),_=d.toContinued(),p=1;p<_.length;p++){for(var D=o(_[p-1],1),v=p-2;v>=0;v--)D=D.inverse().add(_[v]);if(D.sub(d).abs().valueOf()<m)return D.mul(this.s)}return this},divisible:function(m,d){return u(m,d),!(!(r.n*this.d)||this.n*r.d%(r.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(m){var d,_="",p=this.n,D=this.d;return this.s<0&&(_+="-"),D===1?_+=p:(m&&(d=Math.floor(p/D))>0&&(_+=d,_+=" ",p%=D),_+=p,_+="/",_+=D),_},toLatex:function(m){var d,_="",p=this.n,D=this.d;return this.s<0&&(_+="-"),D===1?_+=p:(m&&(d=Math.floor(p/D))>0&&(_+=d,p%=D),_+="\\frac{",_+=p,_+="}{",_+=D,_+="}"),_},toContinued:function(){var m,d=this.n,_=this.d,p=[];if(isNaN(d)||isNaN(_))return p;do p.push(Math.floor(d/_)),m=d%_,d=_,_=m;while(d!==1);return p},toString:function(m){var d=this.n,_=this.d;if(isNaN(d)||isNaN(_))return"NaN";m=m||15;var p=l(d,_),D=h(d,_,p),v=this.s<0?"-":"";if(v+=d/_|0,d%=_,d*=10,d&&(v+="."),p){for(var y=D;y--;)v+=d/_|0,d%=_,d*=10;v+="(";for(var y=p;y--;)v+=d/_|0,d%=_,d*=10;v+=")"}else for(var y=m;d&&y--;)v+=d/_|0,d%=_,d*=10;return v}},Object.defineProperty(g,"__esModule",{value:!0}),g.default=g,g.Fraction=g,i.exports=g})()})(Ul);var k_=Ul.exports;const Ze=Wl(k_);var G_="Fraction",X_=[],W_=st(G_,X_,()=>(Object.defineProperty(Ze,"name",{value:"Fraction"}),Ze.prototype.constructor=Ze,Ze.prototype.type="Fraction",Ze.prototype.isFraction=!0,Ze.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},Ze.fromJSON=function(i){return new Ze(i)},Ze),{isClass:!0}),Y_="Matrix",U_=[],Z_=st(Y_,U_,()=>{function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator")}return i.prototype.type="Matrix",i.prototype.isMatrix=!0,i.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},i.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},i.prototype.create=function(t,e){throw new Error("Cannot invoke create on a Matrix interface")},i.prototype.subset=function(t,e,n){throw new Error("Cannot invoke subset on a Matrix interface")},i.prototype.get=function(t){throw new Error("Cannot invoke get on a Matrix interface")},i.prototype.set=function(t,e,n){throw new Error("Cannot invoke set on a Matrix interface")},i.prototype.resize=function(t,e){throw new Error("Cannot invoke resize on a Matrix interface")},i.prototype.reshape=function(t,e){throw new Error("Cannot invoke reshape on a Matrix interface")},i.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},i.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},i.prototype.map=function(t,e){throw new Error("Cannot invoke map on a Matrix interface")},i.prototype.forEach=function(t){throw new Error("Cannot invoke forEach on a Matrix interface")},i.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},i.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},i.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},i.prototype.format=function(t){throw new Error("Cannot invoke format on a Matrix interface")},i.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},i},{isClass:!0});function Zl(i){return Object.keys(i.signatures||{}).reduce(function(t,e){var n=(e.match(/,/g)||[]).length+1;return Math.max(t,n)},-1)}var V_="DenseMatrix",K_=["Matrix"],$_=st(V_,K_,i=>{var{Matrix:t}=i;function e(l,h){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");if(h&&!Le(h))throw new Error("Invalid datatype: "+h);if(Wt(l))l.type==="DenseMatrix"?(this._data=wt(l._data),this._size=wt(l._size),this._datatype=h||l._datatype):(this._data=l.toArray(),this._size=l.size(),this._datatype=h||l._datatype);else if(l&&Tt(l.data)&&Tt(l.size))this._data=l.data,this._size=l.size,ka(this._data,this._size),this._datatype=h||l.datatype;else if(Tt(l))this._data=c(l),this._size=He(this._data),ka(this._data,this._size),this._datatype=h;else{if(l)throw new TypeError("Unsupported type of data ("+Jn(l)+")");this._data=[],this._size=[0],this._datatype=h}}e.prototype=new t,e.prototype.createDenseMatrix=function(l,h){return new e(l,h)},Object.defineProperty(e,"name",{value:"DenseMatrix"}),e.prototype.constructor=e,e.prototype.type="DenseMatrix",e.prototype.isDenseMatrix=!0,e.prototype.getDataType=function(){return yr(this._data,Jn)},e.prototype.storage=function(){return"dense"},e.prototype.datatype=function(){return this._datatype},e.prototype.create=function(l,h){return new e(l,h)},e.prototype.subset=function(l,h,f){switch(arguments.length){case 1:return n(this,l);case 2:case 3:return s(this,l,h,f);default:throw new SyntaxError("Wrong number of arguments")}},e.prototype.get=function(l){if(!Tt(l))throw new TypeError("Array expected");if(l.length!==this._size.length)throw new vt(l.length,this._size.length);for(var h=0;h<l.length;h++)Rt(l[h],this._size[h]);for(var f=this._data,g=0,m=l.length;g<m;g++){var d=l[g];Rt(d,f.length),f=f[d]}return f},e.prototype.set=function(l,h,f){if(!Tt(l))throw new TypeError("Array expected");if(l.length<this._size.length)throw new vt(l.length,this._size.length,"<");var g,m,d,_=l.map(function(D){return D+1});u(this,_,f);var p=this._data;for(g=0,m=l.length-1;g<m;g++)d=l[g],Rt(d,p.length),p=p[d];return d=l[l.length-1],Rt(d,p.length),p[d]=h,this};function n(l,h){if(!Io(h))throw new TypeError("Invalid index");var f=h.isScalar();if(f)return l.get(h.min());var g=h.size();if(g.length!==l._size.length)throw new vt(g.length,l._size.length);for(var m=h.min(),d=h.max(),_=0,p=l._size.length;_<p;_++)Rt(m[_],l._size[_]),Rt(d[_],l._size[_]);return new e(r(l._data,h,g.length,0),l._datatype)}function r(l,h,f,g){var m=g===f-1,d=h.dimension(g);return m?d.map(function(_){return Rt(_,l.length),l[_]}).valueOf():d.map(function(_){Rt(_,l.length);var p=l[_];return r(p,h,f,g+1)}).valueOf()}function s(l,h,f,g){if(!h||h.isIndex!==!0)throw new TypeError("Invalid index");var m=h.size(),d=h.isScalar(),_;if(Wt(f)?(_=f.size(),f=f.valueOf()):_=He(f),d){if(_.length!==0)throw new TypeError("Scalar expected");l.set(h.min(),f,g)}else{if(m.length<l._size.length)throw new vt(m.length,l._size.length,"<");if(_.length<m.length){for(var p=0,D=0;m[p]===1&&_[p]===1;)p++;for(;m[p]===1;)D++,p++;f=Fl(f,m.length,D,_)}if(!vr(m,_))throw new vt(m,_,">");var v=h.max().map(function(C){return C+1});u(l,v,g);var y=m.length,E=0;o(l._data,h,f,y,E)}return l}function o(l,h,f,g,m){var d=m===g-1,_=h.dimension(m);d?_.forEach(function(p,D){Rt(p),l[p]=f[D[0]]}):_.forEach(function(p,D){Rt(p),o(l[p],h,f[D[0]],g,m+1)})}e.prototype.resize=function(l,h,f){if(!pr(l))throw new TypeError("Array or Matrix expected");var g=l.valueOf().map(d=>Array.isArray(d)&&d.length===1?d[0]:d),m=f?this.clone():this;return a(m,g,h)};function a(l,h,f){if(h.length===0){for(var g=l._data;Tt(g);)g=g[0];return g}return l._size=h.slice(0),l._data=bs(l._data,l._size,f),l}e.prototype.reshape=function(l,h){var f=h?this.clone():this;f._data=Cm(f._data,l);var g=f._size.reduce((m,d)=>m*d);return f._size=bo(l,g),f};function u(l,h,f){for(var g=l._size.slice(0),m=!1;g.length<h.length;)g.push(0),m=!0;for(var d=0,_=h.length;d<_;d++)h[d]>g[d]&&(g[d]=h[d],m=!0);m&&a(l,g,f)}e.prototype.clone=function(){var l=new e({data:wt(this._data),size:wt(this._size),datatype:this._datatype});return l},e.prototype.size=function(){return this._size.slice(0)},e.prototype.map=function(l){var h=this,f=Zl(l),g=function _(p,D){return Tt(p)?p.map(function(v,y){return _(v,D.concat(y))}):f===1?l(p):f===2?l(p,D):l(p,D,h)},m=g(this._data,[]),d=this._datatype!==void 0?yr(m,Jn):void 0;return new e(m,d)},e.prototype.forEach=function(l){var h=this,f=function g(m,d){Tt(m)?m.forEach(function(_,p){g(_,d.concat(p))}):l(m,d,h)};f(this._data,[])},e.prototype[Symbol.iterator]=function*(){var l=function*h(f,g){if(Tt(f))for(var m=0;m<f.length;m++)yield*h(f[m],g.concat(m));else yield{value:f,index:g}};yield*l(this._data,[])},e.prototype.rows=function(){var l=[],h=this.size();if(h.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");var f=this._data;for(var g of f)l.push(new e([g],this._datatype));return l},e.prototype.columns=function(){var l=this,h=[],f=this.size();if(f.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var g=this._data,m=function(p){var D=g.map(v=>[v[p]]);h.push(new e(D,l._datatype))},d=0;d<f[1];d++)m(d);return h},e.prototype.toArray=function(){return wt(this._data)},e.prototype.valueOf=function(){return this._data},e.prototype.format=function(l){return Nt(this._data,l)},e.prototype.toString=function(){return Nt(this._data)},e.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},e.prototype.diagonal=function(l){if(l){if(ae(l)&&(l=l.toNumber()),!Mt(l)||!zt(l))throw new TypeError("The parameter k must be an integer number")}else l=0;for(var h=l>0?l:0,f=l<0?-l:0,g=this._size[0],m=this._size[1],d=Math.min(g-f,m-h),_=[],p=0;p<d;p++)_[p]=this._data[p+f][p+h];return new e({data:_,size:[d],datatype:this._datatype})},e.diagonal=function(l,h,f,g){if(!Tt(l))throw new TypeError("Array expected, size parameter");if(l.length!==2)throw new Error("Only two dimensions matrix are supported");if(l=l.map(function(F){if(ae(F)&&(F=F.toNumber()),!Mt(F)||!zt(F)||F<1)throw new Error("Size values must be positive integers");return F}),f){if(ae(f)&&(f=f.toNumber()),!Mt(f)||!zt(f))throw new TypeError("The parameter k must be an integer number")}else f=0;var m=f>0?f:0,d=f<0?-f:0,_=l[0],p=l[1],D=Math.min(_-d,p-m),v;if(Tt(h)){if(h.length!==D)throw new Error("Invalid value array length");v=function(w){return h[w]}}else if(Wt(h)){var y=h.size();if(y.length!==1||y[0]!==D)throw new Error("Invalid matrix length");v=function(w){return h.get([w])}}else v=function(){return h};g||(g=ae(v(0))?v(0).mul(0):0);var E=[];if(l.length>0){E=bs(E,l,g);for(var C=0;C<D;C++)E[C+d][C+m]=v(C)}return new e({data:E,size:[_,p]})},e.fromJSON=function(l){return new e(l)},e.prototype.swapRows=function(l,h){if(!Mt(l)||!zt(l)||!Mt(h)||!zt(h))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return Rt(l,this._size[0]),Rt(h,this._size[0]),e._swapRows(l,h,this._data),this},e._swapRows=function(l,h,f){var g=f[l];f[l]=f[h],f[h]=g};function c(l){for(var h=0,f=l.length;h<f;h++){var g=l[h];Tt(g)?l[h]=c(g):g&&g.isMatrix===!0&&(l[h]=c(g.valueOf()))}return l}return e},{isClass:!0});function Je(i,t,e){return i&&typeof i.map=="function"?i.map(function(n){return Je(n,t)}):t(i)}var Ya="isInteger",q_=["typed"],H_=st(Ya,q_,i=>{var{typed:t}=i;return t(Ya,{number:zt,BigNumber:function(n){return n.isInt()},Fraction:function(n){return n.d===1&&isFinite(n.n)},"Array | Matrix":t.referToSelf(e=>n=>Je(n,e))})}),Vl="number",Kl="number, number";function $l(i){return Math.abs(i)}$l.signature=Vl;function ql(i,t){return i+t}ql.signature=Kl;function Hl(i,t){return i*t}Hl.signature=Kl;function jl(i){return-i}jl.signature=Vl;var j_="number";function Jl(i){return i===0}Jl.signature=j_;var Ua="isZero",J_=["typed"],Q_=st(Ua,J_,i=>{var{typed:t}=i;return t(Ua,{number:Jl,BigNumber:function(n){return n.isZero()},Complex:function(n){return n.re===0&&n.im===0},Fraction:function(n){return n.d===1&&n.n===0},Unit:t.referToSelf(e=>n=>t.find(e,n.valueType())(n.value)),"Array | Matrix":t.referToSelf(e=>n=>Je(n,e))})});function tp(i,t,e){if(e==null)return i.eq(t);if(i.eq(t))return!0;if(i.isNaN()||t.isNaN())return!1;if(i.isFinite()&&t.isFinite()){var n=i.minus(t).abs();if(n.isZero())return!0;var r=i.constructor.max(i.abs(),t.abs());return n.lte(r.times(e))}return!1}function ep(i,t,e){return Dr(i.re,t.re,e)&&Dr(i.im,t.im,e)}var np=st("compareUnits",["typed"],i=>{var{typed:t}=i;return{"Unit, Unit":t.referToSelf(e=>(n,r)=>{if(!n.equalBase(r))throw new Error("Cannot compare units with different base");return t.find(e,[n.valueType(),r.valueType()])(n.value,r.value)})}}),xr="equalScalar",ip=["typed","config"],rp=st(xr,ip,i=>{var{typed:t,config:e}=i,n=np({typed:t});return t(xr,{"boolean, boolean":function(s,o){return s===o},"number, number":function(s,o){return Dr(s,o,e.epsilon)},"BigNumber, BigNumber":function(s,o){return s.eq(o)||tp(s,o,e.epsilon)},"Fraction, Fraction":function(s,o){return s.equals(o)},"Complex, Complex":function(s,o){return ep(s,o,e.epsilon)}},n)});st(xr,["typed","config"],i=>{var{typed:t,config:e}=i;return t(xr,{"number, number":function(r,s){return Dr(r,s,e.epsilon)}})});var sp="SparseMatrix",op=["typed","equalScalar","Matrix"],ap=st(sp,op,i=>{var{typed:t,equalScalar:e,Matrix:n}=i;function r(d,_){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(_&&!Le(_))throw new Error("Invalid datatype: "+_);if(Wt(d))s(this,d,_);else if(d&&Tt(d.index)&&Tt(d.ptr)&&Tt(d.size))this._values=d.values,this._index=d.index,this._ptr=d.ptr,this._size=d.size,this._datatype=_||d.datatype;else if(Tt(d))o(this,d,_);else{if(d)throw new TypeError("Unsupported type of data ("+Jn(d)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=_}}function s(d,_,p){_.type==="SparseMatrix"?(d._values=_._values?wt(_._values):void 0,d._index=wt(_._index),d._ptr=wt(_._ptr),d._size=wt(_._size),d._datatype=p||_._datatype):o(d,_.valueOf(),p||_._datatype)}function o(d,_,p){d._values=[],d._index=[],d._ptr=[],d._datatype=p;var D=_.length,v=0,y=e,E=0;if(Le(p)&&(y=t.find(e,[p,p])||e,E=t.convert(0,p)),D>0){var C=0;do{d._ptr.push(d._index.length);for(var F=0;F<D;F++){var w=_[F];if(Tt(w)){if(C===0&&v<w.length&&(v=w.length),C<w.length){var A=w[C];y(A,E)||(d._values.push(A),d._index.push(F))}}else C===0&&v<1&&(v=1),y(w,E)||(d._values.push(w),d._index.push(F))}C++}while(C<v)}d._ptr.push(d._index.length),d._size=[D,v]}r.prototype=new n,r.prototype.createSparseMatrix=function(d,_){return new r(d,_)},Object.defineProperty(r,"name",{value:"SparseMatrix"}),r.prototype.constructor=r,r.prototype.type="SparseMatrix",r.prototype.isSparseMatrix=!0,r.prototype.getDataType=function(){return yr(this._values,Jn)},r.prototype.storage=function(){return"sparse"},r.prototype.datatype=function(){return this._datatype},r.prototype.create=function(d,_){return new r(d,_)},r.prototype.density=function(){var d=this._size[0],_=this._size[1];return d!==0&&_!==0?this._index.length/(d*_):0},r.prototype.subset=function(d,_,p){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return a(this,d);case 2:case 3:return u(this,d,_,p);default:throw new SyntaxError("Wrong number of arguments")}};function a(d,_){if(!Io(_))throw new TypeError("Invalid index");var p=_.isScalar();if(p)return d.get(_.min());var D=_.size();if(D.length!==d._size.length)throw new vt(D.length,d._size.length);var v,y,E,C,F=_.min(),w=_.max();for(v=0,y=d._size.length;v<y;v++)Rt(F[v],d._size[v]),Rt(w[v],d._size[v]);var A=d._values,T=d._index,I=d._ptr,N=_.dimension(0),X=_.dimension(1),U=[],b=[];N.forEach(function(V,$){b[V]=$[0],U[V]=!0});var M=A?[]:void 0,L=[],k=[];return X.forEach(function(V){for(k.push(L.length),E=I[V],C=I[V+1];E<C;E++)v=T[E],U[v]===!0&&(L.push(b[v]),M&&M.push(A[E]))}),k.push(L.length),new r({values:M,index:L,ptr:k,size:D,datatype:d._datatype})}function u(d,_,p,D){if(!_||_.isIndex!==!0)throw new TypeError("Invalid index");var v=_.size(),y=_.isScalar(),E;if(Wt(p)?(E=p.size(),p=p.toArray()):E=He(p),y){if(E.length!==0)throw new TypeError("Scalar expected");d.set(_.min(),p,D)}else{if(v.length!==1&&v.length!==2)throw new vt(v.length,d._size.length,"<");if(E.length<v.length){for(var C=0,F=0;v[C]===1&&E[C]===1;)C++;for(;v[C]===1;)F++,C++;p=Fl(p,v.length,F,E)}if(!vr(v,E))throw new vt(v,E,">");if(v.length===1){var w=_.dimension(0);w.forEach(function(I,N){Rt(I),d.set([I,0],p[N[0]],D)})}else{var A=_.dimension(0),T=_.dimension(1);A.forEach(function(I,N){Rt(I),T.forEach(function(X,U){Rt(X),d.set([I,X],p[N[0]][U[0]],D)})})}}return d}r.prototype.get=function(d){if(!Tt(d))throw new TypeError("Array expected");if(d.length!==this._size.length)throw new vt(d.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var _=d[0],p=d[1];Rt(_,this._size[0]),Rt(p,this._size[1]);var D=c(_,this._ptr[p],this._ptr[p+1],this._index);return D<this._ptr[p+1]&&this._index[D]===_?this._values[D]:0},r.prototype.set=function(d,_,p){if(!Tt(d))throw new TypeError("Array expected");if(d.length!==this._size.length)throw new vt(d.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var D=d[0],v=d[1],y=this._size[0],E=this._size[1],C=e,F=0;Le(this._datatype)&&(C=t.find(e,[this._datatype,this._datatype])||e,F=t.convert(0,this._datatype)),(D>y-1||v>E-1)&&(f(this,Math.max(D+1,y),Math.max(v+1,E),p),y=this._size[0],E=this._size[1]),Rt(D,y),Rt(v,E);var w=c(D,this._ptr[v],this._ptr[v+1],this._index);return w<this._ptr[v+1]&&this._index[w]===D?C(_,F)?l(w,v,this._values,this._index,this._ptr):this._values[w]=_:C(_,F)||h(w,D,v,_,this._values,this._index,this._ptr),this};function c(d,_,p,D){if(p-_===0)return p;for(var v=_;v<p;v++)if(D[v]===d)return v;return _}function l(d,_,p,D,v){p.splice(d,1),D.splice(d,1);for(var y=_+1;y<v.length;y++)v[y]--}function h(d,_,p,D,v,y,E){v.splice(d,0,D),y.splice(d,0,_);for(var C=p+1;C<E.length;C++)E[C]++}r.prototype.resize=function(d,_,p){if(!pr(d))throw new TypeError("Array or Matrix expected");var D=d.valueOf().map(y=>Array.isArray(y)&&y.length===1?y[0]:y);if(D.length!==2)throw new Error("Only two dimensions matrix are supported");D.forEach(function(y){if(!Mt(y)||!zt(y)||y<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Nt(D)+")")});var v=p?this.clone():this;return f(v,D[0],D[1],_)};function f(d,_,p,D){var v=D||0,y=e,E=0;Le(d._datatype)&&(y=t.find(e,[d._datatype,d._datatype])||e,E=t.convert(0,d._datatype),v=t.convert(v,d._datatype));var C=!y(v,E),F=d._size[0],w=d._size[1],A,T,I;if(p>w){for(T=w;T<p;T++)if(d._ptr[T]=d._values.length,C)for(A=0;A<F;A++)d._values.push(v),d._index.push(A);d._ptr[p]=d._values.length}else p<w&&(d._ptr.splice(p+1,w-p),d._values.splice(d._ptr[p],d._values.length),d._index.splice(d._ptr[p],d._index.length));if(w=p,_>F){if(C){var N=0;for(T=0;T<w;T++){d._ptr[T]=d._ptr[T]+N,I=d._ptr[T+1]+N;var X=0;for(A=F;A<_;A++,X++)d._values.splice(I+X,0,v),d._index.splice(I+X,0,A),N++}d._ptr[w]=d._values.length}}else if(_<F){var U=0;for(T=0;T<w;T++){d._ptr[T]=d._ptr[T]-U;var b=d._ptr[T],M=d._ptr[T+1]-U;for(I=b;I<M;I++)A=d._index[I],A>_-1&&(d._values.splice(I,1),d._index.splice(I,1),U++)}d._ptr[T]=d._values.length}return d._size[0]=_,d._size[1]=p,d}r.prototype.reshape=function(d,_){if(!Tt(d))throw new TypeError("Array expected");if(d.length!==2)throw new Error("Sparse matrices can only be reshaped in two dimensions");d.forEach(function(V){if(!Mt(V)||!zt(V)||V<=-2||V===0)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+Nt(d)+")")});var p=this._size[0]*this._size[1];d=bo(d,p);var D=d[0]*d[1];if(p!==D)throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var v=_?this.clone():this;if(this._size[0]===d[0]&&this._size[1]===d[1])return v;for(var y=[],E=0;E<v._ptr.length;E++)for(var C=0;C<v._ptr[E+1]-v._ptr[E];C++)y.push(E);for(var F=v._values.slice(),w=v._index.slice(),A=0;A<v._index.length;A++){var T=w[A],I=y[A],N=T*v._size[1]+I;y[A]=N%d[1],w[A]=Math.floor(N/d[1])}v._values.length=0,v._index.length=0,v._ptr.length=d[1]+1,v._size=d.slice();for(var X=0;X<v._ptr.length;X++)v._ptr[X]=0;for(var U=0;U<F.length;U++){var b=w[U],M=y[U],L=F[U],k=c(b,v._ptr[M],v._ptr[M+1],v._index);h(k,b,M,L,v._values,v._index,v._ptr)}return v},r.prototype.clone=function(){var d=new r({values:this._values?wt(this._values):void 0,index:wt(this._index),ptr:wt(this._ptr),size:wt(this._size),datatype:this._datatype});return d},r.prototype.size=function(){return this._size.slice(0)},r.prototype.map=function(d,_){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var p=this,D=this._size[0],v=this._size[1],y=Zl(d),E=function(F,w,A){return y===1?d(F):y===2?d(F,[w,A]):d(F,[w,A],p)};return g(this,0,D-1,0,v-1,E,_)};function g(d,_,p,D,v,y,E){var C=[],F=[],w=[],A=e,T=0;Le(d._datatype)&&(A=t.find(e,[d._datatype,d._datatype])||e,T=t.convert(0,d._datatype));for(var I=function(it,J,et){it=y(it,J,et),A(it,T)||(C.push(it),F.push(J))},N=D;N<=v;N++){w.push(C.length);var X=d._ptr[N],U=d._ptr[N+1];if(E)for(var b=X;b<U;b++){var M=d._index[b];M>=_&&M<=p&&I(d._values[b],M-_,N-D)}else{for(var L={},k=X;k<U;k++){var V=d._index[k];L[V]=d._values[k]}for(var $=_;$<=p;$++){var tt=$ in L?L[$]:0;I(tt,$-_,N-D)}}}return w.push(C.length),new r({values:C,index:F,ptr:w,size:[p-_+1,v-D+1]})}r.prototype.forEach=function(d,_){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var p=this,D=this._size[0],v=this._size[1],y=0;y<v;y++){var E=this._ptr[y],C=this._ptr[y+1];if(_)for(var F=E;F<C;F++){var w=this._index[F];d(this._values[F],[w,y],p)}else{for(var A={},T=E;T<C;T++){var I=this._index[T];A[I]=this._values[T]}for(var N=0;N<D;N++){var X=N in A?A[N]:0;d(X,[N,y],p)}}}},r.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var d=this._size[1],_=0;_<d;_++)for(var p=this._ptr[_],D=this._ptr[_+1],v=p;v<D;v++){var y=this._index[v];yield{value:this._values[v],index:[y,_]}}},r.prototype.toArray=function(){return m(this._values,this._index,this._ptr,this._size,!0)},r.prototype.valueOf=function(){return m(this._values,this._index,this._ptr,this._size,!1)};function m(d,_,p,D,v){var y=D[0],E=D[1],C=[],F,w;for(F=0;F<y;F++)for(C[F]=[],w=0;w<E;w++)C[F][w]=0;for(w=0;w<E;w++)for(var A=p[w],T=p[w+1],I=A;I<T;I++)F=_[I],C[F][w]=d?v?wt(d[I]):d[I]:1;return C}return r.prototype.format=function(d){for(var _=this._size[0],p=this._size[1],D=this.density(),v="Sparse Matrix ["+Nt(_,d)+" x "+Nt(p,d)+"] density: "+Nt(D,d)+`
`,y=0;y<p;y++)for(var E=this._ptr[y],C=this._ptr[y+1],F=E;F<C;F++){var w=this._index[F];v+=`
    (`+Nt(w,d)+", "+Nt(y,d)+") ==> "+(this._values?Nt(this._values[F],d):"X")}return v},r.prototype.toString=function(){return Nt(this.toArray())},r.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},r.prototype.diagonal=function(d){if(d){if(ae(d)&&(d=d.toNumber()),!Mt(d)||!zt(d))throw new TypeError("The parameter k must be an integer number")}else d=0;var _=d>0?d:0,p=d<0?-d:0,D=this._size[0],v=this._size[1],y=Math.min(D-p,v-_),E=[],C=[],F=[];F[0]=0;for(var w=_;w<v&&E.length<y;w++)for(var A=this._ptr[w],T=this._ptr[w+1],I=A;I<T;I++){var N=this._index[I];if(N===w-_+p){E.push(this._values[I]),C[E.length-1]=N-p;break}}return F.push(E.length),new r({values:E,index:C,ptr:F,size:[y,1]})},r.fromJSON=function(d){return new r(d)},r.diagonal=function(d,_,p,D,v){if(!Tt(d))throw new TypeError("Array expected, size parameter");if(d.length!==2)throw new Error("Only two dimensions matrix are supported");if(d=d.map(function(V){if(ae(V)&&(V=V.toNumber()),!Mt(V)||!zt(V)||V<1)throw new Error("Size values must be positive integers");return V}),p){if(ae(p)&&(p=p.toNumber()),!Mt(p)||!zt(p))throw new TypeError("The parameter k must be an integer number")}else p=0;var y=e,E=0;Le(v)&&(y=t.find(e,[v,v])||e,E=t.convert(0,v));var C=p>0?p:0,F=p<0?-p:0,w=d[0],A=d[1],T=Math.min(w-F,A-C),I;if(Tt(_)){if(_.length!==T)throw new Error("Invalid value array length");I=function($){return _[$]}}else if(Wt(_)){var N=_.size();if(N.length!==1||N[0]!==T)throw new Error("Invalid matrix length");I=function($){return _.get([$])}}else I=function(){return _};for(var X=[],U=[],b=[],M=0;M<A;M++){b.push(X.length);var L=M-C;if(L>=0&&L<T){var k=I(L);y(k,E)||(U.push(L+F),X.push(k))}}return b.push(X.length),new r({values:X,index:U,ptr:b,size:[w,A]})},r.prototype.swapRows=function(d,_){if(!Mt(d)||!zt(d)||!Mt(_)||!zt(_))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return Rt(d,this._size[0]),Rt(_,this._size[0]),r._swapRows(d,_,this._size[1],this._values,this._index,this._ptr),this},r._forEachRow=function(d,_,p,D,v){for(var y=D[d],E=D[d+1],C=y;C<E;C++)v(p[C],_[C])},r._swapRows=function(d,_,p,D,v,y){for(var E=0;E<p;E++){var C=y[E],F=y[E+1],w=c(d,C,F,v),A=c(_,C,F,v);if(w<F&&A<F&&v[w]===d&&v[A]===_){if(D){var T=D[w];D[w]=D[A],D[A]=T}continue}if(w<F&&v[w]===d&&(A>=F||v[A]!==_)){var I=D?D[w]:void 0;v.splice(A,0,_),D&&D.splice(A,0,I),v.splice(A<=w?w+1:w,1),D&&D.splice(A<=w?w+1:w,1);continue}if(A<F&&v[A]===_&&(w>=F||v[w]!==d)){var N=D?D[A]:void 0;v.splice(w,0,d),D&&D.splice(w,0,N),v.splice(w<=A?A+1:A,1),D&&D.splice(w<=A?A+1:A,1)}}},r},{isClass:!0}),up="number",lp=["typed"];function hp(i){var t=i.match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/);if(t){var e={"0b":2,"0o":8,"0x":16}[t[1]],n=t[2],r=t[3];return{input:i,radix:e,integerPart:n,fractionalPart:r}}else return null}function cp(i){for(var t=parseInt(i.integerPart,i.radix),e=0,n=0;n<i.fractionalPart.length;n++){var r=parseInt(i.fractionalPart[n],i.radix);e+=r/Math.pow(i.radix,n+1)}var s=t+e;if(isNaN(s))throw new SyntaxError('String "'+i.input+'" is no valid number');return s}var fp=st(up,lp,i=>{var{typed:t}=i,e=t("number",{"":function(){return 0},number:function(r){return r},string:function(r){if(r==="NaN")return NaN;var s=hp(r);if(s)return cp(s);var o=0,a=r.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);a&&(o=Number(a[2]),r=a[1]);var u=Number(r);if(isNaN(u))throw new SyntaxError('String "'+r+'" is no valid number');if(a){if(u>2**o-1)throw new SyntaxError('String "'.concat(r,'" is out of range'));u>=2**(o-1)&&(u=u-2**o)}return u},BigNumber:function(r){return r.toNumber()},Fraction:function(r){return r.valueOf()},Unit:function(r){throw new Error("Second argument with valueless unit expected")},null:function(r){return 0},"Unit, string | Unit":function(r,s){return r.toNumber(s)},"Array | Matrix":t.referToSelf(n=>r=>Je(r,n))});return e.fromJSON=function(n){return parseFloat(n.value)},e}),dp="bignumber",gp=["typed","BigNumber"],mp=st(dp,gp,i=>{var{typed:t,BigNumber:e}=i;return t("bignumber",{"":function(){return new e(0)},number:function(r){return new e(r+"")},string:function(r){var s=r.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(s){var o=s[2],a=e(s[1]),u=new e(2).pow(Number(o));if(a.gt(u.sub(1)))throw new SyntaxError('String "'.concat(r,'" is out of range'));var c=new e(2).pow(Number(o)-1);return a.gte(c)?a.sub(u):a}return new e(r)},BigNumber:function(r){return r},Fraction:function(r){return new e(r.n).div(r.d).times(r.s)},null:function(r){return new e(0)},"Array | Matrix":t.referToSelf(n=>r=>Je(r,n))})}),_p="fraction",pp=["typed","Fraction"],vp=st(_p,pp,i=>{var{typed:t,Fraction:e}=i;return t("fraction",{number:function(r){if(!isFinite(r)||isNaN(r))throw new Error(r+" cannot be represented as a fraction");return new e(r)},string:function(r){return new e(r)},"number, number":function(r,s){return new e(r,s)},null:function(r){return new e(0)},BigNumber:function(r){return new e(r.toString())},Fraction:function(r){return r},Object:function(r){return new e(r)},"Array | Matrix":t.referToSelf(n=>r=>Je(r,n))})}),Za="matrix",Dp=["typed","Matrix","DenseMatrix","SparseMatrix"],yp=st(Za,Dp,i=>{var{typed:t,Matrix:e,DenseMatrix:n,SparseMatrix:r}=i;return t(Za,{"":function(){return s([])},string:function(a){return s([],a)},"string, string":function(a,u){return s([],a,u)},Array:function(a){return s(a)},Matrix:function(a){return s(a,a.storage())},"Array | Matrix, string":s,"Array | Matrix, string, string":s});function s(o,a,u){if(a==="dense"||a==="default"||a===void 0)return new n(o,u);if(a==="sparse")return new r(o,u);throw new TypeError("Unknown matrix type "+JSON.stringify(a)+".")}}),Va="unaryMinus",Ep=["typed"],Cp=st(Va,Ep,i=>{var{typed:t}=i;return t(Va,{number:jl,"Complex | BigNumber | Fraction":e=>e.neg(),Unit:t.referToSelf(e=>n=>{var r=n.clone();return r.value=t.find(e,r.valueType())(n.value),r}),"Array | Matrix":t.referToSelf(e=>n=>Je(n,e))})}),Ka="abs",wp=["typed"],xp=st(Ka,wp,i=>{var{typed:t}=i;return t(Ka,{number:$l,"Complex | BigNumber | Fraction | Unit":e=>e.abs(),"Array | Matrix":t.referToSelf(e=>n=>Je(n,e))})}),$a="addScalar",Ap=["typed"],Fp=st($a,Ap,i=>{var{typed:t}=i;return t($a,{"number, number":ql,"Complex, Complex":function(n,r){return n.add(r)},"BigNumber, BigNumber":function(n,r){return n.plus(r)},"Fraction, Fraction":function(n,r){return n.add(r)},"Unit, Unit":t.referToSelf(e=>(n,r)=>{if(n.value===null||n.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(r.value===null||r.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!n.equalBase(r))throw new Error("Units do not match");var s=n.clone();return s.value=t.find(e,[s.valueType(),r.valueType()])(s.value,r.value),s.fixPrefix=!1,s})})}),Sp="matAlgo11xS0s",Tp=["typed","equalScalar"],Rp=st(Sp,Tp,i=>{var{typed:t,equalScalar:e}=i;return function(r,s,o,a){var u=r._values,c=r._index,l=r._ptr,h=r._size,f=r._datatype;if(!u)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var g=h[0],m=h[1],d,_=e,p=0,D=o;typeof f=="string"&&(d=f,_=t.find(e,[d,d]),p=t.convert(0,d),s=t.convert(s,d),D=t.find(o,[d,d]));for(var v=[],y=[],E=[],C=0;C<m;C++){E[C]=y.length;for(var F=l[C],w=l[C+1],A=F;A<w;A++){var T=c[A],I=a?D(s,u[A]):D(u[A],s);_(I,p)||(y.push(T),v.push(I))}}return E[m]=y.length,r.createSparseMatrix({values:v,index:y,ptr:E,size:[g,m],datatype:d})}}),Mp="matAlgo12xSfs",Ip=["typed","DenseMatrix"],bp=st(Mp,Ip,i=>{var{typed:t,DenseMatrix:e}=i;return function(r,s,o,a){var u=r._values,c=r._index,l=r._ptr,h=r._size,f=r._datatype;if(!u)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var g=h[0],m=h[1],d,_=o;typeof f=="string"&&(d=f,s=t.convert(s,d),_=t.find(o,[d,d]));for(var p=[],D=[],v=[],y=0;y<m;y++){for(var E=y+1,C=l[y],F=l[y+1],w=C;w<F;w++){var A=c[w];D[A]=u[w],v[A]=E}for(var T=0;T<g;T++)y===0&&(p[T]=[]),v[T]===E?p[T][y]=a?_(s,D[T]):_(D[T],s):p[T][y]=a?_(s,0):_(0,s)}return new e({data:p,size:[g,m],datatype:d})}}),Lp="matAlgo14xDs",Np=["typed"],Ql=st(Lp,Np,i=>{var{typed:t}=i;return function(r,s,o,a){var u=r._data,c=r._size,l=r._datatype,h,f=o;typeof l=="string"&&(h=l,s=t.convert(s,h),f=t.find(o,[h,h]));var g=c.length>0?e(f,0,c,c[0],u,s,a):[];return r.createDenseMatrix({data:g,size:wt(c),datatype:h})};function e(n,r,s,o,a,u,c){var l=[];if(r===s.length-1)for(var h=0;h<o;h++)l[h]=c?n(u,a[h]):n(a[h],u);else for(var f=0;f<o;f++)l[f]=e(n,r+1,s,s[r+1],a[f],u,c);return l}}),Op="matAlgo01xDSid",Pp=["typed"],Bp=st(Op,Pp,i=>{var{typed:t}=i;return function(n,r,s,o){var a=n._data,u=n._size,c=n._datatype,l=r._values,h=r._index,f=r._ptr,g=r._size,m=r._datatype;if(u.length!==g.length)throw new vt(u.length,g.length);if(u[0]!==g[0]||u[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+g+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var d=u[0],_=u[1],p=typeof c=="string"&&c===m?c:void 0,D=p?t.find(s,[p,p]):s,v,y,E=[];for(v=0;v<d;v++)E[v]=[];var C=[],F=[];for(y=0;y<_;y++){for(var w=y+1,A=f[y],T=f[y+1],I=A;I<T;I++)v=h[I],C[v]=o?D(l[I],a[v][y]):D(a[v][y],l[I]),F[v]=w;for(v=0;v<d;v++)F[v]===w?E[v][y]=C[v]:E[v][y]=a[v][y]}return n.createDenseMatrix({data:E,size:[d,_],datatype:p})}}),zp="matAlgo10xSids",kp=["typed","DenseMatrix"],Gp=st(zp,kp,i=>{var{typed:t,DenseMatrix:e}=i;return function(r,s,o,a){var u=r._values,c=r._index,l=r._ptr,h=r._size,f=r._datatype;if(!u)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var g=h[0],m=h[1],d,_=o;typeof f=="string"&&(d=f,s=t.convert(s,d),_=t.find(o,[d,d]));for(var p=[],D=[],v=[],y=0;y<m;y++){for(var E=y+1,C=l[y],F=l[y+1],w=C;w<F;w++){var A=c[w];D[A]=u[w],v[A]=E}for(var T=0;T<g;T++)y===0&&(p[T]=[]),v[T]===E?p[T][y]=a?_(s,D[T]):_(D[T],s):p[T][y]=s}return new e({data:p,size:[g,m],datatype:d})}}),Xp="matAlgo13xDD",Wp=["typed"],Yp=st(Xp,Wp,i=>{var{typed:t}=i;return function(r,s,o){var a=r._data,u=r._size,c=r._datatype,l=s._data,h=s._size,f=s._datatype,g=[];if(u.length!==h.length)throw new vt(u.length,h.length);for(var m=0;m<u.length;m++){if(u[m]!==h[m])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+h+")");g[m]=u[m]}var d,_=o;typeof c=="string"&&c===f&&(d=c,_=t.find(o,[d,d]));var p=g.length>0?e(_,0,g,g[0],a,l):[];return r.createDenseMatrix({data:p,size:g,datatype:d})};function e(n,r,s,o,a,u){var c=[];if(r===s.length-1)for(var l=0;l<o;l++)c[l]=n(a[l],u[l]);else for(var h=0;h<o;h++)c[h]=e(n,r+1,s,s[r+1],a[h],u[h]);return c}}),Up="broadcast",Zp=["concat"],Vp=st(Up,Zp,i=>{var{concat:t}=i;return function(s,o){var a=Math.max(s._size.length,o._size.length);if(s._size.length===o._size.length&&s._size.every((_,p)=>_===o._size[p]))return[s,o];for(var u=e(s._size,a,0),c=e(o._size,a,0),l=[],h=0;h<a;h++)l[h]=Math.max(u[h],c[h]);for(var f=0;f<a;f++)r(u,l,f),r(c,l,f);var g=s.clone(),m=o.clone();g._size.length<a?g.reshape(e(g._size,a,1)):m._size.length<a&&m.reshape(e(m._size,a,1));for(var d=0;d<a;d++)g._size[d]<l[d]&&(g=n(g,l[d],d)),m._size[d]<l[d]&&(m=n(m,l[d],d));return[g,m]};function e(s,o,a){return[...Array(o-s.length).fill(a),...s]}function n(s,o,a){return t(...Array(o).fill(s),a)}function r(s,o,a){if(s[a]<o[a]&s[a]>1)throw new Error("shape missmatch: missmatch is found in arg with shape (".concat(s,") not possible to broadcast dimension ").concat(a," with size ").concat(s[a]," to size ").concat(o[a]))}}),Kp="matrixAlgorithmSuite",$p=["typed","matrix","concat"],qp=st(Kp,$p,i=>{var{typed:t,matrix:e,concat:n}=i,r=Yp({typed:t}),s=Ql({typed:t}),o=Vp({concat:n});return function(u){var c=u.elop,l=u.SD||u.DS,h;c?(h={"DenseMatrix, DenseMatrix":(d,_)=>r(...o(d,_),c),"Array, Array":(d,_)=>r(...o(e(d),e(_)),c).valueOf(),"Array, DenseMatrix":(d,_)=>r(...o(e(d),_),c),"DenseMatrix, Array":(d,_)=>r(...o(d,e(_)),c)},u.SS&&(h["SparseMatrix, SparseMatrix"]=(d,_)=>u.SS(...o(d,_),c,!1)),u.DS&&(h["DenseMatrix, SparseMatrix"]=(d,_)=>u.DS(...o(d,_),c,!1),h["Array, SparseMatrix"]=(d,_)=>u.DS(...o(e(d),_),c,!1)),l&&(h["SparseMatrix, DenseMatrix"]=(d,_)=>l(...o(_,d),c,!0),h["SparseMatrix, Array"]=(d,_)=>l(...o(e(_),d),c,!0))):(h={"DenseMatrix, DenseMatrix":t.referToSelf(d=>(_,p)=>r(...o(_,p),d)),"Array, Array":t.referToSelf(d=>(_,p)=>r(...o(e(_),e(p)),d).valueOf()),"Array, DenseMatrix":t.referToSelf(d=>(_,p)=>r(...o(e(_),p),d)),"DenseMatrix, Array":t.referToSelf(d=>(_,p)=>r(...o(_,e(p)),d))},u.SS&&(h["SparseMatrix, SparseMatrix"]=t.referToSelf(d=>(_,p)=>u.SS(...o(_,p),d,!1))),u.DS&&(h["DenseMatrix, SparseMatrix"]=t.referToSelf(d=>(_,p)=>u.DS(...o(_,p),d,!1)),h["Array, SparseMatrix"]=t.referToSelf(d=>(_,p)=>u.DS(...o(e(_),p),d,!1))),l&&(h["SparseMatrix, DenseMatrix"]=t.referToSelf(d=>(_,p)=>l(...o(p,_),d,!0)),h["SparseMatrix, Array"]=t.referToSelf(d=>(_,p)=>l(...o(e(p),_),d,!0))));var f=u.scalar||"any",g=u.Ds||u.Ss;g&&(c?(h["DenseMatrix,"+f]=(d,_)=>s(d,_,c,!1),h[f+", DenseMatrix"]=(d,_)=>s(_,d,c,!0),h["Array,"+f]=(d,_)=>s(e(d),_,c,!1).valueOf(),h[f+", Array"]=(d,_)=>s(e(_),d,c,!0).valueOf()):(h["DenseMatrix,"+f]=t.referToSelf(d=>(_,p)=>s(_,p,d,!1)),h[f+", DenseMatrix"]=t.referToSelf(d=>(_,p)=>s(p,_,d,!0)),h["Array,"+f]=t.referToSelf(d=>(_,p)=>s(e(_),p,d,!1).valueOf()),h[f+", Array"]=t.referToSelf(d=>(_,p)=>s(e(p),_,d,!0).valueOf())));var m=u.sS!==void 0?u.sS:u.Ss;return c?(u.Ss&&(h["SparseMatrix,"+f]=(d,_)=>u.Ss(d,_,c,!1)),m&&(h[f+", SparseMatrix"]=(d,_)=>m(_,d,c,!0))):(u.Ss&&(h["SparseMatrix,"+f]=t.referToSelf(d=>(_,p)=>u.Ss(_,p,d,!1))),m&&(h[f+", SparseMatrix"]=t.referToSelf(d=>(_,p)=>m(p,_,d,!0)))),c&&c.signatures&&am(h,c.signatures),h}}),Hp="matAlgo03xDSf",jp=["typed"],Jp=st(Hp,jp,i=>{var{typed:t}=i;return function(n,r,s,o){var a=n._data,u=n._size,c=n._datatype,l=r._values,h=r._index,f=r._ptr,g=r._size,m=r._datatype;if(u.length!==g.length)throw new vt(u.length,g.length);if(u[0]!==g[0]||u[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+g+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var d=u[0],_=u[1],p,D=0,v=s;typeof c=="string"&&c===m&&(p=c,D=t.convert(0,p),v=t.find(s,[p,p]));for(var y=[],E=0;E<d;E++)y[E]=[];for(var C=[],F=[],w=0;w<_;w++){for(var A=w+1,T=f[w],I=f[w+1],N=T;N<I;N++){var X=h[N];C[X]=o?v(l[N],a[X][w]):v(a[X][w],l[N]),F[X]=A}for(var U=0;U<d;U++)F[U]===A?y[U][w]=C[U]:y[U][w]=o?v(D,a[U][w]):v(a[U][w],D)}return n.createDenseMatrix({data:y,size:[d,_],datatype:p})}}),Qp="matAlgo05xSfSf",t1=["typed","equalScalar"],e1=st(Qp,t1,i=>{var{typed:t,equalScalar:e}=i;return function(r,s,o){var a=r._values,u=r._index,c=r._ptr,l=r._size,h=r._datatype,f=s._values,g=s._index,m=s._ptr,d=s._size,_=s._datatype;if(l.length!==d.length)throw new vt(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");var p=l[0],D=l[1],v,y=e,E=0,C=o;typeof h=="string"&&h===_&&(v=h,y=t.find(e,[v,v]),E=t.convert(0,v),C=t.find(o,[v,v]));var F=a&&f?[]:void 0,w=[],A=[],T=F?[]:void 0,I=F?[]:void 0,N=[],X=[],U,b,M,L;for(b=0;b<D;b++){A[b]=w.length;var k=b+1;for(M=c[b],L=c[b+1];M<L;M++)U=u[M],w.push(U),N[U]=k,T&&(T[U]=a[M]);for(M=m[b],L=m[b+1];M<L;M++)U=g[M],N[U]!==k&&w.push(U),X[U]=k,I&&(I[U]=f[M]);if(F)for(M=A[b];M<w.length;){U=w[M];var V=N[U],$=X[U];if(V===k||$===k){var tt=V===k?T[U]:E,O=$===k?I[U]:E,it=C(tt,O);y(it,E)?w.splice(M,1):(F.push(it),M++)}}}return A[D]=w.length,r.createSparseMatrix({values:F,index:w,ptr:A,size:[p,D],datatype:v})}}),n1="multiplyScalar",i1=["typed"],r1=st(n1,i1,i=>{var{typed:t}=i;return t("multiplyScalar",{"number, number":Hl,"Complex, Complex":function(n,r){return n.mul(r)},"BigNumber, BigNumber":function(n,r){return n.times(r)},"Fraction, Fraction":function(n,r){return n.mul(r)},"number | Fraction | BigNumber | Complex, Unit":(e,n)=>n.multiply(e),"Unit, number | Fraction | BigNumber | Complex | Unit":(e,n)=>e.multiply(n)})}),qa="multiply",s1=["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],o1=st(qa,s1,i=>{var{typed:t,matrix:e,addScalar:n,multiplyScalar:r,equalScalar:s,dot:o}=i,a=Rp({typed:t,equalScalar:s}),u=Ql({typed:t});function c(E,C){switch(E.length){case 1:switch(C.length){case 1:if(E[0]!==C[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(E[0]!==C[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+E[0]+") must match Matrix rows ("+C[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+C.length+" dimensions)")}break;case 2:switch(C.length){case 1:if(E[1]!==C[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+E[1]+") must match Vector length ("+C[0]+")");break;case 2:if(E[1]!==C[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+E[1]+") must match Matrix B rows ("+C[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+C.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+E.length+" dimensions)")}}function l(E,C,F){if(F===0)throw new Error("Cannot multiply two empty vectors");return o(E,C)}function h(E,C){if(C.storage()!=="dense")throw new Error("Support for SparseMatrix not implemented");return f(E,C)}function f(E,C){var F=E._data,w=E._size,A=E._datatype,T=C._data,I=C._size,N=C._datatype,X=w[0],U=I[1],b,M=n,L=r;A&&N&&A===N&&typeof A=="string"&&(b=A,M=t.find(n,[b,b]),L=t.find(r,[b,b]));for(var k=[],V=0;V<U;V++){for(var $=L(F[0],T[0][V]),tt=1;tt<X;tt++)$=M($,L(F[tt],T[tt][V]));k[V]=$}return E.createDenseMatrix({data:k,size:[U],datatype:b})}var g=t("_multiplyMatrixVector",{"DenseMatrix, any":d,"SparseMatrix, any":D}),m=t("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":_,"DenseMatrix, SparseMatrix":p,"SparseMatrix, DenseMatrix":v,"SparseMatrix, SparseMatrix":y});function d(E,C){var F=E._data,w=E._size,A=E._datatype,T=C._data,I=C._datatype,N=w[0],X=w[1],U,b=n,M=r;A&&I&&A===I&&typeof A=="string"&&(U=A,b=t.find(n,[U,U]),M=t.find(r,[U,U]));for(var L=[],k=0;k<N;k++){for(var V=F[k],$=M(V[0],T[0]),tt=1;tt<X;tt++)$=b($,M(V[tt],T[tt]));L[k]=$}return E.createDenseMatrix({data:L,size:[N],datatype:U})}function _(E,C){var F=E._data,w=E._size,A=E._datatype,T=C._data,I=C._size,N=C._datatype,X=w[0],U=w[1],b=I[1],M,L=n,k=r;A&&N&&A===N&&typeof A=="string"&&(M=A,L=t.find(n,[M,M]),k=t.find(r,[M,M]));for(var V=[],$=0;$<X;$++){var tt=F[$];V[$]=[];for(var O=0;O<b;O++){for(var it=k(tt[0],T[0][O]),J=1;J<U;J++)it=L(it,k(tt[J],T[J][O]));V[$][O]=it}}return E.createDenseMatrix({data:V,size:[X,b],datatype:M})}function p(E,C){var F=E._data,w=E._size,A=E._datatype,T=C._values,I=C._index,N=C._ptr,X=C._size,U=C._datatype;if(!T)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var b=w[0],M=X[1],L,k=n,V=r,$=s,tt=0;A&&U&&A===U&&typeof A=="string"&&(L=A,k=t.find(n,[L,L]),V=t.find(r,[L,L]),$=t.find(s,[L,L]),tt=t.convert(0,L));for(var O=[],it=[],J=[],et=C.createSparseMatrix({values:O,index:it,ptr:J,size:[b,M],datatype:L}),Dt=0;Dt<M;Dt++){J[Dt]=it.length;var ht=N[Dt],ft=N[Dt+1];if(ft>ht)for(var ut=0,ct=0;ct<b;ct++){for(var jt=ct+1,At=void 0,dt=ht;dt<ft;dt++){var Et=I[dt];ut!==jt?(At=V(F[ct][Et],T[dt]),ut=jt):At=k(At,V(F[ct][Et],T[dt]))}ut===jt&&!$(At,tt)&&(it.push(ct),O.push(At))}}return J[M]=it.length,et}function D(E,C){var F=E._values,w=E._index,A=E._ptr,T=E._datatype;if(!F)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var I=C._data,N=C._datatype,X=E._size[0],U=C._size[0],b=[],M=[],L=[],k,V=n,$=r,tt=s,O=0;T&&N&&T===N&&typeof T=="string"&&(k=T,V=t.find(n,[k,k]),$=t.find(r,[k,k]),tt=t.find(s,[k,k]),O=t.convert(0,k));var it=[],J=[];L[0]=0;for(var et=0;et<U;et++){var Dt=I[et];if(!tt(Dt,O))for(var ht=A[et],ft=A[et+1],ut=ht;ut<ft;ut++){var ct=w[ut];J[ct]?it[ct]=V(it[ct],$(Dt,F[ut])):(J[ct]=!0,M.push(ct),it[ct]=$(Dt,F[ut]))}}for(var jt=M.length,At=0;At<jt;At++){var dt=M[At];b[At]=it[dt]}return L[1]=M.length,E.createSparseMatrix({values:b,index:M,ptr:L,size:[X,1],datatype:k})}function v(E,C){var F=E._values,w=E._index,A=E._ptr,T=E._datatype;if(!F)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var I=C._data,N=C._datatype,X=E._size[0],U=C._size[0],b=C._size[1],M,L=n,k=r,V=s,$=0;T&&N&&T===N&&typeof T=="string"&&(M=T,L=t.find(n,[M,M]),k=t.find(r,[M,M]),V=t.find(s,[M,M]),$=t.convert(0,M));for(var tt=[],O=[],it=[],J=E.createSparseMatrix({values:tt,index:O,ptr:it,size:[X,b],datatype:M}),et=[],Dt=[],ht=0;ht<b;ht++){it[ht]=O.length;for(var ft=ht+1,ut=0;ut<U;ut++){var ct=I[ut][ht];if(!V(ct,$))for(var jt=A[ut],At=A[ut+1],dt=jt;dt<At;dt++){var Et=w[dt];Dt[Et]!==ft?(Dt[Et]=ft,O.push(Et),et[Et]=k(ct,F[dt])):et[Et]=L(et[Et],k(ct,F[dt]))}}for(var Yt=it[ht],Ut=O.length,fe=Yt;fe<Ut;fe++){var Ee=O[fe];tt[fe]=et[Ee]}}return it[b]=O.length,J}function y(E,C){var F=E._values,w=E._index,A=E._ptr,T=E._datatype,I=C._values,N=C._index,X=C._ptr,U=C._datatype,b=E._size[0],M=C._size[1],L=F&&I,k,V=n,$=r;T&&U&&T===U&&typeof T=="string"&&(k=T,V=t.find(n,[k,k]),$=t.find(r,[k,k]));for(var tt=L?[]:void 0,O=[],it=[],J=E.createSparseMatrix({values:tt,index:O,ptr:it,size:[b,M],datatype:k}),et=L?[]:void 0,Dt=[],ht,ft,ut,ct,jt,At,dt,Et,Yt=0;Yt<M;Yt++){it[Yt]=O.length;var Ut=Yt+1;for(jt=X[Yt],At=X[Yt+1],ct=jt;ct<At;ct++)if(Et=N[ct],L)for(ft=A[Et],ut=A[Et+1],ht=ft;ht<ut;ht++)dt=w[ht],Dt[dt]!==Ut?(Dt[dt]=Ut,O.push(dt),et[dt]=$(I[ct],F[ht])):et[dt]=V(et[dt],$(I[ct],F[ht]));else for(ft=A[Et],ut=A[Et+1],ht=ft;ht<ut;ht++)dt=w[ht],Dt[dt]!==Ut&&(Dt[dt]=Ut,O.push(dt));if(L)for(var fe=it[Yt],Ee=O.length,Ce=fe;Ce<Ee;Ce++){var Ie=O[Ce];tt[Ce]=et[Ie]}}return it[M]=O.length,J}return t(qa,r,{"Array, Array":t.referTo("Matrix, Matrix",E=>(C,F)=>{c(He(C),He(F));var w=E(e(C),e(F));return Wt(w)?w.valueOf():w}),"Matrix, Matrix":function(C,F){var w=C.size(),A=F.size();return c(w,A),w.length===1?A.length===1?l(C,F,w[0]):h(C,F):A.length===1?g(C,F):m(C,F)},"Matrix, Array":t.referTo("Matrix,Matrix",E=>(C,F)=>E(C,e(F))),"Array, Matrix":t.referToSelf(E=>(C,F)=>E(e(C,F.storage()),F)),"SparseMatrix, any":function(C,F){return a(C,F,r,!1)},"DenseMatrix, any":function(C,F){return u(C,F,r,!1)},"any, SparseMatrix":function(C,F){return a(F,C,r,!0)},"any, DenseMatrix":function(C,F){return u(F,C,r,!0)},"Array, any":function(C,F){return u(e(C),F,r,!1).valueOf()},"any, Array":function(C,F){return u(e(F),C,r,!0).valueOf()},"any, any":r,"any, any, ...any":t.referToSelf(E=>(C,F,w)=>{for(var A=E(C,F),T=0;T<w.length;T++)A=E(A,w[T]);return A})})}),Ha="subtract",a1=["typed","matrix","equalScalar","addScalar","unaryMinus","DenseMatrix","concat"],u1=st(Ha,a1,i=>{var{typed:t,matrix:e,equalScalar:n,addScalar:r,unaryMinus:s,DenseMatrix:o,concat:a}=i,u=Bp({typed:t}),c=Jp({typed:t}),l=e1({typed:t,equalScalar:n}),h=Gp({typed:t,DenseMatrix:o}),f=bp({typed:t,DenseMatrix:o}),g=qp({typed:t,matrix:e,concat:a});return t(Ha,{"number, number":(m,d)=>m-d,"Complex, Complex":(m,d)=>m.sub(d),"BigNumber, BigNumber":(m,d)=>m.minus(d),"Fraction, Fraction":(m,d)=>m.sub(d),"Unit, Unit":t.referToSelf(m=>(d,_)=>{if(d.value===null)throw new Error("Parameter x contains a unit with undefined value");if(_.value===null)throw new Error("Parameter y contains a unit with undefined value");if(!d.equalBase(_))throw new Error("Units do not match");var p=d.clone();return p.value=t.find(m,[p.valueType(),_.valueType()])(p.value,_.value),p.fixPrefix=!1,p})},g({SS:l,DS:u,SD:c,Ss:f,sS:h}))}),ja="conj",l1=["typed"],h1=st(ja,l1,i=>{var{typed:t}=i;return t(ja,{"number | BigNumber | Fraction":e=>e,Complex:e=>e.conjugate(),"Array | Matrix":t.referToSelf(e=>n=>Je(n,e))})}),Ja="concat",c1=["typed","matrix","isInteger"],f1=st(Ja,c1,i=>{var{typed:t,matrix:e,isInteger:n}=i;return t(Ja,{"...Array | Matrix | number | BigNumber":function(s){var o,a=s.length,u=-1,c,l=!1,h=[];for(o=0;o<a;o++){var f=s[o];if(Wt(f)&&(l=!0),Mt(f)||ae(f)){if(o!==a-1)throw new Error("Dimension must be specified as last argument");if(c=u,u=f.valueOf(),!n(u))throw new TypeError("Integer number expected for dimension");if(u<0||o>0&&u>c)throw new Rn(u,c+1)}else{var g=wt(f).valueOf(),m=He(g);if(h[o]=g,c=u,u=m.length-1,o>0&&u!==c)throw new vt(c+1,u+1)}}if(h.length===0)throw new SyntaxError("At least one matrix expected");for(var d=h.shift();h.length;)d=th(d,h.shift(),u,0);return l?e(d):d},"...string":function(s){return s.join("")}})});function th(i,t,e,n){if(n<e){if(i.length!==t.length)throw new vt(i.length,t.length);for(var r=[],s=0;s<i.length;s++)r[s]=th(i[s],t[s],e,n+1);return r}else return i.concat(t)}var Qa="identity",d1=["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],g1=st(Qa,d1,i=>{var{typed:t,config:e,matrix:n,BigNumber:r,DenseMatrix:s,SparseMatrix:o}=i;return t(Qa,{"":function(){return e.matrix==="Matrix"?n([]):[]},string:function(l){return n(l)},"number | BigNumber":function(l){return u(l,l,e.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, string":function(l,h){return u(l,l,h)},"number | BigNumber, number | BigNumber":function(l,h){return u(l,h,e.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(l,h,f){return u(l,h,f)},Array:function(l){return a(l)},"Array, string":function(l,h){return a(l,h)},Matrix:function(l){return a(l.valueOf(),l.storage())},"Matrix, string":function(l,h){return a(l.valueOf(),h)}});function a(c,l){switch(c.length){case 0:return l?n(l):[];case 1:return u(c[0],c[0],l);case 2:return u(c[0],c[1],l);default:throw new Error("Vector containing two values expected")}}function u(c,l,h){var f=ae(c)||ae(l)?r:null;if(ae(c)&&(c=c.toNumber()),ae(l)&&(l=l.toNumber()),!zt(c)||c<1)throw new Error("Parameters in function identity must be positive integers");if(!zt(l)||l<1)throw new Error("Parameters in function identity must be positive integers");var g=f?new r(1):1,m=f?new f(0):0,d=[c,l];if(h){if(h==="sparse")return o.diagonal(d,g,0,m);if(h==="dense")return s.diagonal(d,g,0,m);throw new TypeError('Unknown matrix type "'.concat(h,'"'))}for(var _=bs([],d,m),p=c<l?c:l,D=0;D<p;D++)_[D][D]=g;return _}});function m1(){throw new Error('No "bignumber" implementation available')}function _1(){throw new Error('No "fraction" implementation available')}function p1(){throw new Error('No "matrix" implementation available')}var tu="size",v1=["typed","config","?matrix"],D1=st(tu,v1,i=>{var{typed:t,config:e,matrix:n}=i;return t(tu,{Matrix:function(s){return s.create(s.size())},Array:He,string:function(s){return e.matrix==="Array"?[s.length]:n([s.length])},"number | Complex | BigNumber | Unit | boolean | null":function(s){return e.matrix==="Array"?[]:n?n([]):p1()}})}),eu="transpose",y1=["typed","matrix"],E1=st(eu,y1,i=>{var{typed:t,matrix:e}=i;return t(eu,{Array:o=>n(e(o)).valueOf(),Matrix:n,any:wt});function n(o){var a=o.size(),u;switch(a.length){case 1:u=o.clone();break;case 2:{var c=a[0],l=a[1];if(l===0)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+Nt(a)+")");switch(o.storage()){case"dense":u=r(o,c,l);break;case"sparse":u=s(o,c,l);break}}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+Nt(a)+")")}return u}function r(o,a,u){for(var c=o._data,l=[],h,f=0;f<u;f++){h=l[f]=[];for(var g=0;g<a;g++)h[g]=wt(c[g][f])}return o.createDenseMatrix({data:l,size:[u,a],datatype:o._datatype})}function s(o,a,u){for(var c=o._values,l=o._index,h=o._ptr,f=c?[]:void 0,g=[],m=[],d=[],_=0;_<a;_++)d[_]=0;var p,D,v;for(p=0,D=l.length;p<D;p++)d[l[p]]++;for(var y=0,E=0;E<a;E++)m.push(y),y+=d[E],d[E]=m[E];for(m.push(y),v=0;v<u;v++)for(var C=h[v],F=h[v+1],w=C;w<F;w++){var A=d[l[w]]++;g[A]=v,c&&(f[A]=wt(c[w]))}return o.createSparseMatrix({values:f,index:g,ptr:m,size:[u,a],datatype:o._datatype})}}),C1="numeric",w1=["number","?bignumber","?fraction"],x1=st(C1,w1,i=>{var{number:t,bignumber:e,fraction:n}=i,r={string:!0,number:!0,BigNumber:!0,Fraction:!0},s={number:o=>t(o),BigNumber:e?o=>e(o):m1,Fraction:n?o=>n(o):_1};return function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"number",c=arguments.length>2?arguments[2]:void 0;if(c!==void 0)throw new SyntaxError("numeric() takes one or two arguments");var l=Jn(a);if(!(l in r))throw new TypeError("Cannot convert "+a+' of type "'+l+'"; valid input types are '+Object.keys(r).join(", "));if(!(u in s))throw new TypeError("Cannot convert "+a+' to type "'+u+'"; valid output types are '+Object.keys(s).join(", "));return u===l?a:s[u](a)}}),nu="divideScalar",A1=["typed","numeric"],F1=st(nu,A1,i=>{var{typed:t,numeric:e}=i;return t(nu,{"number, number":function(r,s){return r/s},"Complex, Complex":function(r,s){return r.div(s)},"BigNumber, BigNumber":function(r,s){return r.div(s)},"Fraction, Fraction":function(r,s){return r.div(s)},"Unit, number | Complex | Fraction | BigNumber | Unit":(n,r)=>n.divide(r),"number | Fraction | Complex | BigNumber, Unit":(n,r)=>r.divideInto(n)})}),iu="dot",S1=["typed","addScalar","multiplyScalar","conj","size"],T1=st(iu,S1,i=>{var{typed:t,addScalar:e,multiplyScalar:n,conj:r,size:s}=i;return t(iu,{"Array | DenseMatrix, Array | DenseMatrix":a,"SparseMatrix, SparseMatrix":u});function o(l,h){var f=c(l),g=c(h),m,d;if(f.length===1)m=f[0];else if(f.length===2&&f[1]===1)m=f[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+f.join(", ")+")");if(g.length===1)d=g[0];else if(g.length===2&&g[1]===1)d=g[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+g.join(", ")+")");if(m!==d)throw new RangeError("Vectors must have equal length ("+m+" != "+d+")");if(m===0)throw new RangeError("Cannot calculate the dot product of empty vectors");return m}function a(l,h){var f=o(l,h),g=Wt(l)?l._data:l,m=Wt(l)?l._datatype:void 0,d=Wt(h)?h._data:h,_=Wt(h)?h._datatype:void 0,p=c(l).length===2,D=c(h).length===2,v=e,y=n;if(m&&_&&m===_&&typeof m=="string"){var E=m;v=t.find(e,[E,E]),y=t.find(n,[E,E])}if(!p&&!D){for(var C=y(r(g[0]),d[0]),F=1;F<f;F++)C=v(C,y(r(g[F]),d[F]));return C}if(!p&&D){for(var w=y(r(g[0]),d[0][0]),A=1;A<f;A++)w=v(w,y(r(g[A]),d[A][0]));return w}if(p&&!D){for(var T=y(r(g[0][0]),d[0]),I=1;I<f;I++)T=v(T,y(r(g[I][0]),d[I]));return T}if(p&&D){for(var N=y(r(g[0][0]),d[0][0]),X=1;X<f;X++)N=v(N,y(r(g[X][0]),d[X][0]));return N}}function u(l,h){o(l,h);for(var f=l._index,g=l._values,m=h._index,d=h._values,_=0,p=e,D=n,v=0,y=0;v<f.length&&y<m.length;){var E=f[v],C=m[y];if(E<C){v++;continue}if(E>C){y++;continue}E===C&&(_=p(_,D(g[v],d[y])),v++,y++)}return _}function c(l){return Wt(l)?l.size():s(l)}}),ru="det",R1=["typed","matrix","subtract","multiply","divideScalar","isZero","unaryMinus"],M1=st(ru,R1,i=>{var{typed:t,matrix:e,subtract:n,multiply:r,divideScalar:s,isZero:o,unaryMinus:a}=i;return t(ru,{any:function(l){return wt(l)},"Array | Matrix":function(l){var h;switch(Wt(l)?h=l.size():Array.isArray(l)?(l=e(l),h=l.size()):h=[],h.length){case 0:return wt(l);case 1:if(h[0]===1)return wt(l.valueOf()[0]);if(h[0]===0)return 1;throw new RangeError("Matrix must be square (size: "+Nt(h)+")");case 2:{var f=h[0],g=h[1];if(f===g)return u(l.clone().valueOf(),f);if(g===0)return 1;throw new RangeError("Matrix must be square (size: "+Nt(h)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+Nt(h)+")")}}});function u(c,l,h){if(l===1)return wt(c[0][0]);if(l===2)return n(r(c[0][0],c[1][1]),r(c[1][0],c[0][1]));for(var f=!1,g=new Array(l).fill(0).map((F,w)=>w),m=0;m<l;m++){var d=g[m];if(o(c[d][m])){var _=void 0;for(_=m+1;_<l;_++)if(!o(c[g[_]][m])){d=g[_],g[_]=g[m],g[m]=d,f=!f;break}if(_===l)return c[d][m]}for(var p=c[d][m],D=m===0?1:c[g[m-1]][m-1],v=m+1;v<l;v++)for(var y=g[v],E=m+1;E<l;E++)c[y][E]=s(n(r(c[y][E],p),r(c[y][m],c[d][E])),D)}var C=c[g[l-1]][l-1];return f?a(C):C}}),su="inv",I1=["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],b1=st(su,I1,i=>{var{typed:t,matrix:e,divideScalar:n,addScalar:r,multiply:s,unaryMinus:o,det:a,identity:u,abs:c}=i;return t(su,{"Array | Matrix":function(f){var g=Wt(f)?f.size():He(f);switch(g.length){case 1:if(g[0]===1)return Wt(f)?e([n(1,f.valueOf()[0])]):[n(1,f[0])];throw new RangeError("Matrix must be square (size: "+Nt(g)+")");case 2:{var m=g[0],d=g[1];if(m===d)return Wt(f)?e(l(f.valueOf(),m,d),f.storage()):l(f,m,d);throw new RangeError("Matrix must be square (size: "+Nt(g)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+Nt(g)+")")}},any:function(f){return n(1,f)}});function l(h,f,g){var m,d,_,p,D;if(f===1){if(p=h[0][0],p===0)throw Error("Cannot calculate inverse, determinant is zero");return[[n(1,p)]]}else if(f===2){var v=a(h);if(v===0)throw Error("Cannot calculate inverse, determinant is zero");return[[n(h[1][1],v),n(o(h[0][1]),v)],[n(o(h[1][0]),v),n(h[0][0],v)]]}else{var y=h.concat();for(m=0;m<f;m++)y[m]=y[m].concat();for(var E=u(f).valueOf(),C=0;C<g;C++){var F=c(y[C][C]),w=C;for(m=C+1;m<f;)c(y[m][C])>F&&(F=c(y[m][C]),w=m),m++;if(F===0)throw Error("Cannot calculate inverse, determinant is zero");m=w,m!==C&&(D=y[C],y[C]=y[m],y[m]=D,D=E[C],E[C]=E[m],E[m]=D);var A=y[C],T=E[C];for(m=0;m<f;m++){var I=y[m],N=E[m];if(m!==C){if(I[C]!==0){for(_=n(o(I[C]),A[C]),d=C;d<g;d++)I[d]=r(I[d],s(_,A[d]));for(d=0;d<g;d++)N[d]=r(N[d],s(_,T[d]))}}else{for(_=A[C],d=C;d<g;d++)I[d]=n(I[d],_);for(d=0;d<g;d++)N[d]=n(N[d],_)}}}return E}}}),No=N_({config:Xi}),L1=z_({}),eh=W_({}),Oo=Z_({}),Vr=$_({Matrix:Oo}),It=Bm({BigNumber:No,Complex:L1,DenseMatrix:Vr,Fraction:eh}),N1=xp({typed:It}),Kr=Fp({typed:It}),O1=mp({BigNumber:No,typed:It}),P1=h1({typed:It}),Po=rp({config:Xi,typed:It}),B1=H_({typed:It}),z1=Q_({typed:It}),nh=r1({typed:It}),k1=fp({typed:It}),ih=ap({Matrix:Oo,equalScalar:Po,typed:It}),Bo=Cp({typed:It}),G1=vp({Fraction:eh,typed:It}),Qe=yp({DenseMatrix:Vr,Matrix:Oo,SparseMatrix:ih,typed:It}),X1=x1({bignumber:O1,fraction:G1,number:k1}),W1=D1({matrix:Qe,config:Xi,typed:It}),Y1=E1({matrix:Qe,typed:It}),U1=f1({isInteger:B1,matrix:Qe,typed:It}),rh=F1({numeric:X1,typed:It}),Z1=g1({BigNumber:No,DenseMatrix:Vr,SparseMatrix:ih,config:Xi,matrix:Qe,typed:It}),V1=T1({addScalar:Kr,conj:P1,multiplyScalar:nh,size:W1,typed:It}),vi=o1({addScalar:Kr,dot:V1,equalScalar:Po,matrix:Qe,multiplyScalar:nh,typed:It}),K1=u1({DenseMatrix:Vr,addScalar:Kr,concat:U1,equalScalar:Po,matrix:Qe,typed:It,unaryMinus:Bo}),$1=M1({divideScalar:rh,isZero:z1,matrix:Qe,multiply:vi,subtract:K1,typed:It,unaryMinus:Bo}),q1=b1({abs:N1,addScalar:Kr,det:$1,divideScalar:rh,identity:Z1,matrix:Qe,multiply:vi,typed:It,unaryMinus:Bo});let sh=[];(async()=>sh=await(await fetch("/dvf-radius/mutations.json")).json())();let gi=null;const H1=new js("EPSG:4326"),j1=new u0({source:new R0}),Un=new Wg({target:"map",layers:[j1],view:new Ne({center:[244963.08062701017,6002960474649239e-9],zoom:6})});function J1(i,t){const e=wc(i),n=[];for(const r of sh)for(const s of r[5]){const o=[s[2],s[1]],a=new Uc([e,o]);if(Du(a,{projection:H1})<=t){n.push(r);break}}return n}function Q1(i,t,e){const n=Array(i.length).fill(1),r=Qe([n,i,t]),s=Y1(r),o=q1(vi(r,s));gi=vi(e,vi(s,o)).toArray()}function tv(i,t){const e=ys(Un.getView().getProjection(),1,i),n=new M0(i,t/e),s=[new Uo(n)],o=J1(i,t),a=document.querySelector("tbody"),u=a.rows.length;for(let d=u-1;d>=0;d--)a.deleteRow(d);const c=[],l=[],h=[],f=[];for(const d of o){const _=a.insertRow();_.insertCell(0).innerHTML=d[1],_.insertCell(1).innerHTML=d[2].toLocaleString(),_.insertCell(2).innerHTML=d[4].toLocaleString(),_.insertCell(3).innerHTML=d[3].toLocaleString();const p=~~(d[2]/d[4]);_.insertCell(4).innerHTML=p.toLocaleString(),f.push(p),c.push(d[4]),l.push(d[3]),h.push(d[2]);for(const D of d[5]){const v=Cc([D[2],D[1]]),y=new Uo(new Ru(v));s.push(y)}}if(o.length>0&&Q1(c,l,h),zo(),document.querySelector("#count > span").innerHTML=o.length.toLocaleString(),f.length>0){f.sort((p,D)=>p-D);const d=f.reduce((p,D)=>p+D,0)/f.length,_=f[Math.floor(f.length/2)];document.querySelector("#average > span").innerHTML=(~~d).toLocaleString(),document.querySelector("#median > span").innerHTML=(~~_).toLocaleString()}else document.querySelector("#average > span").innerHTML="-",document.querySelector("#median > span").innerHTML="-";Un.getAllLayers().length>1&&Un.removeLayer(Un.getLayers().getArray()[1]);const g=new Od({features:s}),m=new Td({source:g});Un.addLayer(m)}const Ar=document.querySelector("#radius input"),ou=localStorage.getItem("radius");ou!==null&&(Ar.value=ou);Un.on("click",function(i){const t=Ar.value,e=parseFloat(t);tv(i.coordinate,e)});const ks=document.querySelector("input[id=land]"),Gs=document.querySelector("input[id=building]"),au=document.querySelector("#regression span");ks.addEventListener("input",function(i){zo()});Gs.addEventListener("input",function(i){zo()});Ar.addEventListener("input",function(i){const t=Ar.value;localStorage.setItem("radius",t)});function zo(){if(ks.value===""||Gs.value===""||gi===null){au.innerHTML="-";return}const i=parseFloat(ks.value),t=parseFloat(Gs.value),e=gi[0]+gi[1]*t+gi[2]*i;au.innerHTML=e.toLocaleString()}
//# sourceMappingURL=index-d917563f.js.map
